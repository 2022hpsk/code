[
    {
        "sql_id": "sql_28",
        "sql": "\nselect  a.itype,\n        a.dtstatdate,\n        datediff(b.dtstatdate,a.dtstatdate) as idaynum,\n        count(distinct a.vplayerid)           as iusernum\nfrom (                      \n    select\n        itype,\n        min(dtstatdate) as dtstatdate,\n        vplayerid\n    from  (\n        select '广域战场'      as itype,\n                min(dtstatdate) as dtstatdate,\n                vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20240723' and dtstatdate <= date_add('20240723',6)\n        and submodename = '广域战场模式'\n        group by vplayerid\n\n        union all\n        select '消灭战', min(dtstatdate), vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20230804' and dtstatdate <= date_add('20230804',6)\n        and modename='组队竞技' and submodename like '%消灭战模式%'\n        group by vplayerid\n\n        union all\n        select '幻想混战', min(dtstatdate), vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20241115' and dtstatdate <= date_add('20241115',6)\n        and modename='创意创作间' and submodename='幻想混战'\n        group by vplayerid\n\n        union all\n        select '荒野传说', min(dtstatdate), vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20240903' and dtstatdate <= date_add('20240903',6)\n        and modename='休闲模式' and submodename in ('荒野传说','荒野沙漠')\n        group by vplayerid\n\n        union all\n        select '策略载具', min(dtstatdate), vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20241010' and dtstatdate <= date_add('20241010',6)\n        and modename='休闲模式' and submodename like '%策略载具%'\n        group by vplayerid\n\n        union all\n        select '炎夏混战', min(dtstatdate), vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20240625' and dtstatdate <= date_add('20240625',6)\n        and modename='创意创作间' and submodename like '%炎夏混战%'\n        group by vplayerid\n\n        union all\n        select '单人装备', min(dtstatdate), vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20240517' and dtstatdate <= date_add('20240517',6)\n        and modename='组队竞技' and submodename like '%单人装备%'\n        group by vplayerid\n\n        union all\n        select '交叉堡垒', min(dtstatdate), vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20240412' and dtstatdate <= date_add('20240412',6)\n        and modename='组队竞技' and submodename like '%交叉堡垒%'\n        group by vplayerid\n    ) t\n    group by itype, vplayerid\n) a\nleft join (\n        select '广域战场' as itype, dtstatdate, vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20240723' and dtstatdate <= date_add('20240723',13)\n          and submodename = '广域战场模式'\n        group by dtstatdate, vplayerid\n\n        union all\n        select '消灭战', dtstatdate, vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20230804' and dtstatdate <= date_add('20230804',13)\n          and modename='组队竞技' and submodename like '%消灭战模式%'\n        group by dtstatdate, vplayerid\n\n        union all\n        select '幻想混战', dtstatdate, vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20241115' and dtstatdate <= date_add('20241115',13)\n          and modename='创意创作间' and submodename='幻想混战'\n        group by dtstatdate, vplayerid\n\n        union all\n        select '荒野传说', dtstatdate, vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20240903' and dtstatdate <= date_add('20240903',13)\n          and modename='休闲模式' and submodename in ('荒野传说','荒野沙漠')\n        group by dtstatdate, vplayerid\n\n        union all\n        select '策略载具', dtstatdate, vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20241010' and dtstatdate <= date_add('20241010',13)\n          and modename='休闲模式' and submodename like '%策略载具%'\n        group by dtstatdate, vplayerid\n\n        union all\n        select '炎夏混战', dtstatdate, vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20240625' and dtstatdate <= date_add('20240625',13)\n          and modename='创意创作间' and submodename like '%炎夏混战%'\n        group by dtstatdate, vplayerid\n\n        union all\n        select '单人装备', dtstatdate, vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20240517' and dtstatdate <= date_add('20240517',13)\n          and modename='组队竞技' and submodename like '%单人装备%'\n        group by dtstatdate, vplayerid\n\n        union all\n        select '交叉堡垒', dtstatdate, vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20240412' and dtstatdate <= date_add('20240412',13)\n          and modename='组队竞技' and submodename like '%交叉堡垒%'\n        group by dtstatdate, vplayerid\n) b\n  on  a.itype      = b.itype\nand  a.vplayerid    = b.vplayerid\nwhere datediff(b.dtstatdate,a.dtstatdate) between 0 and 7\ngroup by a.itype, a.dtstatdate, datediff(b.dtstatdate,a.dtstatdate);\n",
        "status": "success",
        "result": [
            {
                "itype": "广域战场",
                "dtstatdate": "20240725",
                "idaynum": 0,
                "iusernum": 82
            },
            {
                "itype": "荒野传说",
                "dtstatdate": "20240903",
                "idaynum": 2,
                "iusernum": 8
            },
            {
                "itype": "幻想混战",
                "dtstatdate": "20241121",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240724",
                "idaynum": 2,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230810",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230804",
                "idaynum": 1,
                "iusernum": 16
            },
            {
                "itype": "幻想混战",
                "dtstatdate": "20241116",
                "idaynum": 1,
                "iusernum": 5
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230805",
                "idaynum": 7,
                "iusernum": 1
            },
            {
                "itype": "交叉堡垒",
                "dtstatdate": "20240416",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "交叉堡垒",
                "dtstatdate": "20240415",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230805",
                "idaynum": 3,
                "iusernum": 1
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240729",
                "idaynum": 2,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230810",
                "idaynum": 2,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230810",
                "idaynum": 7,
                "iusernum": 1
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240723",
                "idaynum": 5,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230808",
                "idaynum": 6,
                "iusernum": 1
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240723",
                "idaynum": 3,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230808",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230807",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "幻想混战",
                "dtstatdate": "20241115",
                "idaynum": 6,
                "iusernum": 1
            },
            {
                "itype": "荒野传说",
                "dtstatdate": "20240908",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230807",
                "idaynum": 7,
                "iusernum": 1
            },
            {
                "itype": "幻想混战",
                "dtstatdate": "20241115",
                "idaynum": 3,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230809",
                "idaynum": 2,
                "iusernum": 1
            },
            {
                "itype": "炎夏混战",
                "dtstatdate": "20240626",
                "idaynum": 0,
                "iusernum": 67
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240724",
                "idaynum": 4,
                "iusernum": 1
            },
            {
                "itype": "单人装备",
                "dtstatdate": "20240517",
                "idaynum": 2,
                "iusernum": 12
            },
            {
                "itype": "交叉堡垒",
                "dtstatdate": "20240412",
                "idaynum": 0,
                "iusernum": 100
            },
            {
                "itype": "单人装备",
                "dtstatdate": "20240518",
                "idaynum": 1,
                "iusernum": 6
            },
            {
                "itype": "炎夏混战",
                "dtstatdate": "20240625",
                "idaynum": 2,
                "iusernum": 6
            },
            {
                "itype": "炎夏混战",
                "dtstatdate": "20240627",
                "idaynum": 0,
                "iusernum": 53
            },
            {
                "itype": "荒野传说",
                "dtstatdate": "20240907",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230804",
                "idaynum": 7,
                "iusernum": 1
            },
            {
                "itype": "幻想混战",
                "dtstatdate": "20241115",
                "idaynum": 1,
                "iusernum": 9
            },
            {
                "itype": "交叉堡垒",
                "dtstatdate": "20240412",
                "idaynum": 6,
                "iusernum": 1
            },
            {
                "itype": "策略载具",
                "dtstatdate": "20241010",
                "idaynum": 3,
                "iusernum": 1
            },
            {
                "itype": "炎夏混战",
                "dtstatdate": "20240625",
                "idaynum": 5,
                "iusernum": 1
            },
            {
                "itype": "炎夏混战",
                "dtstatdate": "20240625",
                "idaynum": 7,
                "iusernum": 2
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230809",
                "idaynum": 5,
                "iusernum": 1
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240729",
                "idaynum": 3,
                "iusernum": 1
            },
            {
                "itype": "荒野传说",
                "dtstatdate": "20240903",
                "idaynum": 7,
                "iusernum": 2
            },
            {
                "itype": "交叉堡垒",
                "dtstatdate": "20240412",
                "idaynum": 2,
                "iusernum": 8
            },
            {
                "itype": "策略载具",
                "dtstatdate": "20241010",
                "idaynum": 7,
                "iusernum": 2
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230809",
                "idaynum": 7,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230807",
                "idaynum": 1,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230810",
                "idaynum": 3,
                "iusernum": 1
            },
            {
                "itype": "单人装备",
                "dtstatdate": "20240517",
                "idaynum": 6,
                "iusernum": 1
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240729",
                "idaynum": 1,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230807",
                "idaynum": 6,
                "iusernum": 1
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240729",
                "idaynum": 6,
                "iusernum": 1
            },
            {
                "itype": "幻想混战",
                "dtstatdate": "20241119",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "单人装备",
                "dtstatdate": "20240523",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240723",
                "idaynum": 0,
                "iusernum": 117
            },
            {
                "itype": "幻想混战",
                "dtstatdate": "20241115",
                "idaynum": 0,
                "iusernum": 88
            },
            {
                "itype": "炎夏混战",
                "dtstatdate": "20240625",
                "idaynum": 1,
                "iusernum": 8
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230805",
                "idaynum": 1,
                "iusernum": 10
            },
            {
                "itype": "幻想混战",
                "dtstatdate": "20241117",
                "idaynum": 0,
                "iusernum": 59
            },
            {
                "itype": "单人装备",
                "dtstatdate": "20240518",
                "idaynum": 0,
                "iusernum": 82
            },
            {
                "itype": "交叉堡垒",
                "dtstatdate": "20240414",
                "idaynum": 0,
                "iusernum": 70
            },
            {
                "itype": "交叉堡垒",
                "dtstatdate": "20240413",
                "idaynum": 1,
                "iusernum": 6
            },
            {
                "itype": "策略载具",
                "dtstatdate": "20241013",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "荒野传说",
                "dtstatdate": "20240904",
                "idaynum": 1,
                "iusernum": 4
            },
            {
                "itype": "炎夏混战",
                "dtstatdate": "20240630",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "交叉堡垒",
                "dtstatdate": "20240412",
                "idaynum": 5,
                "iusernum": 1
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240724",
                "idaynum": 1,
                "iusernum": 10
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240723",
                "idaynum": 7,
                "iusernum": 2
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240727",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "单人装备",
                "dtstatdate": "20240521",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230807",
                "idaynum": 4,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230806",
                "idaynum": 1,
                "iusernum": 1
            },
            {
                "itype": "荒野传说",
                "dtstatdate": "20240906",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240729",
                "idaynum": 4,
                "iusernum": 1
            },
            {
                "itype": "幻想混战",
                "dtstatdate": "20241115",
                "idaynum": 4,
                "iusernum": 1
            },
            {
                "itype": "炎夏混战",
                "dtstatdate": "20240629",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230809",
                "idaynum": 1,
                "iusernum": 1
            },
            {
                "itype": "交叉堡垒",
                "dtstatdate": "20240417",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240726",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "单人装备",
                "dtstatdate": "20240517",
                "idaynum": 5,
                "iusernum": 1
            },
            {
                "itype": "单人装备",
                "dtstatdate": "20240520",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "炎夏混战",
                "dtstatdate": "20240625",
                "idaynum": 0,
                "iusernum": 83
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240723",
                "idaynum": 1,
                "iusernum": 15
            },
            {
                "itype": "交叉堡垒",
                "dtstatdate": "20240412",
                "idaynum": 1,
                "iusernum": 12
            },
            {
                "itype": "策略载具",
                "dtstatdate": "20241014",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230805",
                "idaynum": 4,
                "iusernum": 1
            },
            {
                "itype": "荒野传说",
                "dtstatdate": "20240903",
                "idaynum": 3,
                "iusernum": 1
            },
            {
                "itype": "单人装备",
                "dtstatdate": "20240517",
                "idaynum": 1,
                "iusernum": 4
            },
            {
                "itype": "策略载具",
                "dtstatdate": "20241016",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "幻想混战",
                "dtstatdate": "20241115",
                "idaynum": 7,
                "iusernum": 2
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240723",
                "idaynum": 4,
                "iusernum": 1
            },
            {
                "itype": "策略载具",
                "dtstatdate": "20241010",
                "idaynum": 6,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230809",
                "idaynum": 6,
                "iusernum": 1
            },
            {
                "itype": "荒野传说",
                "dtstatdate": "20240903",
                "idaynum": 5,
                "iusernum": 1
            },
            {
                "itype": "单人装备",
                "dtstatdate": "20240517",
                "idaynum": 7,
                "iusernum": 2
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230807",
                "idaynum": 5,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230808",
                "idaynum": 5,
                "iusernum": 1
            },
            {
                "itype": "炎夏混战",
                "dtstatdate": "20240625",
                "idaynum": 3,
                "iusernum": 1
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240729",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240729",
                "idaynum": 5,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230806",
                "idaynum": 3,
                "iusernum": 1
            },
            {
                "itype": "单人装备",
                "dtstatdate": "20240522",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "交叉堡垒",
                "dtstatdate": "20240412",
                "idaynum": 7,
                "iusernum": 2
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230806",
                "idaynum": 4,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230806",
                "idaynum": 2,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230808",
                "idaynum": 1,
                "iusernum": 1
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240724",
                "idaynum": 5,
                "iusernum": 1
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240724",
                "idaynum": 0,
                "iusernum": 89
            },
            {
                "itype": "单人装备",
                "dtstatdate": "20240519",
                "idaynum": 0,
                "iusernum": 55
            },
            {
                "itype": "幻想混战",
                "dtstatdate": "20241116",
                "idaynum": 0,
                "iusernum": 94
            },
            {
                "itype": "单人装备",
                "dtstatdate": "20240517",
                "idaynum": 0,
                "iusernum": 88
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230805",
                "idaynum": 0,
                "iusernum": 96
            },
            {
                "itype": "交叉堡垒",
                "dtstatdate": "20240413",
                "idaynum": 0,
                "iusernum": 85
            },
            {
                "itype": "策略载具",
                "dtstatdate": "20241010",
                "idaynum": 2,
                "iusernum": 4
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230805",
                "idaynum": 5,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230810",
                "idaynum": 4,
                "iusernum": 1
            },
            {
                "itype": "幻想混战",
                "dtstatdate": "20241115",
                "idaynum": 2,
                "iusernum": 6
            },
            {
                "itype": "策略载具",
                "dtstatdate": "20241011",
                "idaynum": 1,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230807",
                "idaynum": 3,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230809",
                "idaynum": 3,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230805",
                "idaynum": 2,
                "iusernum": 1
            },
            {
                "itype": "幻想混战",
                "dtstatdate": "20241120",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "交叉堡垒",
                "dtstatdate": "20240412",
                "idaynum": 3,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230806",
                "idaynum": 5,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230809",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240724",
                "idaynum": 6,
                "iusernum": 1
            },
            {
                "itype": "荒野传说",
                "dtstatdate": "20240903",
                "idaynum": 4,
                "iusernum": 1
            },
            {
                "itype": "策略载具",
                "dtstatdate": "20241010",
                "idaynum": 4,
                "iusernum": 1
            },
            {
                "itype": "炎夏混战",
                "dtstatdate": "20240625",
                "idaynum": 6,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230808",
                "idaynum": 4,
                "iusernum": 1
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240724",
                "idaynum": 7,
                "iusernum": 1
            },
            {
                "itype": "幻想混战",
                "dtstatdate": "20241118",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230808",
                "idaynum": 3,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230806",
                "idaynum": 7,
                "iusernum": 1
            },
            {
                "itype": "荒野传说",
                "dtstatdate": "20240904",
                "idaynum": 0,
                "iusernum": 74
            },
            {
                "itype": "炎夏混战",
                "dtstatdate": "20240626",
                "idaynum": 1,
                "iusernum": 5
            },
            {
                "itype": "策略载具",
                "dtstatdate": "20241011",
                "idaynum": 0,
                "iusernum": 52
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230806",
                "idaynum": 0,
                "iusernum": 88
            },
            {
                "itype": "策略载具",
                "dtstatdate": "20241012",
                "idaynum": 0,
                "iusernum": 50
            },
            {
                "itype": "荒野传说",
                "dtstatdate": "20240903",
                "idaynum": 0,
                "iusernum": 90
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230804",
                "idaynum": 0,
                "iusernum": 117
            },
            {
                "itype": "荒野传说",
                "dtstatdate": "20240905",
                "idaynum": 0,
                "iusernum": 60
            },
            {
                "itype": "策略载具",
                "dtstatdate": "20241010",
                "idaynum": 0,
                "iusernum": 73
            },
            {
                "itype": "策略载具",
                "dtstatdate": "20241015",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240723",
                "idaynum": 2,
                "iusernum": 8
            },
            {
                "itype": "策略载具",
                "dtstatdate": "20241010",
                "idaynum": 1,
                "iusernum": 3
            },
            {
                "itype": "单人装备",
                "dtstatdate": "20240517",
                "idaynum": 4,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230806",
                "idaynum": 6,
                "iusernum": 1
            },
            {
                "itype": "炎夏混战",
                "dtstatdate": "20240701",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "交叉堡垒",
                "dtstatdate": "20240418",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "炎夏混战",
                "dtstatdate": "20240628",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230804",
                "idaynum": 2,
                "iusernum": 8
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230808",
                "idaynum": 2,
                "iusernum": 1
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240724",
                "idaynum": 3,
                "iusernum": 1
            },
            {
                "itype": "荒野传说",
                "dtstatdate": "20240903",
                "idaynum": 1,
                "iusernum": 5
            },
            {
                "itype": "幻想混战",
                "dtstatdate": "20241115",
                "idaynum": 5,
                "iusernum": 1
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240729",
                "idaynum": 7,
                "iusernum": 1
            },
            {
                "itype": "荒野传说",
                "dtstatdate": "20240903",
                "idaynum": 6,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230805",
                "idaynum": 6,
                "iusernum": 1
            },
            {
                "itype": "荒野传说",
                "dtstatdate": "20240909",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "策略载具",
                "dtstatdate": "20241010",
                "idaynum": 5,
                "iusernum": 1
            },
            {
                "itype": "炎夏混战",
                "dtstatdate": "20240625",
                "idaynum": 4,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230809",
                "idaynum": 4,
                "iusernum": 1
            },
            {
                "itype": "单人装备",
                "dtstatdate": "20240517",
                "idaynum": 3,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230810",
                "idaynum": 6,
                "iusernum": 1
            },
            {
                "itype": "交叉堡垒",
                "dtstatdate": "20240412",
                "idaynum": 4,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230810",
                "idaynum": 5,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230810",
                "idaynum": 1,
                "iusernum": 1
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240723",
                "idaynum": 6,
                "iusernum": 1
            },
            {
                "itype": "广域战场",
                "dtstatdate": "20240728",
                "idaynum": 0,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230808",
                "idaynum": 7,
                "iusernum": 1
            },
            {
                "itype": "消灭战",
                "dtstatdate": "20230807",
                "idaynum": 2,
                "iusernum": 1
            }
        ]
    },
    {
        "sql_id": "sql_30",
        "sql": "\nwith main_user as (\n    select substr(dtstatdate, 1, 6) mons,\n        case\n            when modename = '传统模式' and submodename like 'CG%' and mapname = '群屿' then '主题群屿'\n            when modename = '传统模式' and mapname = '群屿' then '传统群屿'\n            when modename = '传统模式' and mapname = '假日群岛' then '假日群岛'\n            when modename = '传统模式' and mapname = '荣耀之城' then '荣耀之城'\n            when submodename = '广域战场模式' then '广域战场'\n            when submodename = '极能形态模式' then '极能形态'\n            when modename = '组队竞技' then '组竞'\n            when modename = '乐园' then '乐园'\n            when modename = '领地' then '领地'\n            when modename = '广阔天地' then '广阔天地'\n            else '其他模式'\n        end imodename,\n        vplayerid,\n        sum(roundtime) / 60 roundtime,\n        sum(roundcnt) roundcnt\n   from dws_jordass_mode_roundrecord_di\n   where dtstatdate between '20190508' and '20250330'\n   group by vplayerid, substr(dtstatdate, 1, 6),\n        case\n            when modename = '传统模式' and submodename like 'CG%' and mapname = '群屿' then '主题群屿'\n            when modename = '传统模式' and mapname = '群屿' then '传统群屿'\n            when modename = '传统模式' and mapname = '假日群岛' then '假日群岛'\n            when modename = '传统模式' and mapname = '荣耀之城' then '荣耀之城'\n            when submodename = '广域战场模式' then '广域战场'\n            when submodename = '极能形态模式' then '极能形态'\n            when modename = '组队竞技' then '组竞'\n            when modename = '乐园' then '乐园'\n            when modename = '领地' then '领地'\n            when modename = '广阔天地' then '广阔天地'\n            else '其他模式'\n        end\n\n   union all\n\n   select substr (tdbank_imp_date, 1, 6) mons,\n        '隧道' as modename,\n        vplayerid,\n        sum(roundtime) / 60 roundtime,\n        count(distinct gameid) roundcnt\n   from dwd_jordass_playerexitgamerecord_hi\n   where tdbank_imp_date between '2024061800' and '2025033023'\n     and mode in (3001, 3002, 3003)\n   group by substr (tdbank_imp_date, 1, 6), vplayerid\n)\n\nselect a.mons,\n       a.imodename,\n       a.iusernum,\n       b.iusernumall\nfrom (\n    select mons,\n          imodename,\n          count(vplayerid) iusernum\n    from (\n        select mons, vplayerid, imodename\n        from (\n            select mons,\n                vplayerid,\n                imodename,\n                roundtime,\n                row_number() over (partition by mons, vplayerid order by roundtime desc) as rn\n            from main_user\n        )ff1\n        where rn = 1\n    )f1\n   group by mons, imodename\n) a\nleft join (\n    select mons,\n        imodename,\n        count(vplayerid) iusernumall\n   from main_user\n   group by mons, imodename\n) b \non a.imodename = b.imodename and a.mons = b.mons\norder by a.mons, a.imodename\n;\n",
        "status": "success",
        "result": [
            {
                "mons": "201905",
                "imodename": "主题群屿",
                "iusernum": 119,
                "iusernumall": 119
            },
            {
                "mons": "201905",
                "imodename": "乐园",
                "iusernum": 2,
                "iusernumall": 2
            },
            {
                "mons": "201905",
                "imodename": "传统群屿",
                "iusernum": 4,
                "iusernumall": 4
            },
            {
                "mons": "201905",
                "imodename": "假日群岛",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "201905",
                "imodename": "其他模式",
                "iusernum": 2,
                "iusernumall": 2
            },
            {
                "mons": "201905",
                "imodename": "广阔天地",
                "iusernum": 2,
                "iusernumall": 2
            },
            {
                "mons": "201905",
                "imodename": "组竞",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "201905",
                "imodename": "荣耀之城",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "201905",
                "imodename": "领地",
                "iusernum": 2,
                "iusernumall": 2
            },
            {
                "mons": "201906",
                "imodename": "传统群屿",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "201908",
                "imodename": "假日群岛",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "201909",
                "imodename": "荣耀之城",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "201910",
                "imodename": "广域战场",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "201911",
                "imodename": "极能形态",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "201912",
                "imodename": "组竞",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202001",
                "imodename": "主题群屿",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202001",
                "imodename": "乐园",
                "iusernum": 2,
                "iusernumall": 2
            },
            {
                "mons": "202001",
                "imodename": "传统群屿",
                "iusernum": 3,
                "iusernumall": 3
            },
            {
                "mons": "202001",
                "imodename": "假日群岛",
                "iusernum": 2,
                "iusernumall": 2
            },
            {
                "mons": "202001",
                "imodename": "其他模式",
                "iusernum": 2,
                "iusernumall": 2
            },
            {
                "mons": "202001",
                "imodename": "广阔天地",
                "iusernum": 2,
                "iusernumall": 2
            },
            {
                "mons": "202001",
                "imodename": "组竞",
                "iusernum": 2,
                "iusernumall": 2
            },
            {
                "mons": "202001",
                "imodename": "荣耀之城",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202001",
                "imodename": "领地",
                "iusernum": 2,
                "iusernumall": 2
            },
            {
                "mons": "202002",
                "imodename": "领地",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202004",
                "imodename": "其他模式",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202006",
                "imodename": "假日群岛",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202007",
                "imodename": "荣耀之城",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202008",
                "imodename": "广域战场",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202009",
                "imodename": "极能形态",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202010",
                "imodename": "组竞",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202011",
                "imodename": "乐园",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202012",
                "imodename": "领地",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202101",
                "imodename": "广阔天地",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202102",
                "imodename": "其他模式",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202103",
                "imodename": "传统群屿",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202104",
                "imodename": "假日群岛",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202105",
                "imodename": "荣耀之城",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202106",
                "imodename": "乐园",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202106",
                "imodename": "传统群屿",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202106",
                "imodename": "假日群岛",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202106",
                "imodename": "其他模式",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202106",
                "imodename": "广阔天地",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202106",
                "imodename": "荣耀之城",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202209",
                "imodename": "极能形态",
                "iusernum": 2,
                "iusernumall": 2
            },
            {
                "mons": "202212",
                "imodename": "主题群屿",
                "iusernum": 2,
                "iusernumall": 2
            },
            {
                "mons": "202301",
                "imodename": "主题群屿",
                "iusernum": 30,
                "iusernumall": 34
            },
            {
                "mons": "202301",
                "imodename": "其他模式",
                "iusernum": 12,
                "iusernumall": 15
            },
            {
                "mons": "202301",
                "imodename": "组竞",
                "iusernum": 5,
                "iusernumall": 7
            },
            {
                "mons": "202304",
                "imodename": "乐园",
                "iusernum": 4,
                "iusernumall": 4
            },
            {
                "mons": "202305",
                "imodename": "乐园",
                "iusernum": 5,
                "iusernumall": 5
            },
            {
                "mons": "202306",
                "imodename": "乐园",
                "iusernum": 19,
                "iusernumall": 23
            },
            {
                "mons": "202306",
                "imodename": "传统群屿",
                "iusernum": 2,
                "iusernumall": 6
            },
            {
                "mons": "202306",
                "imodename": "其他模式",
                "iusernum": 2,
                "iusernumall": 3
            },
            {
                "mons": "202307",
                "imodename": "主题群屿",
                "iusernum": 1,
                "iusernumall": 2
            },
            {
                "mons": "202307",
                "imodename": "假日群岛",
                "iusernum": 4,
                "iusernumall": 6
            },
            {
                "mons": "202307",
                "imodename": "其他模式",
                "iusernum": 17,
                "iusernumall": 21
            },
            {
                "mons": "202307",
                "imodename": "广阔天地",
                "iusernum": 3,
                "iusernumall": 6
            },
            {
                "mons": "202307",
                "imodename": "极能形态",
                "iusernum": 2,
                "iusernumall": 4
            },
            {
                "mons": "202307",
                "imodename": "组竞",
                "iusernum": 10,
                "iusernumall": 15
            },
            {
                "mons": "202308",
                "imodename": "主题群屿",
                "iusernum": 2,
                "iusernumall": 2
            },
            {
                "mons": "202308",
                "imodename": "乐园",
                "iusernum": 2,
                "iusernumall": 5
            },
            {
                "mons": "202308",
                "imodename": "假日群岛",
                "iusernum": 8,
                "iusernumall": 11
            },
            {
                "mons": "202308",
                "imodename": "其他模式",
                "iusernum": 13,
                "iusernumall": 19
            },
            {
                "mons": "202308",
                "imodename": "广阔天地",
                "iusernum": 2,
                "iusernumall": 7
            },
            {
                "mons": "202308",
                "imodename": "极能形态",
                "iusernum": 10,
                "iusernumall": 13
            },
            {
                "mons": "202308",
                "imodename": "组竞",
                "iusernum": 314,
                "iusernumall": 325
            },
            {
                "mons": "202401",
                "imodename": "主题群屿",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202401",
                "imodename": "其他模式",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202402",
                "imodename": "主题群屿",
                "iusernum": 25,
                "iusernumall": 27
            },
            {
                "mons": "202402",
                "imodename": "其他模式",
                "iusernum": 5,
                "iusernumall": 9
            },
            {
                "mons": "202402",
                "imodename": "组竞",
                "iusernum": 10,
                "iusernumall": 13
            },
            {
                "mons": "202403",
                "imodename": "主题群屿",
                "iusernum": 41,
                "iusernumall": 83
            },
            {
                "mons": "202403",
                "imodename": "传统群屿",
                "iusernum": 22,
                "iusernumall": 34
            },
            {
                "mons": "202403",
                "imodename": "假日群岛",
                "iusernum": 38,
                "iusernumall": 78
            },
            {
                "mons": "202403",
                "imodename": "其他模式",
                "iusernum": 14,
                "iusernumall": 38
            },
            {
                "mons": "202403",
                "imodename": "极能形态",
                "iusernum": 40,
                "iusernumall": 60
            },
            {
                "mons": "202404",
                "imodename": "主题群屿",
                "iusernum": 63,
                "iusernumall": 94
            },
            {
                "mons": "202404",
                "imodename": "乐园",
                "iusernum": 6,
                "iusernumall": 15
            },
            {
                "mons": "202404",
                "imodename": "传统群屿",
                "iusernum": 35,
                "iusernumall": 42
            },
            {
                "mons": "202404",
                "imodename": "假日群岛",
                "iusernum": 63,
                "iusernumall": 129
            },
            {
                "mons": "202404",
                "imodename": "其他模式",
                "iusernum": 42,
                "iusernumall": 85
            },
            {
                "mons": "202404",
                "imodename": "广阔天地",
                "iusernum": 3,
                "iusernumall": 5
            },
            {
                "mons": "202404",
                "imodename": "极能形态",
                "iusernum": 84,
                "iusernumall": 119
            },
            {
                "mons": "202404",
                "imodename": "组竞",
                "iusernum": 311,
                "iusernumall": 338
            },
            {
                "mons": "202404",
                "imodename": "领地",
                "iusernum": 4,
                "iusernumall": 6
            },
            {
                "mons": "202405",
                "imodename": "主题群屿",
                "iusernum": 34,
                "iusernumall": 56
            },
            {
                "mons": "202405",
                "imodename": "乐园",
                "iusernum": 3,
                "iusernumall": 6
            },
            {
                "mons": "202405",
                "imodename": "传统群屿",
                "iusernum": 16,
                "iusernumall": 22
            },
            {
                "mons": "202405",
                "imodename": "假日群岛",
                "iusernum": 34,
                "iusernumall": 62
            },
            {
                "mons": "202405",
                "imodename": "其他模式",
                "iusernum": 25,
                "iusernumall": 41
            },
            {
                "mons": "202405",
                "imodename": "极能形态",
                "iusernum": 42,
                "iusernumall": 59
            },
            {
                "mons": "202405",
                "imodename": "组竞",
                "iusernum": 252,
                "iusernumall": 265
            },
            {
                "mons": "202405",
                "imodename": "领地",
                "iusernum": 5,
                "iusernumall": 8
            },
            {
                "mons": "202406",
                "imodename": "主题群屿",
                "iusernum": 60,
                "iusernumall": 108
            },
            {
                "mons": "202406",
                "imodename": "乐园",
                "iusernum": 6,
                "iusernumall": 10
            },
            {
                "mons": "202406",
                "imodename": "传统群屿",
                "iusernum": 35,
                "iusernumall": 56
            },
            {
                "mons": "202406",
                "imodename": "假日群岛",
                "iusernum": 48,
                "iusernumall": 120
            },
            {
                "mons": "202406",
                "imodename": "其他模式",
                "iusernum": 262,
                "iusernumall": 315
            },
            {
                "mons": "202406",
                "imodename": "广阔天地",
                "iusernum": 1,
                "iusernumall": 3
            },
            {
                "mons": "202406",
                "imodename": "极能形态",
                "iusernum": 87,
                "iusernumall": 122
            },
            {
                "mons": "202406",
                "imodename": "组竞",
                "iusernum": 22,
                "iusernumall": 38
            },
            {
                "mons": "202406",
                "imodename": "隧道",
                "iusernum": 80,
                "iusernumall": 80
            },
            {
                "mons": "202407",
                "imodename": "主题群屿",
                "iusernum": 2,
                "iusernumall": 7
            },
            {
                "mons": "202407",
                "imodename": "乐园",
                "iusernum": 7,
                "iusernumall": 11
            },
            {
                "mons": "202407",
                "imodename": "传统群屿",
                "iusernum": 2,
                "iusernumall": 2
            },
            {
                "mons": "202407",
                "imodename": "假日群岛",
                "iusernum": 8,
                "iusernumall": 15
            },
            {
                "mons": "202407",
                "imodename": "其他模式",
                "iusernum": 32,
                "iusernumall": 49
            },
            {
                "mons": "202407",
                "imodename": "广域战场",
                "iusernum": 290,
                "iusernumall": 294
            },
            {
                "mons": "202407",
                "imodename": "极能形态",
                "iusernum": 12,
                "iusernumall": 16
            },
            {
                "mons": "202407",
                "imodename": "组竞",
                "iusernum": 23,
                "iusernumall": 36
            },
            {
                "mons": "202407",
                "imodename": "隧道",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202407",
                "imodename": "领地",
                "iusernum": 1,
                "iusernumall": 2
            },
            {
                "mons": "202408",
                "imodename": "乐园",
                "iusernum": 5,
                "iusernumall": 7
            },
            {
                "mons": "202408",
                "imodename": "假日群岛",
                "iusernum": 7,
                "iusernumall": 8
            },
            {
                "mons": "202408",
                "imodename": "其他模式",
                "iusernum": 33,
                "iusernumall": 42
            },
            {
                "mons": "202408",
                "imodename": "广域战场",
                "iusernum": 6,
                "iusernumall": 8
            },
            {
                "mons": "202408",
                "imodename": "广阔天地",
                "iusernum": 1,
                "iusernumall": 2
            },
            {
                "mons": "202408",
                "imodename": "极能形态",
                "iusernum": 7,
                "iusernumall": 12
            },
            {
                "mons": "202408",
                "imodename": "组竞",
                "iusernum": 13,
                "iusernumall": 21
            },
            {
                "mons": "202408",
                "imodename": "隧道",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202408",
                "imodename": "领地",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202409",
                "imodename": "主题群屿",
                "iusernum": 13,
                "iusernumall": 17
            },
            {
                "mons": "202409",
                "imodename": "乐园",
                "iusernum": 6,
                "iusernumall": 7
            },
            {
                "mons": "202409",
                "imodename": "传统群屿",
                "iusernum": 1,
                "iusernumall": 2
            },
            {
                "mons": "202409",
                "imodename": "假日群岛",
                "iusernum": 13,
                "iusernumall": 14
            },
            {
                "mons": "202409",
                "imodename": "其他模式",
                "iusernum": 268,
                "iusernumall": 273
            },
            {
                "mons": "202409",
                "imodename": "极能形态",
                "iusernum": 3,
                "iusernumall": 6
            },
            {
                "mons": "202409",
                "imodename": "组竞",
                "iusernum": 5,
                "iusernumall": 13
            },
            {
                "mons": "202410",
                "imodename": "主题群屿",
                "iusernum": 2,
                "iusernumall": 10
            },
            {
                "mons": "202410",
                "imodename": "乐园",
                "iusernum": 7,
                "iusernumall": 20
            },
            {
                "mons": "202410",
                "imodename": "传统群屿",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202410",
                "imodename": "假日群岛",
                "iusernum": 3,
                "iusernumall": 11
            },
            {
                "mons": "202410",
                "imodename": "其他模式",
                "iusernum": 208,
                "iusernumall": 223
            },
            {
                "mons": "202410",
                "imodename": "广域战场",
                "iusernum": 1,
                "iusernumall": 4
            },
            {
                "mons": "202410",
                "imodename": "广阔天地",
                "iusernum": 1,
                "iusernumall": 3
            },
            {
                "mons": "202410",
                "imodename": "极能形态",
                "iusernum": 8,
                "iusernumall": 15
            },
            {
                "mons": "202410",
                "imodename": "组竞",
                "iusernum": 9,
                "iusernumall": 21
            },
            {
                "mons": "202410",
                "imodename": "隧道",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202410",
                "imodename": "领地",
                "iusernum": 2,
                "iusernumall": 10
            },
            {
                "mons": "202411",
                "imodename": "主题群屿",
                "iusernum": 9,
                "iusernumall": 14
            },
            {
                "mons": "202411",
                "imodename": "乐园",
                "iusernum": 8,
                "iusernumall": 16
            },
            {
                "mons": "202411",
                "imodename": "传统群屿",
                "iusernum": 1,
                "iusernumall": 2
            },
            {
                "mons": "202411",
                "imodename": "假日群岛",
                "iusernum": 8,
                "iusernumall": 19
            },
            {
                "mons": "202411",
                "imodename": "其他模式",
                "iusernum": 309,
                "iusernumall": 333
            },
            {
                "mons": "202411",
                "imodename": "广域战场",
                "iusernum": 4,
                "iusernumall": 7
            },
            {
                "mons": "202411",
                "imodename": "极能形态",
                "iusernum": 5,
                "iusernumall": 11
            },
            {
                "mons": "202411",
                "imodename": "组竞",
                "iusernum": 15,
                "iusernumall": 27
            },
            {
                "mons": "202411",
                "imodename": "隧道",
                "iusernum": 1,
                "iusernumall": 1
            },
            {
                "mons": "202411",
                "imodename": "领地",
                "iusernum": 3,
                "iusernumall": 4
            },
            {
                "mons": "202412",
                "imodename": "隧道",
                "iusernum": 4,
                "iusernumall": 4
            },
            {
                "mons": "202501",
                "imodename": "主题群屿",
                "iusernum": 19,
                "iusernumall": 24
            },
            {
                "mons": "202501",
                "imodename": "其他模式",
                "iusernum": 11,
                "iusernumall": 12
            },
            {
                "mons": "202501",
                "imodename": "组竞",
                "iusernum": 7,
                "iusernumall": 8
            },
            {
                "mons": "202501",
                "imodename": "隧道",
                "iusernum": 4,
                "iusernumall": 4
            },
            {
                "mons": "202502",
                "imodename": "主题群屿",
                "iusernum": 10,
                "iusernumall": 20
            },
            {
                "mons": "202502",
                "imodename": "乐园",
                "iusernum": 2,
                "iusernumall": 5
            },
            {
                "mons": "202502",
                "imodename": "其他模式",
                "iusernum": 13,
                "iusernumall": 22
            },
            {
                "mons": "202502",
                "imodename": "广阔天地",
                "iusernum": 4,
                "iusernumall": 8
            },
            {
                "mons": "202502",
                "imodename": "组竞",
                "iusernum": 3,
                "iusernumall": 7
            },
            {
                "mons": "202502",
                "imodename": "隧道",
                "iusernum": 4,
                "iusernumall": 4
            },
            {
                "mons": "202502",
                "imodename": "领地",
                "iusernum": 6,
                "iusernumall": 11
            },
            {
                "mons": "202503",
                "imodename": "主题群屿",
                "iusernum": 21,
                "iusernumall": 30
            },
            {
                "mons": "202503",
                "imodename": "乐园",
                "iusernum": 1,
                "iusernumall": 4
            },
            {
                "mons": "202503",
                "imodename": "传统群屿",
                "iusernum": 1,
                "iusernumall": 2
            },
            {
                "mons": "202503",
                "imodename": "其他模式",
                "iusernum": 7,
                "iusernumall": 17
            },
            {
                "mons": "202503",
                "imodename": "广阔天地",
                "iusernum": 3,
                "iusernumall": 10
            },
            {
                "mons": "202503",
                "imodename": "组竞",
                "iusernum": 1,
                "iusernumall": 4
            },
            {
                "mons": "202503",
                "imodename": "隧道",
                "iusernum": 21,
                "iusernumall": 27
            },
            {
                "mons": "202503",
                "imodename": "领地",
                "iusernum": 4,
                "iusernumall": 10
            }
        ]
    },
    {
        "sql_id": "sql_33",
        "sql": "\nselect\n    count(distinct a.vplayerid) as total_players,\n    count(distinct case when b.vplayerid is not null then a.vplayerid end) as existing_players,\n    count(distinct case when b.vplayerid is null then a.vplayerid end) as new_players\nfrom (\n    select vplayerid\n    from dws_jordass_matchlog_stat_di\n    where dtstatdate between '20241214' and '20241220'\n    and imode = 1344338933661592832\n    and platid = 255\n    group by vplayerid\n) a\nleft join (\n    select vplayerid\n    from dws_jordass_playermatchrecord_stat_df\n    where dtstatdate = '20241213'\n    and imode = 1344338933661592832\n    and platid = 255\n    group by vplayerid\n) b\non a.vplayerid = b.vplayerid;\n",
        "status": "success",
        "result": [
            {
                "total_players": 11,
                "existing_players": 4,
                "new_players": 7
            }
        ]
    },
    {
        "sql_id": "sql_34",
        "sql": "\nwith click_join as (\n    select dtstatdate, vplayerid\n    from dws_jordass_buttonpress_pre_di\n    where (dtstatdate between '20240917' and '20240923' or dtstatdate between '20241008' and '20241014')\n    and buttontype = '411120'  -- 加入玩法\n    group by dtstatdate, vplayerid\n),\nclick_confirm as (\n    select dtstatdate, vplayerid\n    from dws_jordass_buttonpress_pre_di\n    where (dtstatdate between '20240917' and '20240923' or dtstatdate between '20241008' and '20241014')\n    and buttontype = '411123'  -- 确认\n    group by dtstatdate, vplayerid\n),\nvalid_users as (\n    select a.dtstatdate, a.vplayerid\n    from click_join a\n    join click_confirm b on a.dtstatdate = b.dtstatdate and a.vplayerid = b.vplayerid\n),\njoin_counts as (\n    select dtstatdate, vplayerid, count(*) as join_times\n    from dws_jordass_buttonpress_pre_di\n    where (dtstatdate between '20240917' and '20240923' or dtstatdate between '20241008' and '20241014')\n    and buttontype = '411120'  -- 加入玩法\n    group by dtstatdate, vplayerid\n)\n\nselect \n    v.dtstatdate,\n    count(distinct v.vplayerid) as user_count,\n    sum(case when j.join_times is not null then j.join_times else 0 end) as join_count\nfrom valid_users v\nleft join join_counts j on v.dtstatdate = j.dtstatdate and v.vplayerid = j.vplayerid\ngroup by v.dtstatdate\norder by v.dtstatdate;\n",
        "status": "success",
        "result": [
            {
                "dtstatdate": "20240917",
                "user_count": 1,
                "join_count": 1
            },
            {
                "dtstatdate": "20240918",
                "user_count": 6,
                "join_count": 9
            },
            {
                "dtstatdate": "20240919",
                "user_count": 5,
                "join_count": 7
            },
            {
                "dtstatdate": "20240920",
                "user_count": 3,
                "join_count": 3
            },
            {
                "dtstatdate": "20240921",
                "user_count": 1,
                "join_count": 1
            },
            {
                "dtstatdate": "20240922",
                "user_count": 1,
                "join_count": 1
            },
            {
                "dtstatdate": "20240923",
                "user_count": 1,
                "join_count": 1
            },
            {
                "dtstatdate": "20241008",
                "user_count": 1,
                "join_count": 1
            },
            {
                "dtstatdate": "20241009",
                "user_count": 6,
                "join_count": 11
            },
            {
                "dtstatdate": "20241010",
                "user_count": 6,
                "join_count": 6
            },
            {
                "dtstatdate": "20241014",
                "user_count": 1,
                "join_count": 1
            }
        ]
    },
    {
        "sql_id": "sql_35",
        "sql": "\nwith daily_stats as (\n    select \n        dtstatdate,\n        case \n            when mode in (401, 402, 403) then '第一人称'\n            when mode = 101 then '单排'\n            when mode = 102 then '双排'\n            when mode in (103, 603) then '四排'\n        end as match_type,\n        count(distinct vplayerid) as daily_players,\n        sum(roundcnt) as daily_rounds,\n        sum(roundtime) as daily_time\n    from dws_jordass_mode_roundrecord_di\n    where (dtstatdate between '20240326' and '20240403' or dtstatdate between '20240528' and '20240605')\n    and mode in (101, 102, 103, 603, 401, 402, 403)\n    group by dtstatdate, \n        case \n            when mode in (401, 402, 403) then '第一人称'\n            when mode = 101 then '单排'\n            when mode = 102 then '双排'\n            when mode in (103, 603) then '四排'\n        end\n),\n\ngame_retention as (\n    select \n        a.dtstatdate,\n        case \n            when a.mode in (401, 402, 403) then '第一人称'\n            when a.mode = 101 then '单排'\n            when a.mode = 102 then '双排'\n            when a.mode in (103, 603) then '四排'\n        end as match_type,\n        count(distinct case when b.vplayerid is not null then a.vplayerid end) as game_next_day_retention,\n        count(distinct case when c.vplayerid is not null then a.vplayerid end) as game_7_day_retention\n    from dws_jordass_mode_roundrecord_di a\n    left join dws_jordass_login_di b \n        on a.vplayerid = b.vplayerid \n        and b.dtstatdate = date_add(a.dtstatdate, 1)\n    left join dws_jordass_login_di c \n        on a.vplayerid = c.vplayerid \n        and c.dtstatdate = date_add(a.dtstatdate, 7)\n    where (a.dtstatdate between '20240326' and '20240403' or a.dtstatdate between '20240528' and '20240605')\n    and a.mode in (101, 102, 103, 603, 401, 402, 403)\n    group by a.dtstatdate, \n        case \n            when a.mode in (401, 402, 403) then '第一人称'\n            when a.mode = 101 then '单排'\n            when a.mode = 102 then '双排'\n            when a.mode in (103, 603) then '四排'\n        end\n),\n\nmode_retention as (\n    select \n        a.dtstatdate,\n        case \n            when a.mode in (401, 402, 403) then '第一人称'\n            when a.mode = 101 then '单排'\n            when a.mode = 102 then '双排'\n            when a.mode in (103, 603) then '四排'\n        end as match_type,\n        count(distinct case when b.vplayerid is not null then a.vplayerid end) as mode_next_day_retention,\n        count(distinct case when c.vplayerid is not null then a.vplayerid end) as mode_7_day_retention\n    from dws_jordass_mode_roundrecord_di a\n    left join dws_jordass_mode_roundrecord_di b \n        on a.vplayerid = b.vplayerid \n        and b.dtstatdate = date_add(a.dtstatdate, 1)\n        and b.mode = a.mode\n    left join dws_jordass_mode_roundrecord_di c \n        on a.vplayerid = c.vplayerid \n        and c.dtstatdate = date_add(a.dtstatdate, 7)\n        and c.mode = a.mode\n    where (a.dtstatdate between '20240326' and '20240403' or a.dtstatdate between '20240528' and '20240605')\n    and a.mode in (101, 102, 103, 603, 401, 402, 403)\n    group by a.dtstatdate, \n        case \n            when a.mode in (401, 402, 403) then '第一人称'\n            when a.mode = 101 then '单排'\n            when a.mode = 102 then '双排'\n            when a.mode in (103, 603) then '四排'\n        end\n)\n\nselect \n    d.dtstatdate,\n    d.match_type,\n    d.daily_players,\n    d.daily_rounds,\n    d.daily_time,\n    g.game_next_day_retention,\n    g.game_7_day_retention,\n    m.mode_next_day_retention,\n    m.mode_7_day_retention\nfrom daily_stats d\nleft join game_retention g \n    on d.dtstatdate = g.dtstatdate \n    and d.match_type = g.match_type\nleft join mode_retention m \n    on d.dtstatdate = m.dtstatdate \n    and d.match_type = m.match_type\norder by d.dtstatdate, d.match_type\n",
        "status": "success",
        "result": [
            {
                "dtstatdate": "20240326",
                "match_type": "单排",
                "daily_players": 1,
                "daily_rounds": 2,
                "daily_time": 997,
                "game_next_day_retention": 0,
                "game_7_day_retention": 1,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240326",
                "match_type": "双排",
                "daily_players": 5,
                "daily_rounds": 19,
                "daily_time": 8711,
                "game_next_day_retention": 1,
                "game_7_day_retention": 1,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 1
            },
            {
                "dtstatdate": "20240326",
                "match_type": "四排",
                "daily_players": 38,
                "daily_rounds": 285,
                "daily_time": 336281,
                "game_next_day_retention": 3,
                "game_7_day_retention": 8,
                "mode_next_day_retention": 1,
                "mode_7_day_retention": 10
            },
            {
                "dtstatdate": "20240326",
                "match_type": "第一人称",
                "daily_players": 1,
                "daily_rounds": 17,
                "daily_time": 8087,
                "game_next_day_retention": 0,
                "game_7_day_retention": 1,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240327",
                "match_type": "单排",
                "daily_players": 3,
                "daily_rounds": 59,
                "daily_time": 37746,
                "game_next_day_retention": 3,
                "game_7_day_retention": 2,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240327",
                "match_type": "双排",
                "daily_players": 5,
                "daily_rounds": 26,
                "daily_time": 10401,
                "game_next_day_retention": 2,
                "game_7_day_retention": 1,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240327",
                "match_type": "四排",
                "daily_players": 37,
                "daily_rounds": 262,
                "daily_time": 270292,
                "game_next_day_retention": 5,
                "game_7_day_retention": 3,
                "mode_next_day_retention": 1,
                "mode_7_day_retention": 4
            },
            {
                "dtstatdate": "20240327",
                "match_type": "第一人称",
                "daily_players": 1,
                "daily_rounds": 7,
                "daily_time": 8737,
                "game_next_day_retention": 0,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240328",
                "match_type": "双排",
                "daily_players": 2,
                "daily_rounds": 2,
                "daily_time": 2427,
                "game_next_day_retention": 2,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240328",
                "match_type": "四排",
                "daily_players": 43,
                "daily_rounds": 352,
                "daily_time": 385959,
                "game_next_day_retention": 8,
                "game_7_day_retention": 7,
                "mode_next_day_retention": 34,
                "mode_7_day_retention": 11
            },
            {
                "dtstatdate": "20240329",
                "match_type": "双排",
                "daily_players": 2,
                "daily_rounds": 12,
                "daily_time": 6366,
                "game_next_day_retention": 0,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240329",
                "match_type": "四排",
                "daily_players": 43,
                "daily_rounds": 327,
                "daily_time": 404190,
                "game_next_day_retention": 2,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 1
            },
            {
                "dtstatdate": "20240329",
                "match_type": "第一人称",
                "daily_players": 1,
                "daily_rounds": 6,
                "daily_time": 2140,
                "game_next_day_retention": 0,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240330",
                "match_type": "单排",
                "daily_players": 2,
                "daily_rounds": 8,
                "daily_time": 4421,
                "game_next_day_retention": 0,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240330",
                "match_type": "双排",
                "daily_players": 4,
                "daily_rounds": 13,
                "daily_time": 7994,
                "game_next_day_retention": 0,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 1
            },
            {
                "dtstatdate": "20240330",
                "match_type": "四排",
                "daily_players": 43,
                "daily_rounds": 383,
                "daily_time": 406666,
                "game_next_day_retention": 5,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 8,
                "mode_7_day_retention": 3
            },
            {
                "dtstatdate": "20240330",
                "match_type": "第一人称",
                "daily_players": 1,
                "daily_rounds": 1,
                "daily_time": 301,
                "game_next_day_retention": 0,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240331",
                "match_type": "双排",
                "daily_players": 6,
                "daily_rounds": 34,
                "daily_time": 30560,
                "game_next_day_retention": 0,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 1,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240331",
                "match_type": "四排",
                "daily_players": 38,
                "daily_rounds": 296,
                "daily_time": 376187,
                "game_next_day_retention": 5,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 5,
                "mode_7_day_retention": 4
            },
            {
                "dtstatdate": "20240331",
                "match_type": "第一人称",
                "daily_players": 3,
                "daily_rounds": 15,
                "daily_time": 9441,
                "game_next_day_retention": 0,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240401",
                "match_type": "单排",
                "daily_players": 1,
                "daily_rounds": 1,
                "daily_time": 730,
                "game_next_day_retention": 0,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240401",
                "match_type": "双排",
                "daily_players": 2,
                "daily_rounds": 9,
                "daily_time": 11860,
                "game_next_day_retention": 1,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240401",
                "match_type": "四排",
                "daily_players": 44,
                "daily_rounds": 261,
                "daily_time": 272629,
                "game_next_day_retention": 5,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 5,
                "mode_7_day_retention": 6
            },
            {
                "dtstatdate": "20240402",
                "match_type": "单排",
                "daily_players": 1,
                "daily_rounds": 1,
                "daily_time": 1288,
                "game_next_day_retention": 0,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240402",
                "match_type": "双排",
                "daily_players": 7,
                "daily_rounds": 16,
                "daily_time": 12280,
                "game_next_day_retention": 2,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240402",
                "match_type": "四排",
                "daily_players": 42,
                "daily_rounds": 260,
                "daily_time": 322039,
                "game_next_day_retention": 8,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 25,
                "mode_7_day_retention": 3
            },
            {
                "dtstatdate": "20240403",
                "match_type": "单排",
                "daily_players": 2,
                "daily_rounds": 3,
                "daily_time": 1517,
                "game_next_day_retention": 0,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240403",
                "match_type": "双排",
                "daily_players": 1,
                "daily_rounds": 2,
                "daily_time": 765,
                "game_next_day_retention": 0,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 1,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240403",
                "match_type": "四排",
                "daily_players": 35,
                "daily_rounds": 170,
                "daily_time": 205470,
                "game_next_day_retention": 6,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 26,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240403",
                "match_type": "第一人称",
                "daily_players": 1,
                "daily_rounds": 2,
                "daily_time": 1053,
                "game_next_day_retention": 0,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240528",
                "match_type": "单排",
                "daily_players": 1,
                "daily_rounds": 1,
                "daily_time": 1883,
                "game_next_day_retention": 0,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 1,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240528",
                "match_type": "双排",
                "daily_players": 4,
                "daily_rounds": 7,
                "daily_time": 8759,
                "game_next_day_retention": 0,
                "game_7_day_retention": 2,
                "mode_next_day_retention": 3,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240528",
                "match_type": "四排",
                "daily_players": 42,
                "daily_rounds": 284,
                "daily_time": 351792,
                "game_next_day_retention": 9,
                "game_7_day_retention": 11,
                "mode_next_day_retention": 35,
                "mode_7_day_retention": 5
            },
            {
                "dtstatdate": "20240529",
                "match_type": "单排",
                "daily_players": 2,
                "daily_rounds": 6,
                "daily_time": 4668,
                "game_next_day_retention": 0,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240529",
                "match_type": "双排",
                "daily_players": 5,
                "daily_rounds": 23,
                "daily_time": 22254,
                "game_next_day_retention": 2,
                "game_7_day_retention": 1,
                "mode_next_day_retention": 2,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240529",
                "match_type": "四排",
                "daily_players": 40,
                "daily_rounds": 339,
                "daily_time": 342914,
                "game_next_day_retention": 10,
                "game_7_day_retention": 5,
                "mode_next_day_retention": 4,
                "mode_7_day_retention": 5
            },
            {
                "dtstatdate": "20240530",
                "match_type": "单排",
                "daily_players": 2,
                "daily_rounds": 3,
                "daily_time": 1515,
                "game_next_day_retention": 0,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 1,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240530",
                "match_type": "双排",
                "daily_players": 5,
                "daily_rounds": 37,
                "daily_time": 22921,
                "game_next_day_retention": 1,
                "game_7_day_retention": 2,
                "mode_next_day_retention": 2,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240530",
                "match_type": "四排",
                "daily_players": 38,
                "daily_rounds": 242,
                "daily_time": 289732,
                "game_next_day_retention": 5,
                "game_7_day_retention": 7,
                "mode_next_day_retention": 34,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240531",
                "match_type": "单排",
                "daily_players": 2,
                "daily_rounds": 6,
                "daily_time": 3002,
                "game_next_day_retention": 0,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240531",
                "match_type": "双排",
                "daily_players": 5,
                "daily_rounds": 33,
                "daily_time": 22420,
                "game_next_day_retention": 1,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 1,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240531",
                "match_type": "四排",
                "daily_players": 44,
                "daily_rounds": 328,
                "daily_time": 366291,
                "game_next_day_retention": 3,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 11,
                "mode_7_day_retention": 1
            },
            {
                "dtstatdate": "20240601",
                "match_type": "双排",
                "daily_players": 8,
                "daily_rounds": 19,
                "daily_time": 11623,
                "game_next_day_retention": 0,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 2
            },
            {
                "dtstatdate": "20240601",
                "match_type": "四排",
                "daily_players": 47,
                "daily_rounds": 314,
                "daily_time": 413761,
                "game_next_day_retention": 5,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 5
            },
            {
                "dtstatdate": "20240602",
                "match_type": "单排",
                "daily_players": 3,
                "daily_rounds": 4,
                "daily_time": 2765,
                "game_next_day_retention": 0,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 2,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240602",
                "match_type": "双排",
                "daily_players": 2,
                "daily_rounds": 2,
                "daily_time": 439,
                "game_next_day_retention": 0,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240602",
                "match_type": "四排",
                "daily_players": 46,
                "daily_rounds": 267,
                "daily_time": 327552,
                "game_next_day_retention": 9,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 35,
                "mode_7_day_retention": 2
            },
            {
                "dtstatdate": "20240603",
                "match_type": "单排",
                "daily_players": 4,
                "daily_rounds": 6,
                "daily_time": 2745,
                "game_next_day_retention": 1,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240603",
                "match_type": "双排",
                "daily_players": 1,
                "daily_rounds": 3,
                "daily_time": 2680,
                "game_next_day_retention": 1,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240603",
                "match_type": "四排",
                "daily_players": 43,
                "daily_rounds": 183,
                "daily_time": 220353,
                "game_next_day_retention": 9,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 2,
                "mode_7_day_retention": 5
            },
            {
                "dtstatdate": "20240604",
                "match_type": "单排",
                "daily_players": 1,
                "daily_rounds": 1,
                "daily_time": 562,
                "game_next_day_retention": 0,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240604",
                "match_type": "双排",
                "daily_players": 2,
                "daily_rounds": 7,
                "daily_time": 3783,
                "game_next_day_retention": 0,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240604",
                "match_type": "四排",
                "daily_players": 37,
                "daily_rounds": 293,
                "daily_time": 335822,
                "game_next_day_retention": 3,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 7,
                "mode_7_day_retention": 6
            },
            {
                "dtstatdate": "20240605",
                "match_type": "双排",
                "daily_players": 2,
                "daily_rounds": 13,
                "daily_time": 7579,
                "game_next_day_retention": 0,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240605",
                "match_type": "四排",
                "daily_players": 42,
                "daily_rounds": 247,
                "daily_time": 331124,
                "game_next_day_retention": 6,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 6,
                "mode_7_day_retention": 0
            }
        ]
    },
    {
        "sql_id": "sql_37",
        "sql": "\nwith user_registration as (\n    select \n        dregdate as reg_date,\n        vplayerid,\n        '模拟器' as user_type\n    from dws_jordass_emulator_df\n    where dregdate between '20250401' and '20250530'\n    \n    union all\n    \n    select \n        dtstatdate as reg_date,\n        vplayerid,\n        case \n            when device_type in (1,5) then '模拟器'\n            when device_type = 0 then '手机端'\n            else '未知'\n        end as user_type\n    from dws_jordass_device_login_di\n    where dtstatdate between '20250401' and '50530'\n    and vplayerid not in (select vplayerid from dws_jordass_emulator_df where dregdate between '20250401' and '20250530')\n),\n\nuser_retention as (\n    select \n        a.reg_date,\n        a.user_type,\n        count(distinct a.vplayerid) as total_users,\n        count(distinct case when datediff(b.dtstatdate, a.reg_date) = 1 then a.vplayerid end) as day2_retention,\n        count(distinct case when datediff(b.dtstatdate, a.reg_date) = 2 then a.vplayerid end) as day3_retention,\n        count(distinct case when datediff(b.dtstatdate, a.reg_date) = 6 then a.vplayerid end) as day7_retention,\n        count(distinct case when datediff(b.dtstatdate, a.reg_date) = 13 then a.vplayerid end) as day14_retention,\n        count(distinct case when datediff(b.dtstatdate, a.reg_date) = 29 then a.vplayerid end) as day30_retention\n    from user_registration a\n    left join dws_jordass_login_di b\n    on a.vplayerid = b.vplayerid\n    and b.dtstatdate between a.reg_date and date_add(a.reg_date, 30)\n    group by a.reg_date, a.user_type\n)\n\nselect \n    reg_date,\n    total_users,\n    user_type,\n    day2_retention,\n    day3_retention,\n    day7_retention,\n    day14_retention,\n    day30_retention\nfrom user_retention\norder by reg_date, user_type;\n",
        "status": "success",
        "result": [
            {
                "reg_date": "20250401",
                "total_users": 6,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250402",
                "total_users": 6,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250403",
                "total_users": 6,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250404",
                "total_users": 6,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250405",
                "total_users": 6,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250406",
                "total_users": 6,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250407",
                "total_users": 6,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250408",
                "total_users": 6,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250409",
                "total_users": 6,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250410",
                "total_users": 6,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250411",
                "total_users": 6,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250412",
                "total_users": 7,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250413",
                "total_users": 6,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250414",
                "total_users": 6,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250415",
                "total_users": 7,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250416",
                "total_users": 7,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250417",
                "total_users": 6,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250418",
                "total_users": 6,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250419",
                "total_users": 6,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250420",
                "total_users": 6,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250421",
                "total_users": 6,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250422",
                "total_users": 6,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250423",
                "total_users": 6,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250424",
                "total_users": 6,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250425",
                "total_users": 6,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250426",
                "total_users": 7,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250427",
                "total_users": 6,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250428",
                "total_users": 6,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250429",
                "total_users": 8,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250430",
                "total_users": 6,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250501",
                "total_users": 6,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250502",
                "total_users": 6,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250503",
                "total_users": 6,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250504",
                "total_users": 7,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250505",
                "total_users": 7,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250506",
                "total_users": 6,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250507",
                "total_users": 6,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250508",
                "total_users": 6,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250509",
                "total_users": 7,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250510",
                "total_users": 6,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250511",
                "total_users": 6,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250512",
                "total_users": 6,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250513",
                "total_users": 6,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250514",
                "total_users": 6,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250515",
                "total_users": 6,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250516",
                "total_users": 6,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250517",
                "total_users": 6,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250518",
                "total_users": 6,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250519",
                "total_users": 6,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250520",
                "total_users": 6,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250521",
                "total_users": 6,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250522",
                "total_users": 6,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250523",
                "total_users": 6,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250524",
                "total_users": 6,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250525",
                "total_users": 8,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250526",
                "total_users": 6,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250527",
                "total_users": 6,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250528",
                "total_users": 6,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250529",
                "total_users": 6,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            },
            {
                "reg_date": "20250530",
                "total_users": 6,
                "user_type": "模拟器",
                "day2_retention": 0,
                "day3_retention": 0,
                "day7_retention": 0,
                "day14_retention": 0,
                "day30_retention": 0
            }
        ]
    },
    {
        "sql_id": "sql_38",
        "sql": "\nwith player_activity as (\n    -- 广域战场\n    select '广域战场' as game_mode, vplayerid, min(dtstatdate) as first_play_date\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate between '20240723' and date_add('20240723', 3)\n    and submodename = '广域战场模式'\n    group by vplayerid\n    \n    union all\n    -- 消灭战\n    select '消灭战', vplayerid, min(dtstatdate)\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate between '20230804' and date_add('20230804', 3)\n    and modename='组队竞技' and submodename like '%消灭战模式%'\n    group by vplayerid\n    \n    union all\n    -- 幻想混战\n    select '幻想混战', vplayerid, min(dtstatdate)\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate between '20241115' and date_add('20241115', 3)\n    and modename='创意创作间' and submodename='幻想混战'\n    group by vplayerid\n    \n    union all\n    -- 荒野传说\n    select '荒野传说', vplayerid, min(dtstatdate)\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate between '20240903' and date_add('20240903', 3)\n    and modename='休闲模式' and submodename in ('荒野传说','荒野沙漠')\n    group by vplayerid\n    \n    union all\n    -- 策略载具\n    select '策略载具', vplayerid, min(dtstatdate)\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate between '20241010' and date_add('20241010', 3)\n    and modename='休闲模式' and submodename like '%策略载具%'\n    group by vplayerid\n    \n    union all\n    -- 炎夏混战\n    select '炎夏混战', vplayerid, min(dtstatdate)\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate between '20240625' and date_add('20240625', 3)\n    and modename='创意创作间' and submodename like '%炎夏混战%'\n    group by vplayerid\n    \n    union all\n    -- 单人装备\n    select '单人装备', vplayerid, min(dtstatdate)\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate between '20240517' and date_add('20240517', 3)\n    and modename='组队竞技' and submodename like '%单人装备%'\n    group by vplayerid\n    \n    union all\n    -- 交叉堡垒\n    select '交叉堡垒', vplayerid, min(dtstatdate)\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate between '20240412' and date_add('20240412', 3)\n    and modename='组队竞技' and submodename like '%交叉堡垒%'\n    group by vplayerid\n),\n\nplayer_type_classification as (\n    select \n        a.game_mode,\n        a.vplayerid,\n        case\n            -- 砺刃新增：上线后3天(包含上线当天)砺刃新增用户，并且参与了玩法的用户\n            when b.dregdate >= substr(a.game_mode_launch_date, 1, 8) then '砺刃新增'\n            \n            -- 砺刃留存：上线前一周在砺刃活跃过，并且在上线后3天参与了玩法的用户\n            when exists (\n                select 1 from dws_jordass_login_df \n                where vplayerid = a.vplayerid \n                and dtstatdate between date_sub(a.game_mode_launch_date, 6) and date_sub(a.game_mode_launch_date, 1)\n            ) then '砺刃留存'\n            \n            -- 砺刃回流：上线前一周没有在砺刃活跃过，但是之前在砺刃注册过，并且上线后3天参与了玩法的用户\n            when not exists (\n                select 1 from dws_jordass_login_df \n                where vplayerid = a.vplayerid \n                and dtstatdate between date_sub(a.game_mode_launch_date, 6) and date_sub(a.game_mode_launch_date, 1)\n            ) and b.dregdate < substr(a.game_mode_launch_date, 1, 8) then\n                case\n                    -- 按上线日期前N天连续未活跃时长区分\n                    when datediff(a.game_mode_launch_date, \n                        (select max(dtstatdate) from dws_jordass_login_df where vplayerid = a.vplayerid and dtstatdate < a.game_mode_launch_date)\n                    ) between 7 and 13 then '砺刃回流（流失7-13天）'\n                    when datediff(a.game_mode_launch_date, \n                        (select max(dtstatdate) from dws_jordass_login_df where vplayerid = a.vplayerid and dtstatdate < a.game_mode_launch_date)\n                    ) between 14 and 20 then '砺刃回流（流失14-20天）'\n                    when datediff(a.game_mode_launch_date, \n                        (select max(dtstatdate) from dws_jordass_login_df where vplayerid = a.vplayerid and dtstatdate < a.game_mode_launch_date)\n                    ) between 21 and 59 then '砺刃回流（流失21-59天）'\n                    when datediff(a.game_mode_launch_date, \n                        (select max(dtstatdate) from dws_jordass_login_df where vplayerid = a.vplayerid and dtstatdate < a.game_mode_launch_date)\n                    ) >= 60 then '砺刃回流（流失60天以上）'\n                    else '其他'\n                end\n                \n            -- 平台盘内：上线前一周在平台大盘活跃过，并且没有在砺刃活跃过，并且上线后3天参与了玩法的用户\n            when exists (\n                select 1 from dws_mgamejp_login_user_activity_di \n                where suserid = (select suserid from dim_jordass_playerid2suserid_nf where vplayerid = a.vplayerid)\n                and dtstatdate between date_sub(a.game_mode_launch_date, 6) and date_sub(a.game_mode_launch_date, 1)\n                and sgamecode = 'jordass'\n            ) and not exists (\n                select 1 from dws_jordass_login_df \n                where vplayerid = a.vplayerid \n                and dtstatdate between date_sub(a.game_mode_launch_date, 6) and date_sub(a.game_mode_launch_date, 1)\n            ) then '平台盘内'\n            \n            -- 平台盘外：上线前一周没有在平台大盘内活跃过的，并且上线后3天参与了玩法的用户\n            when not exists (\n                select 1 from dws_mgamejp_login_user_activity_di \n                where suserid = (select suserid from dim_jordass_playerid2suserid_nf where vplayerid = a.vplayerid)\n                and dtstatdate between date_sub(a.game_mode_launch_date, 6) and date_sub(a.game_mode_launch_date, 1)\n                and sgamecode = 'jordass'\n            ) then '平台盘外'\n            \n            else '其他'\n        end as user_type\n    from (\n        select \n            pa.*,\n            case \n                when pa.game_mode = '广域战场' then '20240723'\n                when pa.game_mode = '消灭战' then '20230804'\n                when pa.game_mode = '幻想混战' then '20241115'\n                when pa.game_mode = '荒野传说' then '20240903'\n                when pa.game_mode = '策略载具' then '20241010'\n                when pa.game_mode = '炎夏混战' then '20240625'\n                when pa.game_mode = '单人装备' then '20240517'\n                when pa.game_mode = '交叉堡垒' then '20240412'\n            end as game_mode_launch_date\n        from player_activity pa\n    ) a\n    left join dws_jordass_login_df b on a.vplayerid = b.vplayerid\n)\n\nselect \n    game_mode,\n    user_type,\n    count(distinct vplayerid) as participating_users,\n    (select count(distinct vplayerid) from player_activity where game_mode = ptc.game_mode) as total_users\nfrom player_type_classification ptc\nwhere user_type is not null and user_type != '其他'\ngroup by game_mode, user_type\norder by game_mode, \n    case user_type\n        when '砺刃新增' then 1\n        when '砺刃回流（流失60天以上）' then 2\n        when '砺刃回流（流失21-59天）' then 3\n        when '砺刃回流（流失14-20天）' then 4\n        when '砺刃回流（流失7-13天）' then 5\n        when '砺刃留存' then 6\n        when '平台盘内' then 7\n        when '平台盘外' then 8\n        else 9\n    end;\n",
        "status": "success",
        "result": null
    },
    {
        "sql_id": "sql_39",
        "sql": "\nwith inflow_players as (\n    select \n        case \n            when submodename = '广域战场模式' then '广域战场'\n            when modename='组队竞技' and submodename like '%消灭战模式%' then '消灭战'\n            when modename='创意创作间' and submodename='幻想混战' then '幻想混战'\n            when modename='休闲模式' and submodename in ('荒野传说','荒野沙漠') then '荒野传说'\n            when modename='休闲模式' and submodename like '%策略载具%' then '策略载具'\n            when modename='创意创作间' and submodename like '%炎夏混战%' then '炎夏混战'\n            when modename='组队竞技' and submodename like '%单人装备%' then '单人装备'\n            when modename='组队竞技' and submodename like '%交叉堡垒%' then '交叉堡垒'\n            when submode in (2611) then '庆典混战'\n            when modename='传统模式' and submodename ='CG28-动物丛林' then 'CG28战场进化'\n            when modename='传统模式' and submodename ='CG29-流浪地球' then 'CG29流浪地球'\n        end as inflow_mode,\n        vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where (dtstatdate between '20240723' and date_add('20240723', 3) and submodename = '广域战场模式')\n       or (dtstatdate between '20230804' and date_add('20230804', 3) and modename='组队竞技' and submodename like '%消灭战模式%')\n       or (dtstatdate between '20241115' and date_add('20241115', 3) and modename='创意创作间' and submodename='幻想混战')\n       or (dtstatdate between '20240903' and date_add('20240903', 3) and modename='休闲模式' and submodename in ('荒野传说','荒野沙漠'))\n       or (dtstatdate between '20241010' and date_add('20241010', 3) and modename='休闲模式' and submodename like '%策略载具%')\n       or (dtstatdate between '20240625' and date_add('20240625', 3) and modename='创意创作间' and submodename like '%炎夏混战%')\n       or (dtstatdate between '20240517' and date_add('20240517', 3) and modename='组队竞技' and submodename like '%单人装备%')\n       or (dtstatdate between '20240412' and date_add('20240412', 3) and modename='组队竞技' and submodename like '%交叉堡垒%')\n       or (dtstatdate between '20240426' and date_add('20240426', 3) and submode in (2611))\n       or (dtstatdate between '20240903' and date_add('20240903', 3) and modename='传统模式' and submodename ='CG28-动物丛林')\n       or (dtstatdate between '20241105' and date_add('20241105', 3) and modename='传统模式' and submodename ='CG29-流浪地球')\n    group by \n        case \n            when submodename = '广域战场模式' then '广域战场'\n            when modename='组队竞技' and submodename like '%消灭战模式%' then '消灭战'\n            when modename='创意创作间' and submodename='幻想混战' then '幻想混战'\n            when modename='休闲模式' and submodename in ('荒野传说','荒野沙漠') then '荒野传说'\n            when modename='休闲模式' and submodename like '%策略载具%' then '策略载具'\n            when modename='创意创作间' and submodename like '%炎夏混战%' then '炎夏混战'\n            when modename='组队竞技' and submodename like '%单人装备%' then '单人装备'\n            when modename='组队竞技' and submodename like '%交叉堡垒%' then '交叉堡垒'\n            when submode in (2611) then '庆典混战'\n            when modename='传统模式' and submodename ='CG28-动物丛林' then 'CG28战场进化'\n            when modename='传统模式' and submodename ='CG29-流浪地球' then 'CG29流浪地球'\n        end,\n        vplayerid\n),\n\noutflow_players_before as (\n    select \n        case \n            when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename='休闲模式' then '休闲模式'\n            when modename='乐园' then '乐园'\n            when modename='领地' then '领地'\n            when modename='广阔天地' then '广阔天地'\n            when modename='组队竞技' then '组队竞技'\n            else '其他子模式'\n        end as outflow_mode,\n        vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate between date_sub('20240723', 7) and '20240723'\n       or dtstatdate between date_sub('20230804', 7) and '20230804'\n       or dtstatdate between date_sub('20241115', 7) and '20241115'\n       or dtstatdate between date_sub('20240903', 7) and '20240903'\n       or dtstatdate between date_sub('20241010', 7) and '20241010'\n       or dtstatdate between date_sub('20240625', 7) and '20240625'\n       or dtstatdate between date_sub('20240517', 7) and '20240517'\n       or dtstatdate between date_sub('20240412', 7) and '20240412'\n       or dtstatdate between date_sub('20240426', 7) and '20240426'\n       or dtstatdate between date_sub('20240903', 7) and '20240903'\n       or dtstatdate between date_sub('20241105', 7) and '20241105'\n    group by \n        case \n            when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename='休闲模式' then '休闲模式'\n            when modename='乐园' then '乐园'\n            when modename='领地' then '领地'\n            when modename='广阔天地' then '广阔天地'\n            when modename='组队竞技' then '组队竞技'\n            else '其他子模式'\n        end,\n        vplayerid\n),\n\noutflow_players_after as (\n    select \n        case \n            when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename='休闲模式' then '休闲模式'\n            when modename='乐园' then '乐园'\n            when modename='领地' then '领地'\n            when modename='广阔天地' then '广阔天地'\n            when modename='组队竞技' then '组队竞技'\n            else '其他子模式'\n        end as outflow_mode,\n        vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate between '20240723' and date_add('20240723', 3)\n       or dtstatdate between '20230804' and date_add('20230804', 3)\n       or dtstatdate between '20241115' and date_add('20241115', 3)\n       or dtstatdate between '20240903' and date_add('20240903', 3)\n       or dtstatdate between '20241010' and date_add('20241010', 3)\n       or dtstatdate between '20240625' and date_add('20240625', 3)\n       or dtstatdate between '20240517' and date_add('20240517', 3)\n       or dtstatdate between '20240412' and date_add('20240412', 3)\n       or dtstatdate between '20240426' and date_add('20240426', 3)\n       or dtstatdate between '20240903' and date_add('20240903', 3)\n       or dtstatdate between '20241105' and date_add('20241105', 3)\n    group by \n        case \n            when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename='休闲模式' then '休闲模式'\n            when modename='乐园' then '乐园'\n            when modename='领地' then '领地'\n            when modename='广阔天地' then '广阔天地'\n            when modename='组队竞技' then '组队竞技'\n            else '其他子模式'\n        end,\n        vplayerid\n),\n\ndual_players as (\n    select \n        i.inflow_mode,\n        o.outflow_mode,\n        i.vplayerid\n    from inflow_players i\n    join outflow_players_after o on i.vplayerid = o.vplayerid\n)\n\nselect \n    i.inflow_mode,\n    o.outflow_mode,\n    count(distinct i.vplayerid) as inflow_users,\n    count(distinct case when ob.vplayerid is not null and oa.vplayerid is null then i.vplayerid end) as outflow_users,\n    count(distinct case when ob.vplayerid is not null and oa.vplayerid is not null then i.vplayerid end) as dual_users,\n    count(distinct ob.vplayerid) as total_outflow_before,\n    round(count(distinct case when ob.vplayerid is not null and oa.vplayerid is null then i.vplayerid end) / \n          count(distinct ob.vplayerid), 4) as outflow_ratio,\n    count(distinct oa.vplayerid) as total_outflow_after,\n    round(count(distinct case when ob.vplayerid is not null and oa.vplayerid is not null then i.vplayerid end) / \n          count(distinct oa.vplayerid), 4) as dual_ratio\nfrom inflow_players i\nleft join outflow_players_before ob on ob.vplayerid = i.vplayerid\nleft join outflow_players_after oa on oa.vplayerid = i.vplayerid\ngroup by i.inflow_mode, o.outflow_mode;\n",
        "status": "success",
        "result": null
    },
    {
        "sql_id": "sql_45",
        "sql": "\nselect count(distinct a.vplayerid) as player_count\nfrom (\n    select vplayerid\n    from dws_jordass_matchlog_stat_di\n    where dtstatdate between '20240101' and '20240107'\n    and imode = 1287652322611036928\n    group by vplayerid\n) a\nwhere exists (\n    select 1\n    from dws_jordass_matchlog_stat_di\n    where dtstatdate between '20240115' and '20240121'\n    and imode = 1287652322611036928\n    and vplayerid = a.vplayerid\n)\nand not exists (\n    select 1\n    from dws_jordass_matchlog_stat_di\n    where dtstatdate between '20240108' and '20240114'\n    and imode = 1287652322611036928\n    and vplayerid = a.vplayerid\n)\n",
        "status": "success",
        "result": [
            {
                "player_count": 114
            }
        ]
    },
    {
        "sql_id": "sql_46",
        "sql": "\nwith weekly_active_days as (\n    select \n        weekofyear(dtstatdate) - weekofyear('20240101') + 1 as week_num,\n        vplayerid,\n        count(distinct dtstatdate) as active_days\n    from dws_jordass_login_di\n    where dtstatdate between '20240101' and '20240202'\n    group by weekofyear(dtstatdate) - weekofyear('20240101') + 1, vplayerid\n)\n\nselect \n    week_num as \"统计周\",\n    active_days as \"周活跃天数\",\n    count(distinct vplayerid) as \"玩家数\"\nfrom weekly_active_days\ngroup by week_num, active_days\norder by week_num, active_days;\n",
        "status": "success",
        "result": [
            {
                "统计周": 1,
                "周活跃天数": 1,
                "玩家数": 226
            },
            {
                "统计周": 1,
                "周活跃天数": 2,
                "玩家数": 3
            },
            {
                "统计周": 1,
                "周活跃天数": 3,
                "玩家数": 1
            },
            {
                "统计周": 1,
                "周活跃天数": 4,
                "玩家数": 2
            },
            {
                "统计周": 1,
                "周活跃天数": 5,
                "玩家数": 1
            },
            {
                "统计周": 1,
                "周活跃天数": 6,
                "玩家数": 1
            },
            {
                "统计周": 1,
                "周活跃天数": 7,
                "玩家数": 5
            },
            {
                "统计周": 2,
                "周活跃天数": 1,
                "玩家数": 7
            },
            {
                "统计周": 2,
                "周活跃天数": 2,
                "玩家数": 3
            },
            {
                "统计周": 2,
                "周活跃天数": 3,
                "玩家数": 1
            },
            {
                "统计周": 2,
                "周活跃天数": 4,
                "玩家数": 1
            },
            {
                "统计周": 2,
                "周活跃天数": 5,
                "玩家数": 1
            },
            {
                "统计周": 2,
                "周活跃天数": 6,
                "玩家数": 1
            },
            {
                "统计周": 2,
                "周活跃天数": 7,
                "玩家数": 4
            },
            {
                "统计周": 3,
                "周活跃天数": 1,
                "玩家数": 4
            },
            {
                "统计周": 3,
                "周活跃天数": 2,
                "玩家数": 3
            },
            {
                "统计周": 3,
                "周活跃天数": 3,
                "玩家数": 1
            },
            {
                "统计周": 3,
                "周活跃天数": 4,
                "玩家数": 3
            },
            {
                "统计周": 3,
                "周活跃天数": 5,
                "玩家数": 1
            },
            {
                "统计周": 3,
                "周活跃天数": 6,
                "玩家数": 1
            },
            {
                "统计周": 3,
                "周活跃天数": 7,
                "玩家数": 3
            },
            {
                "统计周": 4,
                "周活跃天数": 1,
                "玩家数": 3
            },
            {
                "统计周": 4,
                "周活跃天数": 2,
                "玩家数": 5
            },
            {
                "统计周": 4,
                "周活跃天数": 3,
                "玩家数": 1
            },
            {
                "统计周": 4,
                "周活跃天数": 4,
                "玩家数": 1
            },
            {
                "统计周": 4,
                "周活跃天数": 5,
                "玩家数": 1
            },
            {
                "统计周": 4,
                "周活跃天数": 6,
                "玩家数": 1
            },
            {
                "统计周": 4,
                "周活跃天数": 7,
                "玩家数": 3
            },
            {
                "统计周": 5,
                "周活跃天数": 1,
                "玩家数": 6
            },
            {
                "统计周": 5,
                "周活跃天数": 2,
                "玩家数": 2
            },
            {
                "统计周": 5,
                "周活跃天数": 3,
                "玩家数": 1
            },
            {
                "统计周": 5,
                "周活跃天数": 4,
                "玩家数": 1
            },
            {
                "统计周": 5,
                "周活跃天数": 5,
                "玩家数": 5
            }
        ]
    },
    {
        "sql_id": "sql_48",
        "sql": "\nselect\n    count(distinct case when datediff(dtstatdate, '20231201') between 1 and 7 then vplayerid end) as back_7d_users,\n    count(distinct case when datediff(dtstatdate, '20231201') between 1 and 30 then vplayerid end) as back_30d_users\nfrom dws_jordass_login_df\nwhere dtstatdate between '20231201' and date_add('20231201', 30)\n  and vplayerid in (\n      select distinct vplayerid\n      from dws_jordass_login_df\n      where dtstatdate < '20231201'\n  );\n",
        "status": "success",
        "result": [
            {
                "back_7d_users": 0,
                "back_30d_users": 0
            }
        ]
    },
    {
        "sql_id": "sql_49",
        "sql": "\nwith valid_modes as (\n    select matchsubmodegroup\n    from dim_jordass_submodeonline_nf\n    where datediff('20241001', onlinedate) >= 7\n      and datediff('20241007', onlinedate) <= 90\n),\n\ndaily_players as (\n    select \n        dtstatdate,\n        vplayerid\n    from dws_jordass_matchlog_stat_di\n    where dtstatdate between '20241001' and '20241007'\n      and imode in (select matchsubmodegroup from valid_modes)\n    group by dtstatdate, vplayerid\n),\n\nnext_day_players as (\n    select \n        a.dtstatdate,\n        a.vplayerid\n    from daily_players a\n    join dws_jordass_matchlog_stat_di b\n      on a.vplayerid = b.vplayerid\n      and b.dtstatdate = date_add(a.dtstatdate, 1)\n      and b.imode in (select matchsubmodegroup from valid_modes)\n    where a.dtstatdate between '20241001' and '20241006'\n    group by a.dtstatdate, a.vplayerid\n)\n\nselect \n    '20241001-20241007' as period,\n    a.dtstatdate as date,\n    count(distinct a.vplayerid) as participants,\n    count(distinct b.vplayerid) as next_day_retained\nfrom daily_players a\nleft join next_day_players b\n  on a.dtstatdate = b.dtstatdate\n  and a.vplayerid = b.vplayerid\ngroup by a.dtstatdate\norder by a.dtstatdate;\n",
        "status": "success",
        "result": null
    },
    {
        "sql_id": "sql_56",
        "sql": "\nwith new_users as (\n    select dregdate, vplayerid\n    from dws_jordass_login_df\n    where dregdate between '20240101' and '20240131'\n    group by dregdate, vplayerid\n),\nuser_payments as (\n    select \n        l.dregdate,\n        l.vplayerid,\n        sum(case when datediff(w.dtstatdate, l.dregdate) <= 1 then w.imoney else 0 end) as ltv1,\n        sum(case when datediff(w.dtstatdate, l.dregdate) <= 3 then w.imoney else 0 end) as ltv3,\n        sum(case when datediff(w.dtstatdate, l.dregdate) <= 7 then w.imoney else 0 end) as ltv7,\n        sum(case when datediff(w.dtstatdate, l.dregdate) <= 14 then w.imoney else 0 end) as ltv14,\n        sum(case when datediff(w.dtstatdate, l.dregdate) <= 30 then w.imoney else 0 end) as ltv30,\n        sum(case when datediff(w.dtstatdate, l.dregdate) <= 60 then w.imoney else 0 end) as ltv60,\n        sum(case when datediff(w.dtstatdate, l.dregdate) <= 90 then w.imoney else 0 end) as ltv90,\n        sum(case when datediff(w.dtstatdate, l.dregdate) <= 180 then w.imoney else 0 end) as ltv180\n    from new_users l\n    left join dws_jordass_water_di w on l.vplayerid = w.vplayerid\n    where w.dtstatdate >= l.dregdate\n    group by l.dregdate, l.vplayerid\n)\nselect \n    dregdate,\n    count(distinct vplayerid) as new_users,\n    sum(ltv1)/count(distinct vplayerid) as ltv1,\n    sum(ltv3)/count(distinct vplayerid) as ltv3,\n    sum(ltv7)/count(distinct vplayerid) as ltv7,\n    sum(ltv14)/count(distinct vplayerid) as ltv14,\n    sum(ltv30)/count(distinct vplayerid) as ltv30,\n    sum(ltv60)/count(distinct vplayerid) as ltv60,\n    sum(ltv90)/count(distinct vplayerid) as ltv90,\n    sum(ltv180)/count(distinct vplayerid) as ltv180\nfrom user_payments\ngroup by dregdate\norder by dregdate;\n",
        "status": "success",
        "result": [
            {
                "dregdate": "20240101",
                "new_users": 31,
                "ltv1": 3954.84,
                "ltv3": 3954.84,
                "ltv7": 11370.97,
                "ltv14": 11429.03,
                "ltv30": 13145.16,
                "ltv60": 18435.48,
                "ltv90": 19906.45,
                "ltv180": 37712.9
            },
            {
                "dregdate": "20240102",
                "new_users": 21,
                "ltv1": 1157.14,
                "ltv3": 1157.14,
                "ltv7": 1157.14,
                "ltv14": 1157.14,
                "ltv30": 1328.57,
                "ltv60": 3647.62,
                "ltv90": 9490.48,
                "ltv180": 22785.71
            },
            {
                "dregdate": "20240103",
                "new_users": 21,
                "ltv1": 457.14,
                "ltv3": 457.14,
                "ltv7": 457.14,
                "ltv14": 457.14,
                "ltv30": 695.24,
                "ltv60": 6580.95,
                "ltv90": 7285.71,
                "ltv180": 17000
            },
            {
                "dregdate": "20240104",
                "new_users": 11,
                "ltv1": 1800,
                "ltv3": 1800,
                "ltv7": 19963.64,
                "ltv14": 20354.55,
                "ltv30": 25463.64,
                "ltv60": 37300,
                "ltv90": 38480,
                "ltv180": 47152.73
            },
            {
                "dregdate": "20240105",
                "new_users": 28,
                "ltv1": 453.57,
                "ltv3": 1007.14,
                "ltv7": 1007.14,
                "ltv14": 1007.14,
                "ltv30": 3278.57,
                "ltv60": 15735.71,
                "ltv90": 42014.29,
                "ltv180": 57735.71
            },
            {
                "dregdate": "20240106",
                "new_users": 24,
                "ltv1": 75,
                "ltv3": 75,
                "ltv7": 87.5,
                "ltv14": 87.5,
                "ltv30": 229.17,
                "ltv60": 8850,
                "ltv90": 10062.5,
                "ltv180": 20983.33
            },
            {
                "dregdate": "20240107",
                "new_users": 28,
                "ltv1": 46.43,
                "ltv3": 46.43,
                "ltv7": 110.71,
                "ltv14": 2085.71,
                "ltv30": 3192.86,
                "ltv60": 8282.14,
                "ltv90": 14564.29,
                "ltv180": 27517.86
            },
            {
                "dregdate": "20240108",
                "new_users": 17,
                "ltv1": 0,
                "ltv3": 0,
                "ltv7": 0,
                "ltv14": 1035.29,
                "ltv30": 1588.24,
                "ltv60": 9076.47,
                "ltv90": 10035.29,
                "ltv180": 14135.29
            },
            {
                "dregdate": "20240109",
                "new_users": 12,
                "ltv1": 0,
                "ltv3": 0,
                "ltv7": 0,
                "ltv14": 2316.67,
                "ltv30": 2850,
                "ltv60": 4200,
                "ltv90": 5750,
                "ltv180": 7275
            },
            {
                "dregdate": "20240110",
                "new_users": 20,
                "ltv1": 90,
                "ltv3": 4430,
                "ltv7": 6775,
                "ltv14": 6775,
                "ltv30": 10125,
                "ltv60": 15800,
                "ltv90": 20720,
                "ltv180": 33995
            },
            {
                "dregdate": "20240111",
                "new_users": 21,
                "ltv1": 561.9,
                "ltv3": 561.9,
                "ltv7": 561.9,
                "ltv14": 566.67,
                "ltv30": 1842.86,
                "ltv60": 3985.71,
                "ltv90": 5457.14,
                "ltv180": 16342.86
            },
            {
                "dregdate": "20240112",
                "new_users": 19,
                "ltv1": 126.32,
                "ltv3": 157.89,
                "ltv7": 157.89,
                "ltv14": 347.37,
                "ltv30": 18405.26,
                "ltv60": 21152.63,
                "ltv90": 21215.79,
                "ltv180": 54547.37
            },
            {
                "dregdate": "20240113",
                "new_users": 28,
                "ltv1": 0,
                "ltv3": 107.14,
                "ltv7": 107.14,
                "ltv14": 1389.29,
                "ltv30": 4771.43,
                "ltv60": 7971.43,
                "ltv90": 9028.57,
                "ltv180": 12753.57
            },
            {
                "dregdate": "20240114",
                "new_users": 23,
                "ltv1": 26.09,
                "ltv3": 26.09,
                "ltv7": 37839.13,
                "ltv14": 37839.13,
                "ltv30": 38678.26,
                "ltv60": 47469.57,
                "ltv90": 52130.43,
                "ltv180": 63452.17
            },
            {
                "dregdate": "20240115",
                "new_users": 19,
                "ltv1": 0,
                "ltv3": 31.58,
                "ltv7": 126.32,
                "ltv14": 1110.53,
                "ltv30": 13205.26,
                "ltv60": 14884.21,
                "ltv90": 16100,
                "ltv180": 30315.79
            },
            {
                "dregdate": "20240116",
                "new_users": 21,
                "ltv1": 700,
                "ltv3": 728.57,
                "ltv7": 728.57,
                "ltv14": 795.24,
                "ltv30": 995.24,
                "ltv60": 6171.43,
                "ltv90": 11766.67,
                "ltv180": 32780.95
            },
            {
                "dregdate": "20240117",
                "new_users": 19,
                "ltv1": 0,
                "ltv3": 0,
                "ltv7": 168.42,
                "ltv14": 326.32,
                "ltv30": 7136.84,
                "ltv60": 12963.16,
                "ltv90": 23278.95,
                "ltv180": 33194.74
            },
            {
                "dregdate": "20240118",
                "new_users": 20,
                "ltv1": 370,
                "ltv3": 2030,
                "ltv7": 2130,
                "ltv14": 2810,
                "ltv30": 6070,
                "ltv60": 8800,
                "ltv90": 9725,
                "ltv180": 20810
            },
            {
                "dregdate": "20240119",
                "new_users": 26,
                "ltv1": 892.31,
                "ltv3": 1153.85,
                "ltv7": 1153.85,
                "ltv14": 1169.23,
                "ltv30": 1950,
                "ltv60": 4496.15,
                "ltv90": 4903.85,
                "ltv180": 12665.38
            },
            {
                "dregdate": "20240120",
                "new_users": 29,
                "ltv1": 0,
                "ltv3": 27.59,
                "ltv7": 172.41,
                "ltv14": 537.93,
                "ltv30": 2962.07,
                "ltv60": 16031.03,
                "ltv90": 17596.55,
                "ltv180": 21720.69
            },
            {
                "dregdate": "20240121",
                "new_users": 13,
                "ltv1": 0,
                "ltv3": 0,
                "ltv7": 7.69,
                "ltv14": 23.08,
                "ltv30": 10123.08,
                "ltv60": 11307.69,
                "ltv90": 16900,
                "ltv180": 50600
            },
            {
                "dregdate": "20240122",
                "new_users": 14,
                "ltv1": 0,
                "ltv3": 0,
                "ltv7": 0,
                "ltv14": 0,
                "ltv30": 1692.86,
                "ltv60": 10578.57,
                "ltv90": 11271.43,
                "ltv180": 21892.86
            },
            {
                "dregdate": "20240123",
                "new_users": 21,
                "ltv1": 4.76,
                "ltv3": 209.52,
                "ltv7": 209.52,
                "ltv14": 209.52,
                "ltv30": 209.52,
                "ltv60": 25180.95,
                "ltv90": 26357.14,
                "ltv180": 38038.1
            },
            {
                "dregdate": "20240124",
                "new_users": 18,
                "ltv1": 366.67,
                "ltv3": 433.33,
                "ltv7": 433.33,
                "ltv14": 605.56,
                "ltv30": 738.89,
                "ltv60": 1777.78,
                "ltv90": 3950,
                "ltv180": 10366.67
            },
            {
                "dregdate": "20240125",
                "new_users": 12,
                "ltv1": 0,
                "ltv3": 0,
                "ltv7": 0,
                "ltv14": 5133.33,
                "ltv30": 5358.33,
                "ltv60": 32698.33,
                "ltv90": 46965,
                "ltv180": 49656.67
            },
            {
                "dregdate": "20240126",
                "new_users": 17,
                "ltv1": 0,
                "ltv3": 0,
                "ltv7": 0,
                "ltv14": 0,
                "ltv30": 535.29,
                "ltv60": 929.41,
                "ltv90": 30417.65,
                "ltv180": 51952.94
            },
            {
                "dregdate": "20240127",
                "new_users": 19,
                "ltv1": 0,
                "ltv3": 0,
                "ltv7": 0,
                "ltv14": 0,
                "ltv30": 21184.21,
                "ltv60": 44215.79,
                "ltv90": 49900,
                "ltv180": 89957.37
            },
            {
                "dregdate": "20240128",
                "new_users": 10,
                "ltv1": 1980,
                "ltv3": 1980,
                "ltv7": 4260,
                "ltv14": 4260,
                "ltv30": 6560,
                "ltv60": 10620,
                "ltv90": 13600,
                "ltv180": 21450
            },
            {
                "dregdate": "20240129",
                "new_users": 20,
                "ltv1": 450,
                "ltv3": 450,
                "ltv7": 450,
                "ltv14": 2485,
                "ltv30": 5300,
                "ltv60": 16120,
                "ltv90": 21205,
                "ltv180": 44574.5
            },
            {
                "dregdate": "20240130",
                "new_users": 21,
                "ltv1": 0,
                "ltv3": 0,
                "ltv7": 0,
                "ltv14": 0,
                "ltv30": 214.29,
                "ltv60": 2176.19,
                "ltv90": 4176.19,
                "ltv180": 10619.05
            },
            {
                "dregdate": "20240131",
                "new_users": 21,
                "ltv1": 0,
                "ltv3": 0,
                "ltv7": 0,
                "ltv14": 1219.05,
                "ltv30": 5871.43,
                "ltv60": 10357.14,
                "ltv90": 12085.71,
                "ltv180": 16538.1
            }
        ]
    },
    {
        "sql_id": "sql_57",
        "sql": "\nselect \n    case when grouping(dt) = 1 then '汇总' else dt end as dt,\n    sum(pv) as pv,\n    count(distinct uid) as uv\nfrom (\n    select \n        substr(dteventtime, 1, 8) as dt,\n        count(*) as pv,\n        uid\n    from dwd_jordass_activitypress_hi\n    where substr(dteventtime, 1, 8) between '20241129' and '20241219'\n      and ireason = 2411291018 \n      and buttontype = 10045 \n      and extarg1 in (117, 115)\n    group by substr(dteventtime, 1, 8), uid\n) t\ngroup by grouping sets ((dt), ())\norder by case when dt = '汇总' then 1 else 0 end, dt;\n",
        "status": "success",
        "result": []
    },
    {
        "sql_id": "sql_59",
        "sql": "\nwith trigger_users as (\n    select \n        vplayerid,\n        strarg1,\n        row_number() over (partition by vplayerid order by dteventtime) as trigger_rank\n    from dwd_jordass_activityrecord_hi\n    where dteventtime between '20250111' and '20250124'\n      and actid = 2411070621 \n      and acttype = 10062\n      and strarg1 <> '0'\n),\n\ntotal_lottery as (\n    select \n        vplayerid,\n        sum(arg1) as total_lottery_count\n    from dwd_jordass_activityrecord_hi\n    where dteventtime between '20250111' and '20250124'\n      and actid = 2411070621 \n      and acttype = 10062\n    group by vplayerid\n)\n\nselect \n    t.trigger_rank as trigger_time,\n    count(distinct t.vplayerid) as user_count,\n    sum(l.total_lottery_count) as total_lottery_count\nfrom trigger_users t\njoin total_lottery l on t.vplayerid = l.vplayerid\ngroup by t.trigger_rank\norder by t.trigger_rank;\n",
        "status": "success",
        "result": []
    }
]