[
    {
        "sql_id": "sql_28",
        "sql": "\nWITH mode_launch_dates AS (\n    SELECT '广域战场' AS mode_name, '20240723' AS launch_date, \n           'modename=''组队竞技'' and submodename=''广域战场模式''' AS filter_condition\n    UNION ALL SELECT '消灭战', '20230804', 'modename=''组队竞技'' and submodename like ''%消灭战模式%'''\n    UNION ALL SELECT '幻想混战', '20241115', 'modename=''创意创作间'' and submodename=''幻想混战'''\n    UNION ALL SELECT '荒野传说', '20240903', 'modename=''休闲模式'' and submodename in (''荒野传说'',''荒野沙漠'')'\n    UNION ALL SELECT '策略载具', '20241010', 'modename=''休闲模式'' and submodename like ''%策略载具%'''\n    UNION ALL SELECT '炎夏混战', '20240625', 'modename=''创意创作间'' and submodename like ''%炎夏混战%'''\n    UNION ALL SELECT '单人装备', '20240517', 'modename=''组队竞技'' and submodename like ''%单人装备%'''\n    UNION ALL SELECT '交叉堡垒', '20240412', 'modename=''组队竞技'' and submodename like ''%交叉堡垒%'''\n),\n\nfirst_play AS (\n    SELECT \n        m.mode_name,\n        r.vplayerid,\n        MIN(r.dtstatdate) AS first_play_date\n    FROM \n        dws_jordass_mode_roundrecord_di r\n    JOIN \n        mode_launch_dates m ON 1=1\n    WHERE \n        r.dtstatdate BETWEEN m.launch_date AND DATE_FORMAT(DATE_ADD(STR_TO_DATE(m.launch_date, '%Y%m%d'), INTERVAL 7 DAY), '%Y%m%d')\n        AND (CASE \n            WHEN m.mode_name = '广域战场' THEN modename='组队竞技' and submodename='广域战场模式'\n            WHEN m.mode_name = '消灭战' THEN modename='组队竞技' and submodename like '%消灭战模式%'\n            WHEN m.mode_name = '幻想混战' THEN modename='创意创作间' and submodename='幻想混战'\n            WHEN m.mode_name = '荒野传说' THEN modename='休闲模式' and submodename in ('荒野传说','荒野沙漠')\n            WHEN m.mode_name = '策略载具' THEN modename='休闲模式' and submodename like '%策略载具%'\n            WHEN m.mode_name = '炎夏混战' THEN modename='创意创作间' and submodename like '%炎夏混战%'\n            WHEN m.mode_name = '单人装备' THEN modename='组队竞技' and submodename like '%单人装备%'\n            WHEN m.mode_name = '交叉堡垒' THEN modename='组队竞技' and submodename like '%交叉堡垒%'\n            ELSE FALSE\n        END)\n    GROUP BY \n        m.mode_name, r.vplayerid\n),\n\nretention_data AS (\n    SELECT \n        f.mode_name,\n        f.first_play_date,\n        DATEDIFF(STR_TO_DATE(r.dtstatdate, '%Y%m%d'), STR_TO_DATE(f.first_play_date, '%Y%m%d')) AS retention_day,\n        r.vplayerid\n    FROM \n        first_play f\n    JOIN \n        dws_jordass_mode_roundrecord_di r ON f.vplayerid = r.vplayerid\n    WHERE \n        r.dtstatdate BETWEEN f.first_play_date AND DATE_FORMAT(DATE_ADD(STR_TO_DATE(f.first_play_date, '%Y%m%d'), INTERVAL 7 DAY), '%Y%m%d')\n        AND (CASE \n            WHEN f.mode_name = '广域战场' THEN modename='组队竞技' and submodename='广域战场模式'\n            WHEN f.mode_name = '消灭战' THEN modename='组队竞技' and submodename like '%消灭战模式%'\n            WHEN f.mode_name = '幻想混战' THEN modename='创意创作间' and submodename='幻想混战'\n            WHEN f.mode_name = '荒野传说' THEN modename='休闲模式' and submodename in ('荒野传说','荒野沙漠')\n            WHEN f.mode_name = '策略载具' THEN modename='休闲模式' and submodename like '%策略载具%'\n            WHEN f.mode_name = '炎夏混战' THEN modename='创意创作间' and submodename like '%炎夏混战%'\n            WHEN f.mode_name = '单人装备' THEN modename='组队竞技' and submodename like '%单人装备%'\n            WHEN f.mode_name = '交叉堡垒' THEN modename='组队竞技' and submodename like '%交叉堡垒%'\n            ELSE FALSE\n        END)\n)\n\nSELECT \n    mode_name AS '玩法',\n    first_play_date AS '上线首周首次玩的日期',\n    retention_day AS '第几天留存',\n    COUNT(DISTINCT vplayerid) AS '玩法留存用户数'\nFROM \n    retention_data\nWHERE \n    retention_day BETWEEN 0 AND 7\nGROUP BY \n    mode_name, first_play_date, retention_day\nORDER BY \n    mode_name, first_play_date, retention_day;\n",
        "status": "success",
        "result": [
            {
                "玩法": "交叉堡垒",
                "上线首周首次玩的日期": "20240412",
                "第几天留存": 0,
                "玩法留存用户数": 100
            },
            {
                "玩法": "交叉堡垒",
                "上线首周首次玩的日期": "20240412",
                "第几天留存": 1,
                "玩法留存用户数": 12
            },
            {
                "玩法": "交叉堡垒",
                "上线首周首次玩的日期": "20240412",
                "第几天留存": 2,
                "玩法留存用户数": 8
            },
            {
                "玩法": "交叉堡垒",
                "上线首周首次玩的日期": "20240412",
                "第几天留存": 3,
                "玩法留存用户数": 1
            },
            {
                "玩法": "交叉堡垒",
                "上线首周首次玩的日期": "20240412",
                "第几天留存": 4,
                "玩法留存用户数": 1
            },
            {
                "玩法": "交叉堡垒",
                "上线首周首次玩的日期": "20240412",
                "第几天留存": 5,
                "玩法留存用户数": 1
            },
            {
                "玩法": "交叉堡垒",
                "上线首周首次玩的日期": "20240412",
                "第几天留存": 6,
                "玩法留存用户数": 1
            },
            {
                "玩法": "交叉堡垒",
                "上线首周首次玩的日期": "20240412",
                "第几天留存": 7,
                "玩法留存用户数": 2
            },
            {
                "玩法": "交叉堡垒",
                "上线首周首次玩的日期": "20240413",
                "第几天留存": 0,
                "玩法留存用户数": 85
            },
            {
                "玩法": "交叉堡垒",
                "上线首周首次玩的日期": "20240413",
                "第几天留存": 1,
                "玩法留存用户数": 6
            },
            {
                "玩法": "交叉堡垒",
                "上线首周首次玩的日期": "20240414",
                "第几天留存": 0,
                "玩法留存用户数": 70
            },
            {
                "玩法": "交叉堡垒",
                "上线首周首次玩的日期": "20240415",
                "第几天留存": 0,
                "玩法留存用户数": 1
            },
            {
                "玩法": "交叉堡垒",
                "上线首周首次玩的日期": "20240416",
                "第几天留存": 0,
                "玩法留存用户数": 1
            },
            {
                "玩法": "交叉堡垒",
                "上线首周首次玩的日期": "20240417",
                "第几天留存": 0,
                "玩法留存用户数": 1
            },
            {
                "玩法": "交叉堡垒",
                "上线首周首次玩的日期": "20240418",
                "第几天留存": 0,
                "玩法留存用户数": 1
            },
            {
                "玩法": "单人装备",
                "上线首周首次玩的日期": "20240517",
                "第几天留存": 0,
                "玩法留存用户数": 88
            },
            {
                "玩法": "单人装备",
                "上线首周首次玩的日期": "20240517",
                "第几天留存": 1,
                "玩法留存用户数": 4
            },
            {
                "玩法": "单人装备",
                "上线首周首次玩的日期": "20240517",
                "第几天留存": 2,
                "玩法留存用户数": 12
            },
            {
                "玩法": "单人装备",
                "上线首周首次玩的日期": "20240517",
                "第几天留存": 3,
                "玩法留存用户数": 1
            },
            {
                "玩法": "单人装备",
                "上线首周首次玩的日期": "20240517",
                "第几天留存": 4,
                "玩法留存用户数": 1
            },
            {
                "玩法": "单人装备",
                "上线首周首次玩的日期": "20240517",
                "第几天留存": 5,
                "玩法留存用户数": 1
            },
            {
                "玩法": "单人装备",
                "上线首周首次玩的日期": "20240517",
                "第几天留存": 6,
                "玩法留存用户数": 1
            },
            {
                "玩法": "单人装备",
                "上线首周首次玩的日期": "20240517",
                "第几天留存": 7,
                "玩法留存用户数": 2
            },
            {
                "玩法": "单人装备",
                "上线首周首次玩的日期": "20240518",
                "第几天留存": 0,
                "玩法留存用户数": 82
            },
            {
                "玩法": "单人装备",
                "上线首周首次玩的日期": "20240518",
                "第几天留存": 1,
                "玩法留存用户数": 6
            },
            {
                "玩法": "单人装备",
                "上线首周首次玩的日期": "20240519",
                "第几天留存": 0,
                "玩法留存用户数": 55
            },
            {
                "玩法": "单人装备",
                "上线首周首次玩的日期": "20240520",
                "第几天留存": 0,
                "玩法留存用户数": 1
            },
            {
                "玩法": "单人装备",
                "上线首周首次玩的日期": "20240521",
                "第几天留存": 0,
                "玩法留存用户数": 1
            },
            {
                "玩法": "单人装备",
                "上线首周首次玩的日期": "20240522",
                "第几天留存": 0,
                "玩法留存用户数": 1
            },
            {
                "玩法": "单人装备",
                "上线首周首次玩的日期": "20240523",
                "第几天留存": 0,
                "玩法留存用户数": 1
            },
            {
                "玩法": "幻想混战",
                "上线首周首次玩的日期": "20241115",
                "第几天留存": 0,
                "玩法留存用户数": 88
            },
            {
                "玩法": "幻想混战",
                "上线首周首次玩的日期": "20241115",
                "第几天留存": 1,
                "玩法留存用户数": 9
            },
            {
                "玩法": "幻想混战",
                "上线首周首次玩的日期": "20241115",
                "第几天留存": 2,
                "玩法留存用户数": 6
            },
            {
                "玩法": "幻想混战",
                "上线首周首次玩的日期": "20241115",
                "第几天留存": 3,
                "玩法留存用户数": 1
            },
            {
                "玩法": "幻想混战",
                "上线首周首次玩的日期": "20241115",
                "第几天留存": 4,
                "玩法留存用户数": 1
            },
            {
                "玩法": "幻想混战",
                "上线首周首次玩的日期": "20241115",
                "第几天留存": 5,
                "玩法留存用户数": 1
            },
            {
                "玩法": "幻想混战",
                "上线首周首次玩的日期": "20241115",
                "第几天留存": 6,
                "玩法留存用户数": 1
            },
            {
                "玩法": "幻想混战",
                "上线首周首次玩的日期": "20241115",
                "第几天留存": 7,
                "玩法留存用户数": 2
            },
            {
                "玩法": "幻想混战",
                "上线首周首次玩的日期": "20241116",
                "第几天留存": 0,
                "玩法留存用户数": 94
            },
            {
                "玩法": "幻想混战",
                "上线首周首次玩的日期": "20241116",
                "第几天留存": 1,
                "玩法留存用户数": 5
            },
            {
                "玩法": "幻想混战",
                "上线首周首次玩的日期": "20241117",
                "第几天留存": 0,
                "玩法留存用户数": 59
            },
            {
                "玩法": "幻想混战",
                "上线首周首次玩的日期": "20241118",
                "第几天留存": 0,
                "玩法留存用户数": 1
            },
            {
                "玩法": "幻想混战",
                "上线首周首次玩的日期": "20241119",
                "第几天留存": 0,
                "玩法留存用户数": 1
            },
            {
                "玩法": "幻想混战",
                "上线首周首次玩的日期": "20241120",
                "第几天留存": 0,
                "玩法留存用户数": 1
            },
            {
                "玩法": "幻想混战",
                "上线首周首次玩的日期": "20241121",
                "第几天留存": 0,
                "玩法留存用户数": 1
            },
            {
                "玩法": "消灭战",
                "上线首周首次玩的日期": "20230804",
                "第几天留存": 0,
                "玩法留存用户数": 117
            },
            {
                "玩法": "消灭战",
                "上线首周首次玩的日期": "20230804",
                "第几天留存": 1,
                "玩法留存用户数": 16
            },
            {
                "玩法": "消灭战",
                "上线首周首次玩的日期": "20230804",
                "第几天留存": 2,
                "玩法留存用户数": 8
            },
            {
                "玩法": "消灭战",
                "上线首周首次玩的日期": "20230804",
                "第几天留存": 7,
                "玩法留存用户数": 1
            },
            {
                "玩法": "消灭战",
                "上线首周首次玩的日期": "20230805",
                "第几天留存": 0,
                "玩法留存用户数": 96
            },
            {
                "玩法": "消灭战",
                "上线首周首次玩的日期": "20230805",
                "第几天留存": 1,
                "玩法留存用户数": 10
            },
            {
                "玩法": "消灭战",
                "上线首周首次玩的日期": "20230805",
                "第几天留存": 2,
                "玩法留存用户数": 1
            },
            {
                "玩法": "消灭战",
                "上线首周首次玩的日期": "20230805",
                "第几天留存": 3,
                "玩法留存用户数": 1
            },
            {
                "玩法": "消灭战",
                "上线首周首次玩的日期": "20230805",
                "第几天留存": 4,
                "玩法留存用户数": 1
            },
            {
                "玩法": "消灭战",
                "上线首周首次玩的日期": "20230805",
                "第几天留存": 5,
                "玩法留存用户数": 1
            },
            {
                "玩法": "消灭战",
                "上线首周首次玩的日期": "20230805",
                "第几天留存": 6,
                "玩法留存用户数": 1
            },
            {
                "玩法": "消灭战",
                "上线首周首次玩的日期": "20230805",
                "第几天留存": 7,
                "玩法留存用户数": 1
            },
            {
                "玩法": "消灭战",
                "上线首周首次玩的日期": "20230806",
                "第几天留存": 0,
                "玩法留存用户数": 88
            },
            {
                "玩法": "消灭战",
                "上线首周首次玩的日期": "20230806",
                "第几天留存": 1,
                "玩法留存用户数": 1
            },
            {
                "玩法": "消灭战",
                "上线首周首次玩的日期": "20230806",
                "第几天留存": 2,
                "玩法留存用户数": 1
            },
            {
                "玩法": "消灭战",
                "上线首周首次玩的日期": "20230806",
                "第几天留存": 3,
                "玩法留存用户数": 1
            },
            {
                "玩法": "消灭战",
                "上线首周首次玩的日期": "20230806",
                "第几天留存": 4,
                "玩法留存用户数": 1
            },
            {
                "玩法": "消灭战",
                "上线首周首次玩的日期": "20230806",
                "第几天留存": 5,
                "玩法留存用户数": 1
            },
            {
                "玩法": "消灭战",
                "上线首周首次玩的日期": "20230806",
                "第几天留存": 6,
                "玩法留存用户数": 1
            },
            {
                "玩法": "消灭战",
                "上线首周首次玩的日期": "20230806",
                "第几天留存": 7,
                "玩法留存用户数": 1
            },
            {
                "玩法": "消灭战",
                "上线首周首次玩的日期": "20230807",
                "第几天留存": 0,
                "玩法留存用户数": 1
            },
            {
                "玩法": "消灭战",
                "上线首周首次玩的日期": "20230807",
                "第几天留存": 1,
                "玩法留存用户数": 1
            },
            {
                "玩法": "消灭战",
                "上线首周首次玩的日期": "20230807",
                "第几天留存": 2,
                "玩法留存用户数": 1
            },
            {
                "玩法": "消灭战",
                "上线首周首次玩的日期": "20230807",
                "第几天留存": 3,
                "玩法留存用户数": 1
            },
            {
                "玩法": "消灭战",
                "上线首周首次玩的日期": "20230807",
                "第几天留存": 4,
                "玩法留存用户数": 1
            },
            {
                "玩法": "消灭战",
                "上线首周首次玩的日期": "20230807",
                "第几天留存": 5,
                "玩法留存用户数": 1
            },
            {
                "玩法": "消灭战",
                "上线首周首次玩的日期": "20230807",
                "第几天留存": 6,
                "玩法留存用户数": 1
            },
            {
                "玩法": "消灭战",
                "上线首周首次玩的日期": "20230807",
                "第几天留存": 7,
                "玩法留存用户数": 1
            },
            {
                "玩法": "消灭战",
                "上线首周首次玩的日期": "20230808",
                "第几天留存": 0,
                "玩法留存用户数": 1
            },
            {
                "玩法": "消灭战",
                "上线首周首次玩的日期": "20230808",
                "第几天留存": 1,
                "玩法留存用户数": 1
            },
            {
                "玩法": "消灭战",
                "上线首周首次玩的日期": "20230808",
                "第几天留存": 2,
                "玩法留存用户数": 1
            },
            {
                "玩法": "消灭战",
                "上线首周首次玩的日期": "20230808",
                "第几天留存": 3,
                "玩法留存用户数": 1
            },
            {
                "玩法": "消灭战",
                "上线首周首次玩的日期": "20230808",
                "第几天留存": 4,
                "玩法留存用户数": 1
            },
            {
                "玩法": "消灭战",
                "上线首周首次玩的日期": "20230808",
                "第几天留存": 5,
                "玩法留存用户数": 1
            },
            {
                "玩法": "消灭战",
                "上线首周首次玩的日期": "20230808",
                "第几天留存": 6,
                "玩法留存用户数": 1
            },
            {
                "玩法": "消灭战",
                "上线首周首次玩的日期": "20230808",
                "第几天留存": 7,
                "玩法留存用户数": 1
            },
            {
                "玩法": "消灭战",
                "上线首周首次玩的日期": "20230809",
                "第几天留存": 0,
                "玩法留存用户数": 1
            },
            {
                "玩法": "消灭战",
                "上线首周首次玩的日期": "20230809",
                "第几天留存": 1,
                "玩法留存用户数": 1
            },
            {
                "玩法": "消灭战",
                "上线首周首次玩的日期": "20230809",
                "第几天留存": 2,
                "玩法留存用户数": 1
            },
            {
                "玩法": "消灭战",
                "上线首周首次玩的日期": "20230809",
                "第几天留存": 3,
                "玩法留存用户数": 1
            },
            {
                "玩法": "消灭战",
                "上线首周首次玩的日期": "20230809",
                "第几天留存": 4,
                "玩法留存用户数": 1
            },
            {
                "玩法": "消灭战",
                "上线首周首次玩的日期": "20230809",
                "第几天留存": 5,
                "玩法留存用户数": 1
            },
            {
                "玩法": "消灭战",
                "上线首周首次玩的日期": "20230809",
                "第几天留存": 6,
                "玩法留存用户数": 1
            },
            {
                "玩法": "消灭战",
                "上线首周首次玩的日期": "20230809",
                "第几天留存": 7,
                "玩法留存用户数": 1
            },
            {
                "玩法": "消灭战",
                "上线首周首次玩的日期": "20230810",
                "第几天留存": 0,
                "玩法留存用户数": 1
            },
            {
                "玩法": "消灭战",
                "上线首周首次玩的日期": "20230810",
                "第几天留存": 1,
                "玩法留存用户数": 1
            },
            {
                "玩法": "消灭战",
                "上线首周首次玩的日期": "20230810",
                "第几天留存": 2,
                "玩法留存用户数": 1
            },
            {
                "玩法": "消灭战",
                "上线首周首次玩的日期": "20230810",
                "第几天留存": 3,
                "玩法留存用户数": 1
            },
            {
                "玩法": "消灭战",
                "上线首周首次玩的日期": "20230810",
                "第几天留存": 4,
                "玩法留存用户数": 1
            },
            {
                "玩法": "消灭战",
                "上线首周首次玩的日期": "20230810",
                "第几天留存": 5,
                "玩法留存用户数": 1
            },
            {
                "玩法": "消灭战",
                "上线首周首次玩的日期": "20230810",
                "第几天留存": 6,
                "玩法留存用户数": 1
            },
            {
                "玩法": "消灭战",
                "上线首周首次玩的日期": "20230810",
                "第几天留存": 7,
                "玩法留存用户数": 1
            },
            {
                "玩法": "炎夏混战",
                "上线首周首次玩的日期": "20240625",
                "第几天留存": 0,
                "玩法留存用户数": 83
            },
            {
                "玩法": "炎夏混战",
                "上线首周首次玩的日期": "20240625",
                "第几天留存": 1,
                "玩法留存用户数": 8
            },
            {
                "玩法": "炎夏混战",
                "上线首周首次玩的日期": "20240625",
                "第几天留存": 2,
                "玩法留存用户数": 6
            },
            {
                "玩法": "炎夏混战",
                "上线首周首次玩的日期": "20240625",
                "第几天留存": 3,
                "玩法留存用户数": 1
            },
            {
                "玩法": "炎夏混战",
                "上线首周首次玩的日期": "20240625",
                "第几天留存": 4,
                "玩法留存用户数": 1
            },
            {
                "玩法": "炎夏混战",
                "上线首周首次玩的日期": "20240625",
                "第几天留存": 5,
                "玩法留存用户数": 1
            },
            {
                "玩法": "炎夏混战",
                "上线首周首次玩的日期": "20240625",
                "第几天留存": 6,
                "玩法留存用户数": 1
            },
            {
                "玩法": "炎夏混战",
                "上线首周首次玩的日期": "20240625",
                "第几天留存": 7,
                "玩法留存用户数": 2
            },
            {
                "玩法": "炎夏混战",
                "上线首周首次玩的日期": "20240626",
                "第几天留存": 0,
                "玩法留存用户数": 67
            },
            {
                "玩法": "炎夏混战",
                "上线首周首次玩的日期": "20240626",
                "第几天留存": 1,
                "玩法留存用户数": 5
            },
            {
                "玩法": "炎夏混战",
                "上线首周首次玩的日期": "20240627",
                "第几天留存": 0,
                "玩法留存用户数": 53
            },
            {
                "玩法": "炎夏混战",
                "上线首周首次玩的日期": "20240628",
                "第几天留存": 0,
                "玩法留存用户数": 1
            },
            {
                "玩法": "炎夏混战",
                "上线首周首次玩的日期": "20240629",
                "第几天留存": 0,
                "玩法留存用户数": 1
            },
            {
                "玩法": "炎夏混战",
                "上线首周首次玩的日期": "20240630",
                "第几天留存": 0,
                "玩法留存用户数": 1
            },
            {
                "玩法": "炎夏混战",
                "上线首周首次玩的日期": "20240701",
                "第几天留存": 0,
                "玩法留存用户数": 1
            },
            {
                "玩法": "策略载具",
                "上线首周首次玩的日期": "20241010",
                "第几天留存": 0,
                "玩法留存用户数": 73
            },
            {
                "玩法": "策略载具",
                "上线首周首次玩的日期": "20241010",
                "第几天留存": 1,
                "玩法留存用户数": 3
            },
            {
                "玩法": "策略载具",
                "上线首周首次玩的日期": "20241010",
                "第几天留存": 2,
                "玩法留存用户数": 4
            },
            {
                "玩法": "策略载具",
                "上线首周首次玩的日期": "20241010",
                "第几天留存": 3,
                "玩法留存用户数": 1
            },
            {
                "玩法": "策略载具",
                "上线首周首次玩的日期": "20241010",
                "第几天留存": 4,
                "玩法留存用户数": 1
            },
            {
                "玩法": "策略载具",
                "上线首周首次玩的日期": "20241010",
                "第几天留存": 5,
                "玩法留存用户数": 1
            },
            {
                "玩法": "策略载具",
                "上线首周首次玩的日期": "20241010",
                "第几天留存": 6,
                "玩法留存用户数": 1
            },
            {
                "玩法": "策略载具",
                "上线首周首次玩的日期": "20241010",
                "第几天留存": 7,
                "玩法留存用户数": 2
            },
            {
                "玩法": "策略载具",
                "上线首周首次玩的日期": "20241011",
                "第几天留存": 0,
                "玩法留存用户数": 52
            },
            {
                "玩法": "策略载具",
                "上线首周首次玩的日期": "20241011",
                "第几天留存": 1,
                "玩法留存用户数": 1
            },
            {
                "玩法": "策略载具",
                "上线首周首次玩的日期": "20241012",
                "第几天留存": 0,
                "玩法留存用户数": 50
            },
            {
                "玩法": "策略载具",
                "上线首周首次玩的日期": "20241013",
                "第几天留存": 0,
                "玩法留存用户数": 1
            },
            {
                "玩法": "策略载具",
                "上线首周首次玩的日期": "20241014",
                "第几天留存": 0,
                "玩法留存用户数": 1
            },
            {
                "玩法": "策略载具",
                "上线首周首次玩的日期": "20241015",
                "第几天留存": 0,
                "玩法留存用户数": 1
            },
            {
                "玩法": "策略载具",
                "上线首周首次玩的日期": "20241016",
                "第几天留存": 0,
                "玩法留存用户数": 1
            },
            {
                "玩法": "荒野传说",
                "上线首周首次玩的日期": "20240903",
                "第几天留存": 0,
                "玩法留存用户数": 90
            },
            {
                "玩法": "荒野传说",
                "上线首周首次玩的日期": "20240903",
                "第几天留存": 1,
                "玩法留存用户数": 5
            },
            {
                "玩法": "荒野传说",
                "上线首周首次玩的日期": "20240903",
                "第几天留存": 2,
                "玩法留存用户数": 8
            },
            {
                "玩法": "荒野传说",
                "上线首周首次玩的日期": "20240903",
                "第几天留存": 3,
                "玩法留存用户数": 1
            },
            {
                "玩法": "荒野传说",
                "上线首周首次玩的日期": "20240903",
                "第几天留存": 4,
                "玩法留存用户数": 1
            },
            {
                "玩法": "荒野传说",
                "上线首周首次玩的日期": "20240903",
                "第几天留存": 5,
                "玩法留存用户数": 1
            },
            {
                "玩法": "荒野传说",
                "上线首周首次玩的日期": "20240903",
                "第几天留存": 6,
                "玩法留存用户数": 1
            },
            {
                "玩法": "荒野传说",
                "上线首周首次玩的日期": "20240903",
                "第几天留存": 7,
                "玩法留存用户数": 2
            },
            {
                "玩法": "荒野传说",
                "上线首周首次玩的日期": "20240904",
                "第几天留存": 0,
                "玩法留存用户数": 74
            },
            {
                "玩法": "荒野传说",
                "上线首周首次玩的日期": "20240904",
                "第几天留存": 1,
                "玩法留存用户数": 4
            },
            {
                "玩法": "荒野传说",
                "上线首周首次玩的日期": "20240905",
                "第几天留存": 0,
                "玩法留存用户数": 60
            },
            {
                "玩法": "荒野传说",
                "上线首周首次玩的日期": "20240906",
                "第几天留存": 0,
                "玩法留存用户数": 1
            },
            {
                "玩法": "荒野传说",
                "上线首周首次玩的日期": "20240907",
                "第几天留存": 0,
                "玩法留存用户数": 1
            },
            {
                "玩法": "荒野传说",
                "上线首周首次玩的日期": "20240908",
                "第几天留存": 0,
                "玩法留存用户数": 1
            },
            {
                "玩法": "荒野传说",
                "上线首周首次玩的日期": "20240909",
                "第几天留存": 0,
                "玩法留存用户数": 1
            }
        ]
    },
    {
        "sql_id": "sql_30",
        "sql": "with combined_data as (\n    -- Data from dws_jordass_mode_roundrecord_di\n    select \n        substr(dtstatdate, 1, 6) as month,\n        vplayerid,\n        case\n            when modename = '传统模式' and submodename like 'CG%' and mapname = '群屿' then '主题群屿'\n            when modename = '传统模式' and mapname = '群屿' then '传统群屿'\n            when modename = '传统模式' and mapname = '假日群岛' then '假日群岛'\n            when modename = '传统模式' and mapname = '荣耀之城' then '荣耀之城'\n            when submodename = '广域战场模式' then '广域战场'\n            when submodename = '极能形态模式' then '极能形态'\n            when modename = '组队竞技' then '组竞'\n            when modename = '休闲模式' then '休闲'\n            when modename = '乐园' then '乐园'\n            when modename = '领地' then '领地'\n            when modename = '广阔天地' then '广阔天地'\n            else '其他模式'\n        end as play_mode,\n        sum(roundtime) as total_time\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate between '20190508' and '20250331'\n    group by substr(dtstatdate, 1, 6), vplayerid,\n        case\n            when modename = '传统模式' and submodename like 'CG%' and mapname = '群屿' then '主题群屿'\n            when modename = '传统模式' and mapname = '群屿' then '传统群屿'\n            when modename = '传统模式' and mapname = '假日群岛' then '假日群岛'\n            when modename = '传统模式' and mapname = '荣耀之城' then '荣耀之城'\n            when submodename = '广域战场模式' then '广域战场'\n            when submodename = '极能形态模式' then '极能形态'\n            when modename = '组队竞技' then '组竞'\n            when modename = '休闲模式' then '休闲'\n            when modename = '乐园' then '乐园'\n            when modename = '领地' then '领地'\n            when modename = '广阔天地' then '广阔天地'\n            else '其他模式'\n        end\n    \n    union all\n    \n    -- Data from dwd_jordass_playerexitgamerecord_hi for tunnel mode\n    select \n        date_format(dteventtime, '%Y%m') as month,\n        vplayerid,\n        '隧道' as play_mode,\n        sum(roundtime) as total_time\n    from dwd_jordass_playerexitgamerecord_hi\n    where dteventtime between '2024-06-18' and '2025-03-30'\n      and mode in (3001, 3002, 3003)\n    group by date_format(dteventtime, '%Y%m'), vplayerid\n),\n\nplayer_main_mode as (\n    select \n        month,\n        vplayerid,\n        play_mode,\n        total_time,\n        row_number() over (partition by month, vplayerid order by total_time desc) as `rank`\n    from combined_data\n),\n\nmain_mode_stats as (\n    select \n        month,\n        play_mode,\n        count(vplayerid) as main_players\n    from player_main_mode\n    where `rank` = 1\n    group by month, play_mode\n),\n\ntotal_players_per_month as (\n    select \n        month,\n        count(distinct vplayerid) as total_players\n    from combined_data\n    group by month\n)\n\nselect \n    m.month,\n    m.play_mode as main_play_mode,\n    m.main_players,\n    t.total_players as total_participation\nfrom main_mode_stats m\njoin total_players_per_month t on m.month = t.month\norder by m.month, m.play_mode",
        "status": "success",
        "result": [
            {
                "month": "201905",
                "main_play_mode": "主题群屿",
                "main_players": 119,
                "total_participation": 134
            },
            {
                "month": "201905",
                "main_play_mode": "乐园",
                "main_players": 2,
                "total_participation": 134
            },
            {
                "month": "201905",
                "main_play_mode": "传统群屿",
                "main_players": 4,
                "total_participation": 134
            },
            {
                "month": "201905",
                "main_play_mode": "假日群岛",
                "main_players": 1,
                "total_participation": 134
            },
            {
                "month": "201905",
                "main_play_mode": "其他模式",
                "main_players": 2,
                "total_participation": 134
            },
            {
                "month": "201905",
                "main_play_mode": "广阔天地",
                "main_players": 2,
                "total_participation": 134
            },
            {
                "month": "201905",
                "main_play_mode": "组竞",
                "main_players": 1,
                "total_participation": 134
            },
            {
                "month": "201905",
                "main_play_mode": "荣耀之城",
                "main_players": 1,
                "total_participation": 134
            },
            {
                "month": "201905",
                "main_play_mode": "领地",
                "main_players": 2,
                "total_participation": 134
            },
            {
                "month": "201906",
                "main_play_mode": "传统群屿",
                "main_players": 1,
                "total_participation": 1
            },
            {
                "month": "201908",
                "main_play_mode": "假日群岛",
                "main_players": 1,
                "total_participation": 1
            },
            {
                "month": "201909",
                "main_play_mode": "荣耀之城",
                "main_players": 1,
                "total_participation": 1
            },
            {
                "month": "201910",
                "main_play_mode": "广域战场",
                "main_players": 1,
                "total_participation": 1
            },
            {
                "month": "201911",
                "main_play_mode": "极能形态",
                "main_players": 1,
                "total_participation": 1
            },
            {
                "month": "201912",
                "main_play_mode": "组竞",
                "main_players": 1,
                "total_participation": 1
            },
            {
                "month": "202001",
                "main_play_mode": "主题群屿",
                "main_players": 1,
                "total_participation": 17
            },
            {
                "month": "202001",
                "main_play_mode": "乐园",
                "main_players": 2,
                "total_participation": 17
            },
            {
                "month": "202001",
                "main_play_mode": "传统群屿",
                "main_players": 3,
                "total_participation": 17
            },
            {
                "month": "202001",
                "main_play_mode": "假日群岛",
                "main_players": 2,
                "total_participation": 17
            },
            {
                "month": "202001",
                "main_play_mode": "其他模式",
                "main_players": 2,
                "total_participation": 17
            },
            {
                "month": "202001",
                "main_play_mode": "广阔天地",
                "main_players": 2,
                "total_participation": 17
            },
            {
                "month": "202001",
                "main_play_mode": "组竞",
                "main_players": 2,
                "total_participation": 17
            },
            {
                "month": "202001",
                "main_play_mode": "荣耀之城",
                "main_players": 1,
                "total_participation": 17
            },
            {
                "month": "202001",
                "main_play_mode": "领地",
                "main_players": 2,
                "total_participation": 17
            },
            {
                "month": "202002",
                "main_play_mode": "领地",
                "main_players": 1,
                "total_participation": 1
            },
            {
                "month": "202004",
                "main_play_mode": "其他模式",
                "main_players": 1,
                "total_participation": 1
            },
            {
                "month": "202006",
                "main_play_mode": "假日群岛",
                "main_players": 1,
                "total_participation": 1
            },
            {
                "month": "202007",
                "main_play_mode": "荣耀之城",
                "main_players": 1,
                "total_participation": 1
            },
            {
                "month": "202008",
                "main_play_mode": "广域战场",
                "main_players": 1,
                "total_participation": 1
            },
            {
                "month": "202009",
                "main_play_mode": "极能形态",
                "main_players": 1,
                "total_participation": 1
            },
            {
                "month": "202010",
                "main_play_mode": "组竞",
                "main_players": 1,
                "total_participation": 1
            },
            {
                "month": "202011",
                "main_play_mode": "乐园",
                "main_players": 1,
                "total_participation": 1
            },
            {
                "month": "202012",
                "main_play_mode": "领地",
                "main_players": 1,
                "total_participation": 1
            },
            {
                "month": "202101",
                "main_play_mode": "广阔天地",
                "main_players": 1,
                "total_participation": 1
            },
            {
                "month": "202102",
                "main_play_mode": "其他模式",
                "main_players": 1,
                "total_participation": 1
            },
            {
                "month": "202103",
                "main_play_mode": "传统群屿",
                "main_players": 1,
                "total_participation": 1
            },
            {
                "month": "202104",
                "main_play_mode": "假日群岛",
                "main_players": 1,
                "total_participation": 1
            },
            {
                "month": "202105",
                "main_play_mode": "荣耀之城",
                "main_players": 1,
                "total_participation": 1
            },
            {
                "month": "202106",
                "main_play_mode": "乐园",
                "main_players": 1,
                "total_participation": 6
            },
            {
                "month": "202106",
                "main_play_mode": "传统群屿",
                "main_players": 1,
                "total_participation": 6
            },
            {
                "month": "202106",
                "main_play_mode": "假日群岛",
                "main_players": 1,
                "total_participation": 6
            },
            {
                "month": "202106",
                "main_play_mode": "其他模式",
                "main_players": 1,
                "total_participation": 6
            },
            {
                "month": "202106",
                "main_play_mode": "广阔天地",
                "main_players": 1,
                "total_participation": 6
            },
            {
                "month": "202106",
                "main_play_mode": "荣耀之城",
                "main_players": 1,
                "total_participation": 6
            },
            {
                "month": "202209",
                "main_play_mode": "极能形态",
                "main_players": 2,
                "total_participation": 2
            },
            {
                "month": "202212",
                "main_play_mode": "主题群屿",
                "main_players": 2,
                "total_participation": 2
            },
            {
                "month": "202301",
                "main_play_mode": "主题群屿",
                "main_players": 29,
                "total_participation": 47
            },
            {
                "month": "202301",
                "main_play_mode": "其他模式",
                "main_players": 12,
                "total_participation": 47
            },
            {
                "month": "202301",
                "main_play_mode": "组竞",
                "main_players": 6,
                "total_participation": 47
            },
            {
                "month": "202304",
                "main_play_mode": "乐园",
                "main_players": 4,
                "total_participation": 4
            },
            {
                "month": "202305",
                "main_play_mode": "乐园",
                "main_players": 5,
                "total_participation": 5
            },
            {
                "month": "202306",
                "main_play_mode": "乐园",
                "main_players": 19,
                "total_participation": 23
            },
            {
                "month": "202306",
                "main_play_mode": "休闲",
                "main_players": 2,
                "total_participation": 23
            },
            {
                "month": "202306",
                "main_play_mode": "传统群屿",
                "main_players": 2,
                "total_participation": 23
            },
            {
                "month": "202307",
                "main_play_mode": "乐园",
                "main_players": 1,
                "total_participation": 37
            },
            {
                "month": "202307",
                "main_play_mode": "休闲",
                "main_players": 2,
                "total_participation": 37
            },
            {
                "month": "202307",
                "main_play_mode": "假日群岛",
                "main_players": 5,
                "total_participation": 37
            },
            {
                "month": "202307",
                "main_play_mode": "其他模式",
                "main_players": 11,
                "total_participation": 37
            },
            {
                "month": "202307",
                "main_play_mode": "广阔天地",
                "main_players": 5,
                "total_participation": 37
            },
            {
                "month": "202307",
                "main_play_mode": "极能形态",
                "main_players": 2,
                "total_participation": 37
            },
            {
                "month": "202307",
                "main_play_mode": "组竞",
                "main_players": 11,
                "total_participation": 37
            },
            {
                "month": "202308",
                "main_play_mode": "乐园",
                "main_players": 3,
                "total_participation": 351
            },
            {
                "month": "202308",
                "main_play_mode": "休闲",
                "main_players": 6,
                "total_participation": 351
            },
            {
                "month": "202308",
                "main_play_mode": "假日群岛",
                "main_players": 7,
                "total_participation": 351
            },
            {
                "month": "202308",
                "main_play_mode": "其他模式",
                "main_players": 9,
                "total_participation": 351
            },
            {
                "month": "202308",
                "main_play_mode": "广阔天地",
                "main_players": 2,
                "total_participation": 351
            },
            {
                "month": "202308",
                "main_play_mode": "极能形态",
                "main_players": 9,
                "total_participation": 351
            },
            {
                "month": "202308",
                "main_play_mode": "组竞",
                "main_players": 315,
                "total_participation": 351
            },
            {
                "month": "202401",
                "main_play_mode": "主题群屿",
                "main_players": 1,
                "total_participation": 2
            },
            {
                "month": "202401",
                "main_play_mode": "其他模式",
                "main_players": 1,
                "total_participation": 2
            },
            {
                "month": "202402",
                "main_play_mode": "主题群屿",
                "main_players": 25,
                "total_participation": 40
            },
            {
                "month": "202402",
                "main_play_mode": "其他模式",
                "main_players": 5,
                "total_participation": 40
            },
            {
                "month": "202402",
                "main_play_mode": "组竞",
                "main_players": 10,
                "total_participation": 40
            },
            {
                "month": "202403",
                "main_play_mode": "主题群屿",
                "main_players": 41,
                "total_participation": 155
            },
            {
                "month": "202403",
                "main_play_mode": "传统群屿",
                "main_players": 22,
                "total_participation": 155
            },
            {
                "month": "202403",
                "main_play_mode": "假日群岛",
                "main_players": 38,
                "total_participation": 155
            },
            {
                "month": "202403",
                "main_play_mode": "其他模式",
                "main_players": 14,
                "total_participation": 155
            },
            {
                "month": "202403",
                "main_play_mode": "极能形态",
                "main_players": 40,
                "total_participation": 155
            },
            {
                "month": "202404",
                "main_play_mode": "主题群屿",
                "main_players": 64,
                "total_participation": 611
            },
            {
                "month": "202404",
                "main_play_mode": "乐园",
                "main_players": 9,
                "total_participation": 611
            },
            {
                "month": "202404",
                "main_play_mode": "休闲",
                "main_players": 2,
                "total_participation": 611
            },
            {
                "month": "202404",
                "main_play_mode": "传统群屿",
                "main_players": 34,
                "total_participation": 611
            },
            {
                "month": "202404",
                "main_play_mode": "假日群岛",
                "main_players": 62,
                "total_participation": 611
            },
            {
                "month": "202404",
                "main_play_mode": "其他模式",
                "main_players": 36,
                "total_participation": 611
            },
            {
                "month": "202404",
                "main_play_mode": "广阔天地",
                "main_players": 2,
                "total_participation": 611
            },
            {
                "month": "202404",
                "main_play_mode": "极能形态",
                "main_players": 87,
                "total_participation": 611
            },
            {
                "month": "202404",
                "main_play_mode": "组竞",
                "main_players": 312,
                "total_participation": 611
            },
            {
                "month": "202404",
                "main_play_mode": "领地",
                "main_players": 3,
                "total_participation": 611
            },
            {
                "month": "202405",
                "main_play_mode": "主题群屿",
                "main_players": 38,
                "total_participation": 411
            },
            {
                "month": "202405",
                "main_play_mode": "乐园",
                "main_players": 2,
                "total_participation": 411
            },
            {
                "month": "202405",
                "main_play_mode": "休闲",
                "main_players": 5,
                "total_participation": 411
            },
            {
                "month": "202405",
                "main_play_mode": "传统群屿",
                "main_players": 16,
                "total_participation": 411
            },
            {
                "month": "202405",
                "main_play_mode": "假日群岛",
                "main_players": 31,
                "total_participation": 411
            },
            {
                "month": "202405",
                "main_play_mode": "其他模式",
                "main_players": 20,
                "total_participation": 411
            },
            {
                "month": "202405",
                "main_play_mode": "极能形态",
                "main_players": 45,
                "total_participation": 411
            },
            {
                "month": "202405",
                "main_play_mode": "组竞",
                "main_players": 251,
                "total_participation": 411
            },
            {
                "month": "202405",
                "main_play_mode": "领地",
                "main_players": 3,
                "total_participation": 411
            },
            {
                "month": "202406",
                "main_play_mode": "主题群屿",
                "main_players": 58,
                "total_participation": 601
            },
            {
                "month": "202406",
                "main_play_mode": "乐园",
                "main_players": 7,
                "total_participation": 601
            },
            {
                "month": "202406",
                "main_play_mode": "传统群屿",
                "main_players": 35,
                "total_participation": 601
            },
            {
                "month": "202406",
                "main_play_mode": "假日群岛",
                "main_players": 46,
                "total_participation": 601
            },
            {
                "month": "202406",
                "main_play_mode": "其他模式",
                "main_players": 264,
                "total_participation": 601
            },
            {
                "month": "202406",
                "main_play_mode": "广阔天地",
                "main_players": 1,
                "total_participation": 601
            },
            {
                "month": "202406",
                "main_play_mode": "极能形态",
                "main_players": 88,
                "total_participation": 601
            },
            {
                "month": "202406",
                "main_play_mode": "组竞",
                "main_players": 22,
                "total_participation": 601
            },
            {
                "month": "202406",
                "main_play_mode": "隧道",
                "main_players": 80,
                "total_participation": 601
            },
            {
                "month": "202407",
                "main_play_mode": "主题群屿",
                "main_players": 3,
                "total_participation": 378
            },
            {
                "month": "202407",
                "main_play_mode": "乐园",
                "main_players": 7,
                "total_participation": 378
            },
            {
                "month": "202407",
                "main_play_mode": "休闲",
                "main_players": 1,
                "total_participation": 378
            },
            {
                "month": "202407",
                "main_play_mode": "传统群屿",
                "main_players": 2,
                "total_participation": 378
            },
            {
                "month": "202407",
                "main_play_mode": "假日群岛",
                "main_players": 8,
                "total_participation": 378
            },
            {
                "month": "202407",
                "main_play_mode": "其他模式",
                "main_players": 35,
                "total_participation": 378
            },
            {
                "month": "202407",
                "main_play_mode": "广域战场",
                "main_players": 289,
                "total_participation": 378
            },
            {
                "month": "202407",
                "main_play_mode": "极能形态",
                "main_players": 9,
                "total_participation": 378
            },
            {
                "month": "202407",
                "main_play_mode": "组竞",
                "main_players": 23,
                "total_participation": 378
            },
            {
                "month": "202407",
                "main_play_mode": "隧道",
                "main_players": 1,
                "total_participation": 378
            },
            {
                "month": "202408",
                "main_play_mode": "乐园",
                "main_players": 5,
                "total_participation": 74
            },
            {
                "month": "202408",
                "main_play_mode": "休闲",
                "main_players": 1,
                "total_participation": 74
            },
            {
                "month": "202408",
                "main_play_mode": "假日群岛",
                "main_players": 4,
                "total_participation": 74
            },
            {
                "month": "202408",
                "main_play_mode": "其他模式",
                "main_players": 32,
                "total_participation": 74
            },
            {
                "month": "202408",
                "main_play_mode": "广域战场",
                "main_players": 7,
                "total_participation": 74
            },
            {
                "month": "202408",
                "main_play_mode": "广阔天地",
                "main_players": 1,
                "total_participation": 74
            },
            {
                "month": "202408",
                "main_play_mode": "极能形态",
                "main_players": 8,
                "total_participation": 74
            },
            {
                "month": "202408",
                "main_play_mode": "组竞",
                "main_players": 14,
                "total_participation": 74
            },
            {
                "month": "202408",
                "main_play_mode": "隧道",
                "main_players": 1,
                "total_participation": 74
            },
            {
                "month": "202408",
                "main_play_mode": "领地",
                "main_players": 1,
                "total_participation": 74
            },
            {
                "month": "202409",
                "main_play_mode": "主题群屿",
                "main_players": 13,
                "total_participation": 309
            },
            {
                "month": "202409",
                "main_play_mode": "乐园",
                "main_players": 3,
                "total_participation": 309
            },
            {
                "month": "202409",
                "main_play_mode": "休闲",
                "main_players": 227,
                "total_participation": 309
            },
            {
                "month": "202409",
                "main_play_mode": "传统群屿",
                "main_players": 2,
                "total_participation": 309
            },
            {
                "month": "202409",
                "main_play_mode": "假日群岛",
                "main_players": 13,
                "total_participation": 309
            },
            {
                "month": "202409",
                "main_play_mode": "其他模式",
                "main_players": 41,
                "total_participation": 309
            },
            {
                "month": "202409",
                "main_play_mode": "极能形态",
                "main_players": 3,
                "total_participation": 309
            },
            {
                "month": "202409",
                "main_play_mode": "组竞",
                "main_players": 7,
                "total_participation": 309
            },
            {
                "month": "202410",
                "main_play_mode": "主题群屿",
                "main_players": 3,
                "total_participation": 243
            },
            {
                "month": "202410",
                "main_play_mode": "乐园",
                "main_players": 6,
                "total_participation": 243
            },
            {
                "month": "202410",
                "main_play_mode": "休闲",
                "main_players": 178,
                "total_participation": 243
            },
            {
                "month": "202410",
                "main_play_mode": "传统群屿",
                "main_players": 1,
                "total_participation": 243
            },
            {
                "month": "202410",
                "main_play_mode": "假日群岛",
                "main_players": 3,
                "total_participation": 243
            },
            {
                "month": "202410",
                "main_play_mode": "其他模式",
                "main_players": 26,
                "total_participation": 243
            },
            {
                "month": "202410",
                "main_play_mode": "广域战场",
                "main_players": 2,
                "total_participation": 243
            },
            {
                "month": "202410",
                "main_play_mode": "广阔天地",
                "main_players": 2,
                "total_participation": 243
            },
            {
                "month": "202410",
                "main_play_mode": "极能形态",
                "main_players": 8,
                "total_participation": 243
            },
            {
                "month": "202410",
                "main_play_mode": "组竞",
                "main_players": 9,
                "total_participation": 243
            },
            {
                "month": "202410",
                "main_play_mode": "隧道",
                "main_players": 1,
                "total_participation": 243
            },
            {
                "month": "202410",
                "main_play_mode": "领地",
                "main_players": 4,
                "total_participation": 243
            },
            {
                "month": "202411",
                "main_play_mode": "主题群屿",
                "main_players": 6,
                "total_participation": 363
            },
            {
                "month": "202411",
                "main_play_mode": "乐园",
                "main_players": 8,
                "total_participation": 363
            },
            {
                "month": "202411",
                "main_play_mode": "传统群屿",
                "main_players": 1,
                "total_participation": 363
            },
            {
                "month": "202411",
                "main_play_mode": "假日群岛",
                "main_players": 8,
                "total_participation": 363
            },
            {
                "month": "202411",
                "main_play_mode": "其他模式",
                "main_players": 315,
                "total_participation": 363
            },
            {
                "month": "202411",
                "main_play_mode": "广域战场",
                "main_players": 4,
                "total_participation": 363
            },
            {
                "month": "202411",
                "main_play_mode": "极能形态",
                "main_players": 3,
                "total_participation": 363
            },
            {
                "month": "202411",
                "main_play_mode": "组竞",
                "main_players": 16,
                "total_participation": 363
            },
            {
                "month": "202411",
                "main_play_mode": "隧道",
                "main_players": 1,
                "total_participation": 363
            },
            {
                "month": "202411",
                "main_play_mode": "领地",
                "main_players": 1,
                "total_participation": 363
            },
            {
                "month": "202412",
                "main_play_mode": "隧道",
                "main_players": 4,
                "total_participation": 4
            },
            {
                "month": "202501",
                "main_play_mode": "主题群屿",
                "main_players": 19,
                "total_participation": 41
            },
            {
                "month": "202501",
                "main_play_mode": "其他模式",
                "main_players": 11,
                "total_participation": 41
            },
            {
                "month": "202501",
                "main_play_mode": "组竞",
                "main_players": 7,
                "total_participation": 41
            },
            {
                "month": "202501",
                "main_play_mode": "隧道",
                "main_players": 4,
                "total_participation": 41
            },
            {
                "month": "202502",
                "main_play_mode": "主题群屿",
                "main_players": 10,
                "total_participation": 42
            },
            {
                "month": "202502",
                "main_play_mode": "乐园",
                "main_players": 2,
                "total_participation": 42
            },
            {
                "month": "202502",
                "main_play_mode": "休闲",
                "main_players": 5,
                "total_participation": 42
            },
            {
                "month": "202502",
                "main_play_mode": "其他模式",
                "main_players": 8,
                "total_participation": 42
            },
            {
                "month": "202502",
                "main_play_mode": "广阔天地",
                "main_players": 4,
                "total_participation": 42
            },
            {
                "month": "202502",
                "main_play_mode": "组竞",
                "main_players": 3,
                "total_participation": 42
            },
            {
                "month": "202502",
                "main_play_mode": "隧道",
                "main_players": 4,
                "total_participation": 42
            },
            {
                "month": "202502",
                "main_play_mode": "领地",
                "main_players": 6,
                "total_participation": 42
            },
            {
                "month": "202503",
                "main_play_mode": "主题群屿",
                "main_players": 26,
                "total_participation": 55
            },
            {
                "month": "202503",
                "main_play_mode": "乐园",
                "main_players": 1,
                "total_participation": 55
            },
            {
                "month": "202503",
                "main_play_mode": "休闲",
                "main_players": 3,
                "total_participation": 55
            },
            {
                "month": "202503",
                "main_play_mode": "传统群屿",
                "main_players": 1,
                "total_participation": 55
            },
            {
                "month": "202503",
                "main_play_mode": "其他模式",
                "main_players": 3,
                "total_participation": 55
            },
            {
                "month": "202503",
                "main_play_mode": "广阔天地",
                "main_players": 3,
                "total_participation": 55
            },
            {
                "month": "202503",
                "main_play_mode": "组竞",
                "main_players": 1,
                "total_participation": 55
            },
            {
                "month": "202503",
                "main_play_mode": "隧道",
                "main_players": 13,
                "total_participation": 55
            },
            {
                "month": "202503",
                "main_play_mode": "领地",
                "main_players": 4,
                "total_participation": 55
            }
        ]
    },
    {
        "sql_id": "sql_33",
        "sql": "\nWITH current_players AS (\n    SELECT DISTINCT vplayerid\n    FROM dws_jordass_playermatchrecord_stat_df\n    WHERE imode = 1344338933661592832\n    AND dtstatdate BETWEEN '20241214' AND '20241220'\n),\nold_players AS (\n    SELECT DISTINCT vplayerid\n    FROM dws_jordass_playermatchrecord_stat_df\n    WHERE imode = 1344338933661592832\n    AND dtstatdate <= '20241213'\n)\nSELECT \n    COUNT(DISTINCT cp.vplayerid) AS total_players,\n    COUNT(DISTINCT op.vplayerid) AS old_players,\n    COUNT(DISTINCT CASE WHEN op.vplayerid IS NULL THEN cp.vplayerid END) AS new_players\nFROM current_players cp\nLEFT JOIN old_players op ON cp.vplayerid = op.vplayerid;\n",
        "status": "success",
        "result": [
            {
                "total_players": 1,
                "old_players": 0,
                "new_players": 1
            }
        ]
    },
    {
        "sql_id": "sql_34",
        "sql": "\nWITH date_ranges AS (\n    SELECT '20240917' AS dt UNION ALL SELECT '20240918' UNION ALL SELECT '20240919' UNION ALL \n    SELECT '20240920' UNION ALL SELECT '20240921' UNION ALL SELECT '20240922' UNION ALL SELECT '20240923' UNION ALL\n    SELECT '20241008' UNION ALL SELECT '20241009' UNION ALL SELECT '20241010' UNION ALL \n    SELECT '20241011' UNION ALL SELECT '20241012' UNION ALL SELECT '20241013' UNION ALL SELECT '20241014'\n),\n\nclick_players AS (\n    SELECT \n        dtstatdate,\n        vplayerid,\n        dteventtime AS click_time\n    FROM dws_jordass_buttonpress_pre_di\n    WHERE dtstatdate IN (SELECT dt FROM date_ranges)\n    AND buttontype = '411111'\n),\n\njoin_players AS (\n    SELECT \n        c.dtstatdate,\n        c.vplayerid,\n        j.dteventtime AS join_time\n    FROM click_players c\n    JOIN dws_jordass_buttonpress_pre_di j ON c.vplayerid = j.vplayerid\n    WHERE j.dtstatdate IN (SELECT dt FROM date_ranges)\n    AND j.buttontype = '411120'\n    AND j.dteventtime > c.click_time\n),\n\nconfirm_players AS (\n    SELECT \n        j.dtstatdate,\n        j.vplayerid,\n        c.dteventtime AS confirm_time\n    FROM join_players j\n    JOIN dws_jordass_buttonpress_pre_di c ON j.vplayerid = c.vplayerid\n    WHERE c.dtstatdate IN (SELECT dt FROM date_ranges)\n    AND c.buttontype = '411123'\n    AND c.dteventtime > j.join_time\n),\n\nvalid_players AS (\n    SELECT DISTINCT\n        dtstatdate,\n        vplayerid\n    FROM confirm_players\n),\n\njoin_counts AS (\n    SELECT \n        v.dtstatdate,\n        v.vplayerid,\n        COUNT(*) AS join_count\n    FROM valid_players v\n    JOIN dws_jordass_buttonpress_pre_di j ON v.vplayerid = j.vplayerid AND v.dtstatdate = j.dtstatdate\n    WHERE j.buttontype = '411120'\n    GROUP BY v.dtstatdate, v.vplayerid\n)\n\nSELECT \n    dtstatdate AS 日期,\n    COUNT(DISTINCT vplayerid) AS 人数,\n    SUM(join_count) AS 人次\nFROM join_counts\nGROUP BY dtstatdate\nORDER BY dtstatdate;\n",
        "status": "success",
        "result": [
            {
                "日期": "20240917",
                "人数": 1,
                "人次": 1
            },
            {
                "日期": "20240918",
                "人数": 5,
                "人次": 7
            },
            {
                "日期": "20240919",
                "人数": 5,
                "人次": 7
            },
            {
                "日期": "20240920",
                "人数": 3,
                "人次": 3
            },
            {
                "日期": "20240921",
                "人数": 1,
                "人次": 1
            },
            {
                "日期": "20240922",
                "人数": 1,
                "人次": 1
            },
            {
                "日期": "20240923",
                "人数": 1,
                "人次": 1
            },
            {
                "日期": "20241008",
                "人数": 1,
                "人次": 1
            },
            {
                "日期": "20241009",
                "人数": 6,
                "人次": 11
            },
            {
                "日期": "20241010",
                "人数": 6,
                "人次": 6
            },
            {
                "日期": "20241014",
                "人数": 1,
                "人次": 1
            }
        ]
    },
    {
        "sql_id": "sql_35",
        "sql": "\nWITH match_types AS (\n    SELECT \n        dtstatdate,\n        vplayerid,\n        CASE \n            WHEN mode IN (401, 402, 403) THEN '第一人称'\n            WHEN mode = 101 THEN '单排'\n            WHEN mode = 102 THEN '双排'\n            WHEN mode IN (103, 603) THEN '四排'\n        END AS match_type,\n        SUM(roundcnt) AS roundcnt,\n        SUM(roundtime) AS roundtime\n    FROM dws_jordass_mode_roundrecord_di\n    WHERE dtstatdate BETWEEN '20240326' AND '20240403'\n       OR dtstatdate BETWEEN '20240528' AND '20240605'\n    GROUP BY dtstatdate, vplayerid, \n        CASE \n            WHEN mode IN (401, 402, 403) THEN '第一人称'\n            WHEN mode = 101 THEN '单排'\n            WHEN mode = 102 THEN '双排'\n            WHEN mode IN (103, 603) THEN '四排'\n        END\n),\n\ndaily_stats AS (\n    SELECT \n        dtstatdate,\n        match_type,\n        COUNT(DISTINCT vplayerid) AS daily_players,\n        SUM(roundcnt) AS daily_rounds,\n        SUM(roundtime) AS daily_roundtime\n    FROM match_types\n    GROUP BY dtstatdate, match_type\n),\n\ngame_login AS (\n    SELECT \n        dtstatdate,\n        vplayerid\n    FROM dws_jordass_login_di\n    WHERE dtstatdate BETWEEN '20240326' AND '20240410'\n       OR dtstatdate BETWEEN '20240528' AND '20240612'\n),\n\ngame_retention AS (\n    SELECT \n        a.dtstatdate,\n        m.match_type,\n        COUNT(DISTINCT CASE WHEN b.vplayerid IS NOT NULL THEN a.vplayerid END) AS game_next_day_retention,\n        COUNT(DISTINCT CASE WHEN c.vplayerid IS NOT NULL THEN a.vplayerid END) AS game_7_day_retention\n    FROM (\n        SELECT dtstatdate, vplayerid \n        FROM game_login \n        WHERE dtstatdate BETWEEN '20240326' AND '20240403'\n           OR dtstatdate BETWEEN '20240528' AND '20240605'\n    ) a\n    JOIN match_types m ON a.vplayerid = m.vplayerid AND a.dtstatdate = m.dtstatdate\n    LEFT JOIN game_login b ON a.vplayerid = b.vplayerid AND b.dtstatdate = DATE_FORMAT(DATE_ADD(STR_TO_DATE(a.dtstatdate, '%Y%m%d'), INTERVAL 1 DAY), '%Y%m%d')\n    LEFT JOIN game_login c ON a.vplayerid = c.vplayerid AND c.dtstatdate = DATE_FORMAT(DATE_ADD(STR_TO_DATE(a.dtstatdate, '%Y%m%d'), INTERVAL 7 DAY), '%Y%m%d')\n    GROUP BY a.dtstatdate, m.match_type\n),\n\nmode_retention AS (\n    SELECT \n        a.dtstatdate,\n        a.match_type,\n        COUNT(DISTINCT CASE WHEN b.vplayerid IS NOT NULL THEN a.vplayerid END) AS mode_next_day_retention,\n        COUNT(DISTINCT CASE WHEN c.vplayerid IS NOT NULL THEN a.vplayerid END) AS mode_7_day_retention\n    FROM match_types a\n    LEFT JOIN match_types b ON a.vplayerid = b.vplayerid \n        AND a.match_type = b.match_type \n        AND b.dtstatdate = DATE_FORMAT(DATE_ADD(STR_TO_DATE(a.dtstatdate, '%Y%m%d'), INTERVAL 1 DAY), '%Y%m%d')\n    LEFT JOIN match_types c ON a.vplayerid = c.vplayerid \n        AND a.match_type = c.match_type \n        AND c.dtstatdate = DATE_FORMAT(DATE_ADD(STR_TO_DATE(a.dtstatdate, '%Y%m%d'), INTERVAL 7 DAY), '%Y%m%d')\n    GROUP BY a.dtstatdate, a.match_type\n)\n\nSELECT \n    d.dtstatdate,\n    d.match_type,\n    d.daily_players,\n    d.daily_rounds,\n    d.daily_roundtime,\n    g.game_next_day_retention,\n    g.game_7_day_retention,\n    m.mode_next_day_retention,\n    m.mode_7_day_retention\nFROM daily_stats d\nLEFT JOIN game_retention g ON d.dtstatdate = g.dtstatdate AND d.match_type = g.match_type\nLEFT JOIN mode_retention m ON d.dtstatdate = m.dtstatdate AND d.match_type = m.match_type\nORDER BY d.dtstatdate, d.match_type;\n",
        "status": "success",
        "result": [
            {
                "dtstatdate": "20240326",
                "match_type": "单排",
                "daily_players": 1,
                "daily_rounds": 2,
                "daily_roundtime": 997,
                "game_next_day_retention": null,
                "game_7_day_retention": null,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240326",
                "match_type": "双排",
                "daily_players": 5,
                "daily_rounds": 19,
                "daily_roundtime": 8711,
                "game_next_day_retention": 1,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 1
            },
            {
                "dtstatdate": "20240326",
                "match_type": "四排",
                "daily_players": 38,
                "daily_rounds": 285,
                "daily_roundtime": 336281,
                "game_next_day_retention": 2,
                "game_7_day_retention": 1,
                "mode_next_day_retention": 1,
                "mode_7_day_retention": 10
            },
            {
                "dtstatdate": "20240326",
                "match_type": "第一人称",
                "daily_players": 1,
                "daily_rounds": 17,
                "daily_roundtime": 8087,
                "game_next_day_retention": null,
                "game_7_day_retention": null,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240327",
                "match_type": "单排",
                "daily_players": 3,
                "daily_rounds": 59,
                "daily_roundtime": 37746,
                "game_next_day_retention": null,
                "game_7_day_retention": null,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240327",
                "match_type": "双排",
                "daily_players": 5,
                "daily_rounds": 26,
                "daily_roundtime": 10401,
                "game_next_day_retention": 1,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240327",
                "match_type": "四排",
                "daily_players": 37,
                "daily_rounds": 262,
                "daily_roundtime": 270292,
                "game_next_day_retention": 1,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 1,
                "mode_7_day_retention": 4
            },
            {
                "dtstatdate": "20240327",
                "match_type": "第一人称",
                "daily_players": 1,
                "daily_rounds": 7,
                "daily_roundtime": 8737,
                "game_next_day_retention": null,
                "game_7_day_retention": null,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240328",
                "match_type": "双排",
                "daily_players": 2,
                "daily_rounds": 2,
                "daily_roundtime": 2427,
                "game_next_day_retention": 2,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240328",
                "match_type": "四排",
                "daily_players": 43,
                "daily_rounds": 352,
                "daily_roundtime": 385959,
                "game_next_day_retention": 8,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 36,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240329",
                "match_type": "双排",
                "daily_players": 2,
                "daily_rounds": 12,
                "daily_roundtime": 6366,
                "game_next_day_retention": null,
                "game_7_day_retention": null,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240329",
                "match_type": "四排",
                "daily_players": 43,
                "daily_rounds": 327,
                "daily_roundtime": 404190,
                "game_next_day_retention": 1,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240329",
                "match_type": "第一人称",
                "daily_players": 1,
                "daily_rounds": 6,
                "daily_roundtime": 2140,
                "game_next_day_retention": null,
                "game_7_day_retention": null,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240330",
                "match_type": "单排",
                "daily_players": 2,
                "daily_rounds": 8,
                "daily_roundtime": 4421,
                "game_next_day_retention": null,
                "game_7_day_retention": null,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240330",
                "match_type": "双排",
                "daily_players": 4,
                "daily_rounds": 13,
                "daily_roundtime": 7994,
                "game_next_day_retention": 0,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240330",
                "match_type": "四排",
                "daily_players": 43,
                "daily_rounds": 383,
                "daily_roundtime": 406666,
                "game_next_day_retention": 1,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 8,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240330",
                "match_type": "第一人称",
                "daily_players": 1,
                "daily_rounds": 1,
                "daily_roundtime": 301,
                "game_next_day_retention": null,
                "game_7_day_retention": null,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240331",
                "match_type": "双排",
                "daily_players": 6,
                "daily_rounds": 34,
                "daily_roundtime": 30560,
                "game_next_day_retention": 0,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 1,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240331",
                "match_type": "四排",
                "daily_players": 38,
                "daily_rounds": 296,
                "daily_roundtime": 376187,
                "game_next_day_retention": 1,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 5,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240331",
                "match_type": "第一人称",
                "daily_players": 3,
                "daily_rounds": 15,
                "daily_roundtime": 9441,
                "game_next_day_retention": 0,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240401",
                "match_type": "单排",
                "daily_players": 1,
                "daily_rounds": 1,
                "daily_roundtime": 730,
                "game_next_day_retention": null,
                "game_7_day_retention": null,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240401",
                "match_type": "双排",
                "daily_players": 2,
                "daily_rounds": 9,
                "daily_roundtime": 11860,
                "game_next_day_retention": null,
                "game_7_day_retention": null,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240401",
                "match_type": "四排",
                "daily_players": 44,
                "daily_rounds": 261,
                "daily_roundtime": 272629,
                "game_next_day_retention": 1,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 5,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240402",
                "match_type": "单排",
                "daily_players": 1,
                "daily_rounds": 1,
                "daily_roundtime": 1288,
                "game_next_day_retention": null,
                "game_7_day_retention": null,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240402",
                "match_type": "双排",
                "daily_players": 7,
                "daily_rounds": 16,
                "daily_roundtime": 12280,
                "game_next_day_retention": 2,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240402",
                "match_type": "四排",
                "daily_players": 42,
                "daily_rounds": 260,
                "daily_roundtime": 322039,
                "game_next_day_retention": 6,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 25,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240403",
                "match_type": "单排",
                "daily_players": 2,
                "daily_rounds": 3,
                "daily_roundtime": 1517,
                "game_next_day_retention": null,
                "game_7_day_retention": null,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240403",
                "match_type": "双排",
                "daily_players": 1,
                "daily_rounds": 2,
                "daily_roundtime": 765,
                "game_next_day_retention": null,
                "game_7_day_retention": null,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240403",
                "match_type": "四排",
                "daily_players": 35,
                "daily_rounds": 170,
                "daily_roundtime": 205470,
                "game_next_day_retention": 6,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240403",
                "match_type": "第一人称",
                "daily_players": 1,
                "daily_rounds": 2,
                "daily_roundtime": 1053,
                "game_next_day_retention": null,
                "game_7_day_retention": null,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240528",
                "match_type": "单排",
                "daily_players": 1,
                "daily_rounds": 1,
                "daily_roundtime": 1883,
                "game_next_day_retention": null,
                "game_7_day_retention": null,
                "mode_next_day_retention": 1,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240528",
                "match_type": "双排",
                "daily_players": 4,
                "daily_rounds": 7,
                "daily_roundtime": 8759,
                "game_next_day_retention": null,
                "game_7_day_retention": null,
                "mode_next_day_retention": 3,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240528",
                "match_type": "四排",
                "daily_players": 42,
                "daily_rounds": 284,
                "daily_roundtime": 351792,
                "game_next_day_retention": 9,
                "game_7_day_retention": 3,
                "mode_next_day_retention": 35,
                "mode_7_day_retention": 5
            },
            {
                "dtstatdate": "20240529",
                "match_type": "单排",
                "daily_players": 2,
                "daily_rounds": 6,
                "daily_roundtime": 4668,
                "game_next_day_retention": null,
                "game_7_day_retention": null,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240529",
                "match_type": "双排",
                "daily_players": 5,
                "daily_rounds": 23,
                "daily_roundtime": 22254,
                "game_next_day_retention": 1,
                "game_7_day_retention": 1,
                "mode_next_day_retention": 2,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240529",
                "match_type": "四排",
                "daily_players": 40,
                "daily_rounds": 339,
                "daily_roundtime": 342914,
                "game_next_day_retention": 3,
                "game_7_day_retention": 4,
                "mode_next_day_retention": 4,
                "mode_7_day_retention": 5
            },
            {
                "dtstatdate": "20240530",
                "match_type": "单排",
                "daily_players": 2,
                "daily_rounds": 3,
                "daily_roundtime": 1515,
                "game_next_day_retention": null,
                "game_7_day_retention": null,
                "mode_next_day_retention": 1,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240530",
                "match_type": "双排",
                "daily_players": 5,
                "daily_rounds": 37,
                "daily_roundtime": 22921,
                "game_next_day_retention": 1,
                "game_7_day_retention": 1,
                "mode_next_day_retention": 2,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240530",
                "match_type": "四排",
                "daily_players": 38,
                "daily_rounds": 242,
                "daily_roundtime": 289732,
                "game_next_day_retention": 5,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 35,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240531",
                "match_type": "单排",
                "daily_players": 2,
                "daily_rounds": 6,
                "daily_roundtime": 3002,
                "game_next_day_retention": null,
                "game_7_day_retention": null,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240531",
                "match_type": "双排",
                "daily_players": 5,
                "daily_rounds": 33,
                "daily_roundtime": 22420,
                "game_next_day_retention": 0,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 1,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240531",
                "match_type": "四排",
                "daily_players": 44,
                "daily_rounds": 328,
                "daily_roundtime": 366291,
                "game_next_day_retention": 0,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 11,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240601",
                "match_type": "双排",
                "daily_players": 8,
                "daily_rounds": 19,
                "daily_roundtime": 11623,
                "game_next_day_retention": 0,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240601",
                "match_type": "四排",
                "daily_players": 47,
                "daily_rounds": 314,
                "daily_roundtime": 413761,
                "game_next_day_retention": 4,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 1,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240602",
                "match_type": "单排",
                "daily_players": 3,
                "daily_rounds": 4,
                "daily_roundtime": 2765,
                "game_next_day_retention": null,
                "game_7_day_retention": null,
                "mode_next_day_retention": 2,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240602",
                "match_type": "双排",
                "daily_players": 2,
                "daily_rounds": 2,
                "daily_roundtime": 439,
                "game_next_day_retention": null,
                "game_7_day_retention": null,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240602",
                "match_type": "四排",
                "daily_players": 46,
                "daily_rounds": 267,
                "daily_roundtime": 327552,
                "game_next_day_retention": 9,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 35,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240603",
                "match_type": "单排",
                "daily_players": 4,
                "daily_rounds": 6,
                "daily_roundtime": 2745,
                "game_next_day_retention": 1,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240603",
                "match_type": "双排",
                "daily_players": 1,
                "daily_rounds": 3,
                "daily_roundtime": 2680,
                "game_next_day_retention": null,
                "game_7_day_retention": null,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240603",
                "match_type": "四排",
                "daily_players": 43,
                "daily_rounds": 183,
                "daily_roundtime": 220353,
                "game_next_day_retention": 4,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 2,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240604",
                "match_type": "单排",
                "daily_players": 1,
                "daily_rounds": 1,
                "daily_roundtime": 562,
                "game_next_day_retention": null,
                "game_7_day_retention": null,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240604",
                "match_type": "双排",
                "daily_players": 2,
                "daily_rounds": 7,
                "daily_roundtime": 3783,
                "game_next_day_retention": null,
                "game_7_day_retention": null,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240604",
                "match_type": "四排",
                "daily_players": 37,
                "daily_rounds": 293,
                "daily_roundtime": 335822,
                "game_next_day_retention": 1,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 7,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240605",
                "match_type": "双排",
                "daily_players": 2,
                "daily_rounds": 13,
                "daily_roundtime": 7579,
                "game_next_day_retention": null,
                "game_7_day_retention": null,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            },
            {
                "dtstatdate": "20240605",
                "match_type": "四排",
                "daily_players": 42,
                "daily_rounds": 247,
                "daily_roundtime": 331124,
                "game_next_day_retention": 3,
                "game_7_day_retention": 0,
                "mode_next_day_retention": 0,
                "mode_7_day_retention": 0
            }
        ]
    },
    {
        "sql_id": "sql_37",
        "sql": "\nWITH new_users AS (\n    SELECT \n        dregdate AS reg_date,\n        vplayerid\n    FROM dws_jordass_emulator_df\n    WHERE dregdate BETWEEN '20250401' AND '20250530'\n),\n\nuser_types AS (\n    SELECT \n        n.reg_date,\n        n.vplayerid,\n        CASE \n            WHEN d.device_type IN (1, 5) THEN '模拟器'\n            WHEN d.device_type = 0 THEN '手机端'\n            ELSE '未知'\n        END AS user_type\n    FROM new_users n\n    LEFT JOIN dws_jordass_device_login_di d ON n.vplayerid = d.vplayerid\n    WHERE d.dtstatdate = n.reg_date\n),\n\nlogin_days AS (\n    SELECT \n        u.reg_date,\n        u.vplayerid,\n        u.user_type,\n        MAX(CASE WHEN l.dtstatdate = DATE_FORMAT(DATE_ADD(STR_TO_DATE(u.reg_date, '%Y%m%d'), INTERVAL 1 DAY), '%Y%m%d') THEN 1 ELSE 0 END) AS day2_retained,\n        MAX(CASE WHEN l.dtstatdate = DATE_FORMAT(DATE_ADD(STR_TO_DATE(u.reg_date, '%Y%m%d'), INTERVAL 2 DAY), '%Y%m%d') THEN 1 ELSE 0 END) AS day3_retained,\n        MAX(CASE WHEN l.dtstatdate = DATE_FORMAT(DATE_ADD(STR_TO_DATE(u.reg_date, '%Y%m%d'), INTERVAL 6 DAY), '%Y%m%d') THEN 1 ELSE 0 END) AS day7_retained,\n        MAX(CASE WHEN l.dtstatdate = DATE_FORMAT(DATE_ADD(STR_TO_DATE(u.reg_date, '%Y%m%d'), INTERVAL 13 DAY), '%Y%m%d') THEN 1 ELSE 0 END) AS day14_retained,\n        MAX(CASE WHEN l.dtstatdate = DATE_FORMAT(DATE_ADD(STR_TO_DATE(u.reg_date, '%Y%m%d'), INTERVAL 29 DAY), '%Y%m%d') THEN 1 ELSE 0 END) AS day30_retained\n    FROM user_types u\n    LEFT JOIN dws_jordass_login_di l ON u.vplayerid = l.vplayerid\n    GROUP BY u.reg_date, u.vplayerid, u.user_type\n)\n\nSELECT \n    reg_date,\n    COUNT(vplayerid) AS user_count,\n    user_type,\n    SUM(day2_retained) AS day2_retained_count,\n    SUM(day3_retained) AS day3_retained_count,\n    SUM(day7_retained) AS day7_retained_count,\n    SUM(day14_retained) AS day14_retained_count,\n    SUM(day30_retained) AS day30_retained_count\nFROM login_days\nGROUP BY reg_date, user_type\nUNION ALL\nSELECT \n    reg_date,\n    COUNT(vplayerid) AS user_count,\n    '游戏内' AS user_type,\n    SUM(day2_retained) AS day2_retained_count,\n    SUM(day3_retained) AS day3_retained_count,\n    SUM(day7_retained) AS day7_retained_count,\n    SUM(day14_retained) AS day14_retained_count,\n    SUM(day30_retained) AS day30_retained_count\nFROM login_days\nGROUP BY reg_date\nORDER BY reg_date, user_type;\n",
        "status": "success",
        "result": [
            {
                "reg_date": "20250401",
                "user_count": 1,
                "user_type": "模拟器",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250401",
                "user_count": 1,
                "user_type": "游戏内",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250403",
                "user_count": 1,
                "user_type": "模拟器",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250403",
                "user_count": 1,
                "user_type": "游戏内",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250406",
                "user_count": 1,
                "user_type": "模拟器",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250406",
                "user_count": 1,
                "user_type": "游戏内",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250409",
                "user_count": 1,
                "user_type": "手机端",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250409",
                "user_count": 2,
                "user_type": "模拟器",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250409",
                "user_count": 3,
                "user_type": "游戏内",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250410",
                "user_count": 1,
                "user_type": "模拟器",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250410",
                "user_count": 1,
                "user_type": "游戏内",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250412",
                "user_count": 1,
                "user_type": "模拟器",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250412",
                "user_count": 1,
                "user_type": "游戏内",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250414",
                "user_count": 1,
                "user_type": "模拟器",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250414",
                "user_count": 1,
                "user_type": "游戏内",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250416",
                "user_count": 1,
                "user_type": "模拟器",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250416",
                "user_count": 1,
                "user_type": "游戏内",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250417",
                "user_count": 1,
                "user_type": "手机端",
                "day2_retained_count": 1,
                "day3_retained_count": 1,
                "day7_retained_count": 1,
                "day14_retained_count": 0,
                "day30_retained_count": 1
            },
            {
                "reg_date": "20250417",
                "user_count": 2,
                "user_type": "模拟器",
                "day2_retained_count": 1,
                "day3_retained_count": 1,
                "day7_retained_count": 1,
                "day14_retained_count": 0,
                "day30_retained_count": 1
            },
            {
                "reg_date": "20250417",
                "user_count": 3,
                "user_type": "游戏内",
                "day2_retained_count": 2,
                "day3_retained_count": 2,
                "day7_retained_count": 2,
                "day14_retained_count": 0,
                "day30_retained_count": 2
            },
            {
                "reg_date": "20250418",
                "user_count": 1,
                "user_type": "模拟器",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250418",
                "user_count": 1,
                "user_type": "游戏内",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250420",
                "user_count": 1,
                "user_type": "模拟器",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250420",
                "user_count": 1,
                "user_type": "游戏内",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250421",
                "user_count": 1,
                "user_type": "手机端",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250421",
                "user_count": 1,
                "user_type": "模拟器",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250421",
                "user_count": 2,
                "user_type": "游戏内",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250422",
                "user_count": 1,
                "user_type": "模拟器",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250422",
                "user_count": 1,
                "user_type": "游戏内",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250423",
                "user_count": 1,
                "user_type": "模拟器",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250423",
                "user_count": 1,
                "user_type": "游戏内",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250424",
                "user_count": 1,
                "user_type": "模拟器",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250424",
                "user_count": 1,
                "user_type": "游戏内",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250426",
                "user_count": 1,
                "user_type": "手机端",
                "day2_retained_count": 1,
                "day3_retained_count": 1,
                "day7_retained_count": 0,
                "day14_retained_count": 1,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250426",
                "user_count": 1,
                "user_type": "模拟器",
                "day2_retained_count": 1,
                "day3_retained_count": 1,
                "day7_retained_count": 0,
                "day14_retained_count": 1,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250426",
                "user_count": 2,
                "user_type": "游戏内",
                "day2_retained_count": 2,
                "day3_retained_count": 2,
                "day7_retained_count": 0,
                "day14_retained_count": 2,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250427",
                "user_count": 1,
                "user_type": "手机端",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250427",
                "user_count": 1,
                "user_type": "模拟器",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250427",
                "user_count": 2,
                "user_type": "游戏内",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250429",
                "user_count": 1,
                "user_type": "模拟器",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250429",
                "user_count": 1,
                "user_type": "游戏内",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250501",
                "user_count": 1,
                "user_type": "模拟器",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250501",
                "user_count": 1,
                "user_type": "游戏内",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250504",
                "user_count": 1,
                "user_type": "手机端",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250504",
                "user_count": 1,
                "user_type": "模拟器",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250504",
                "user_count": 2,
                "user_type": "游戏内",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250505",
                "user_count": 1,
                "user_type": "模拟器",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250505",
                "user_count": 1,
                "user_type": "游戏内",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250506",
                "user_count": 2,
                "user_type": "模拟器",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250506",
                "user_count": 2,
                "user_type": "游戏内",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250508",
                "user_count": 1,
                "user_type": "模拟器",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250508",
                "user_count": 1,
                "user_type": "游戏内",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250510",
                "user_count": 1,
                "user_type": "手机端",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250510",
                "user_count": 2,
                "user_type": "模拟器",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250510",
                "user_count": 3,
                "user_type": "游戏内",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250511",
                "user_count": 1,
                "user_type": "手机端",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250511",
                "user_count": 1,
                "user_type": "模拟器",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250511",
                "user_count": 2,
                "user_type": "游戏内",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250512",
                "user_count": 2,
                "user_type": "模拟器",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250512",
                "user_count": 2,
                "user_type": "游戏内",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250515",
                "user_count": 1,
                "user_type": "模拟器",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250515",
                "user_count": 1,
                "user_type": "游戏内",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250516",
                "user_count": 1,
                "user_type": "手机端",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250516",
                "user_count": 1,
                "user_type": "模拟器",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250516",
                "user_count": 2,
                "user_type": "游戏内",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250517",
                "user_count": 2,
                "user_type": "模拟器",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250517",
                "user_count": 2,
                "user_type": "游戏内",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250519",
                "user_count": 1,
                "user_type": "手机端",
                "day2_retained_count": 1,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250519",
                "user_count": 1,
                "user_type": "模拟器",
                "day2_retained_count": 1,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250519",
                "user_count": 2,
                "user_type": "游戏内",
                "day2_retained_count": 2,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250520",
                "user_count": 2,
                "user_type": "模拟器",
                "day2_retained_count": 0,
                "day3_retained_count": 1,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250520",
                "user_count": 2,
                "user_type": "游戏内",
                "day2_retained_count": 0,
                "day3_retained_count": 1,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250521",
                "user_count": 1,
                "user_type": "手机端",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 1
            },
            {
                "reg_date": "20250521",
                "user_count": 1,
                "user_type": "模拟器",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 1
            },
            {
                "reg_date": "20250521",
                "user_count": 2,
                "user_type": "游戏内",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 2
            },
            {
                "reg_date": "20250523",
                "user_count": 2,
                "user_type": "模拟器",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250523",
                "user_count": 2,
                "user_type": "游戏内",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250524",
                "user_count": 2,
                "user_type": "手机端",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 1,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250524",
                "user_count": 1,
                "user_type": "模拟器",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250524",
                "user_count": 3,
                "user_type": "游戏内",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 1,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250526",
                "user_count": 2,
                "user_type": "模拟器",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250526",
                "user_count": 2,
                "user_type": "游戏内",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250527",
                "user_count": 2,
                "user_type": "手机端",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250527",
                "user_count": 3,
                "user_type": "模拟器",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250527",
                "user_count": 5,
                "user_type": "游戏内",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250528",
                "user_count": 1,
                "user_type": "手机端",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 1,
                "day14_retained_count": 0,
                "day30_retained_count": 1
            },
            {
                "reg_date": "20250528",
                "user_count": 1,
                "user_type": "模拟器",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250528",
                "user_count": 2,
                "user_type": "游戏内",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 1,
                "day14_retained_count": 0,
                "day30_retained_count": 1
            },
            {
                "reg_date": "20250529",
                "user_count": 1,
                "user_type": "手机端",
                "day2_retained_count": 1,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250529",
                "user_count": 1,
                "user_type": "模拟器",
                "day2_retained_count": 1,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250529",
                "user_count": 2,
                "user_type": "游戏内",
                "day2_retained_count": 2,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 0
            },
            {
                "reg_date": "20250530",
                "user_count": 2,
                "user_type": "手机端",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 1
            },
            {
                "reg_date": "20250530",
                "user_count": 2,
                "user_type": "模拟器",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 1
            },
            {
                "reg_date": "20250530",
                "user_count": 4,
                "user_type": "游戏内",
                "day2_retained_count": 0,
                "day3_retained_count": 0,
                "day7_retained_count": 0,
                "day14_retained_count": 0,
                "day30_retained_count": 2
            }
        ]
    },
    {
        "sql_id": "sql_38",
        "sql": "\nWITH game_mode_launch_dates AS (\n    SELECT '广域战场' AS game_mode, '20240723' AS launch_date UNION ALL\n    SELECT '消灭战', '20230804' UNION ALL\n    SELECT '幻想混战', '20241115' UNION ALL\n    SELECT '荒野传说', '20240903' UNION ALL\n    SELECT '策略载具', '20241010' UNION ALL\n    SELECT '炎夏混战', '20240625' UNION ALL\n    SELECT '单人装备', '20240517' UNION ALL\n    SELECT '交叉堡垒', '20240412'\n),\n\nparticipating_users AS (\n    SELECT \n        CASE \n            WHEN m.modename = '组队竞技' AND m.submodename LIKE '%消灭战模式%' THEN '消灭战'\n            WHEN m.modename = '创意创作间' AND m.submodename = '幻想混战' THEN '幻想混战'\n            WHEN m.modename = '休闲模式' AND m.submodename IN ('荒野传说','荒野沙漠') THEN '荒野传说'\n            WHEN m.modename = '休闲模式' AND m.submodename LIKE '%策略载具%' THEN '策略载具'\n            WHEN m.modename = '创意创作间' AND m.submodename LIKE '%炎夏混战%' THEN '炎夏混战'\n            WHEN m.modename = '组队竞技' AND m.submodename LIKE '%单人装备%' THEN '单人装备'\n            WHEN m.modename = '组队竞技' AND m.submodename LIKE '%交叉堡垒%' THEN '交叉堡垒'\n            WHEN m.submodename = '广域战场模式' THEN '广域战场'\n            ELSE '其他'\n        END AS game_mode,\n        m.vplayerid,\n        g.launch_date,\n        m.dtstatdate\n    FROM dws_jordass_mode_roundrecord_di m\n    JOIN game_mode_launch_dates g ON \n        CASE \n            WHEN m.modename = '组队竞技' AND m.submodename LIKE '%消灭战模式%' THEN '消灭战'\n            WHEN m.modename = '创意创作间' AND m.submodename = '幻想混战' THEN '幻想混战'\n            WHEN m.modename = '休闲模式' AND m.submodename IN ('荒野传说','荒野沙漠') THEN '荒野传说'\n            WHEN m.modename = '休闲模式' AND m.submodename LIKE '%策略载具%' THEN '策略载具'\n            WHEN m.modename = '创意创作间' AND m.submodename LIKE '%炎夏混战%' THEN '炎夏混战'\n            WHEN m.modename = '组队竞技' AND m.submodename LIKE '%单人装备%' THEN '单人装备'\n            WHEN m.modename = '组队竞技' AND m.submodename LIKE '%交叉堡垒%' THEN '交叉堡垒'\n            WHEN m.submodename = '广域战场模式' THEN '广域战场'\n            ELSE '其他'\n        END = g.game_mode\n    WHERE m.dtstatdate BETWEEN g.launch_date AND DATE_FORMAT(DATE_ADD(STR_TO_DATE(g.launch_date, '%Y%m%d'), INTERVAL 3 DAY), '%Y%m%d')\n),\n\nuser_activity AS (\n    SELECT \n        p.game_mode,\n        p.vplayerid,\n        p.launch_date,\n        -- Check if user was active in Jordass in the week before launch\n        MAX(CASE WHEN j.dtstatdate BETWEEN DATE_FORMAT(DATE_ADD(STR_TO_DATE(p.launch_date, '%Y%m%d'), INTERVAL -7 DAY), '%Y%m%d') \n                 AND p.launch_date THEN 1 ELSE 0 END) AS jordass_active_week_before,\n        -- Check if user was active in platform in the week before launch\n        MAX(CASE WHEN a.dtstatdate BETWEEN DATE_FORMAT(DATE_ADD(STR_TO_DATE(p.launch_date, '%Y%m%d'), INTERVAL -7 DAY), '%Y%m%d') \n                 AND p.launch_date THEN 1 ELSE 0 END) AS platform_active_week_before,\n        -- Get last active date in Jordass before launch\n        MAX(CASE WHEN j.dtstatdate < p.launch_date THEN j.dtstatdate ELSE NULL END) AS last_jordass_active_date,\n        -- Get registration date\n        MAX(j.dregdate) AS registration_date\n    FROM participating_users p\n    LEFT JOIN dws_jordass_login_df j ON p.vplayerid = j.vplayerid AND j.dtstatdate < p.launch_date\n    LEFT JOIN dim_jordass_playerid2suserid_nf m ON p.vplayerid = m.vplayerid\n    LEFT JOIN dws_mgamejp_login_user_activity_di a ON m.suserid = a.suserid \n        AND a.dtstatdate < p.launch_date\n        AND a.saccounttype = '-100' \n        AND a.sgamecode <> '-100' \n        AND a.splattype = '-100' \n        AND a.splat = '-100'\n    GROUP BY p.game_mode, p.vplayerid, p.launch_date\n),\n\nuser_classification AS (\n    SELECT \n        u.game_mode,\n        u.vplayerid,\n        u.launch_date,\n        CASE\n            -- 砺刃新增: registered within 3 days of playing\n            WHEN u.registration_date >= DATE_FORMAT(DATE_ADD(STR_TO_DATE(u.launch_date, '%Y%m%d'), INTERVAL -3 DAY), '%Y%m%d') \n                 AND u.registration_date <= DATE_FORMAT(DATE_ADD(STR_TO_DATE(u.launch_date, '%Y%m%d'), INTERVAL 3 DAY), '%Y%m%d') \n                 THEN '砺刃新增'\n            -- 砺刃留存: active in Jordass in the week before launch\n            WHEN u.jordass_active_week_before = 1 THEN '砺刃留存'\n            -- 砺刃回流: not active in Jordass in the week before launch but registered before\n            WHEN u.jordass_active_week_before = 0 AND u.last_jordass_active_date IS NOT NULL THEN\n                CASE \n                    WHEN DATEDIFF(STR_TO_DATE(u.launch_date, '%Y%m%d'), STR_TO_DATE(u.last_jordass_active_date, '%Y%m%d')) BETWEEN 7 AND 13 THEN '砺刃回流（流失7-13天）'\n                    WHEN DATEDIFF(STR_TO_DATE(u.launch_date, '%Y%m%d'), STR_TO_DATE(u.last_jordass_active_date, '%Y%m%d')) BETWEEN 14 AND 20 THEN '砺刃回流（流失14-20天）'\n                    WHEN DATEDIFF(STR_TO_DATE(u.launch_date, '%Y%m%d'), STR_TO_DATE(u.last_jordass_active_date, '%Y%m%d')) BETWEEN 21 AND 59 THEN '砺刃回流（流失21-59天）'\n                    WHEN DATEDIFF(STR_TO_DATE(u.launch_date, '%Y%m%d'), STR_TO_DATE(u.last_jordass_active_date, '%Y%m%d')) >= 60 THEN '砺刃回流（流失60天以上）'\n                    ELSE '其他'\n                END\n            -- 平台盘内: active in platform but not in Jordass in the week before launch\n            WHEN u.platform_active_week_before = 1 AND u.jordass_active_week_before = 0 THEN '平台盘内'\n            -- 平台盘外: not active in platform in the week before launch\n            WHEN u.platform_active_week_before = 0 THEN '平台盘外'\n            ELSE '其他'\n        END AS user_type\n    FROM user_activity u\n),\n\ntotal_users_by_mode AS (\n    SELECT \n        game_mode,\n        COUNT(DISTINCT vplayerid) AS total_users\n    FROM participating_users\n    GROUP BY game_mode\n)\n\nSELECT \n    c.game_mode AS 玩法,\n    c.user_type AS 用户类型,\n    COUNT(DISTINCT c.vplayerid) AS 上线后3天参与用户数,\n    t.total_users AS 上线后3天总用户数\nFROM user_classification c\nJOIN total_users_by_mode t ON c.game_mode = t.game_mode\nWHERE c.user_type IN ('砺刃新增', '砺刃回流（流失60天以上）', '砺刃回流（流失21-59天）', \n                     '砺刃回流（流失14-20天）', '砺刃回流（流失7-13天）', '砺刃留存', \n                     '平台盘内', '平台盘外')\nGROUP BY c.game_mode, c.user_type, t.total_users\nORDER BY c.game_mode, \n    CASE c.user_type\n        WHEN '砺刃新增' THEN 1\n        WHEN '砺刃回流（流失60天以上）' THEN 2\n        WHEN '砺刃回流（流失21-59天）' THEN 3\n        WHEN '砺刃回流（流失14-20天）' THEN 4\n        WHEN '砺刃回流（流失7-13天）' THEN 5\n        WHEN '砺刃留存' THEN 6\n        WHEN '平台盘内' THEN 7\n        WHEN '平台盘外' THEN 8\n    END;\n",
        "status": "success",
        "result": [
            {
                "玩法": "交叉堡垒",
                "用户类型": "砺刃回流（流失60天以上）",
                "上线后3天参与用户数": 61,
                "上线后3天总用户数": 256
            },
            {
                "玩法": "交叉堡垒",
                "用户类型": "平台盘内",
                "上线后3天参与用户数": 39,
                "上线后3天总用户数": 256
            },
            {
                "玩法": "交叉堡垒",
                "用户类型": "平台盘外",
                "上线后3天参与用户数": 156,
                "上线后3天总用户数": 256
            },
            {
                "玩法": "单人装备",
                "用户类型": "砺刃回流（流失60天以上）",
                "上线后3天参与用户数": 44,
                "上线后3天总用户数": 226
            },
            {
                "玩法": "单人装备",
                "用户类型": "砺刃回流（流失21-59天）",
                "上线后3天参与用户数": 52,
                "上线后3天总用户数": 226
            },
            {
                "玩法": "单人装备",
                "用户类型": "平台盘内",
                "上线后3天参与用户数": 16,
                "上线后3天总用户数": 226
            },
            {
                "玩法": "单人装备",
                "用户类型": "平台盘外",
                "上线后3天参与用户数": 114,
                "上线后3天总用户数": 226
            },
            {
                "玩法": "幻想混战",
                "用户类型": "砺刃回流（流失60天以上）",
                "上线后3天参与用户数": 138,
                "上线后3天总用户数": 242
            },
            {
                "玩法": "幻想混战",
                "用户类型": "砺刃回流（流失21-59天）",
                "上线后3天参与用户数": 58,
                "上线后3天总用户数": 242
            },
            {
                "玩法": "幻想混战",
                "用户类型": "平台盘内",
                "上线后3天参与用户数": 6,
                "上线后3天总用户数": 242
            },
            {
                "玩法": "幻想混战",
                "用户类型": "平台盘外",
                "上线后3天参与用户数": 40,
                "上线后3天总用户数": 242
            },
            {
                "玩法": "广域战场",
                "用户类型": "砺刃回流（流失60天以上）",
                "上线后3天参与用户数": 129,
                "上线后3天总用户数": 289
            },
            {
                "玩法": "广域战场",
                "用户类型": "砺刃回流（流失21-59天）",
                "上线后3天参与用户数": 63,
                "上线后3天总用户数": 289
            },
            {
                "玩法": "广域战场",
                "用户类型": "平台盘内",
                "上线后3天参与用户数": 17,
                "上线后3天总用户数": 289
            },
            {
                "玩法": "广域战场",
                "用户类型": "平台盘外",
                "上线后3天参与用户数": 80,
                "上线后3天总用户数": 289
            },
            {
                "玩法": "消灭战",
                "用户类型": "平台盘内",
                "上线后3天参与用户数": 53,
                "上线后3天总用户数": 302
            },
            {
                "玩法": "消灭战",
                "用户类型": "平台盘外",
                "上线后3天参与用户数": 249,
                "上线后3天总用户数": 302
            },
            {
                "玩法": "炎夏混战",
                "用户类型": "砺刃回流（流失60天以上）",
                "上线后3天参与用户数": 64,
                "上线后3天总用户数": 204
            },
            {
                "玩法": "炎夏混战",
                "用户类型": "砺刃回流（流失21-59天）",
                "上线后3天参与用户数": 46,
                "上线后3天总用户数": 204
            },
            {
                "玩法": "炎夏混战",
                "用户类型": "平台盘内",
                "上线后3天参与用户数": 19,
                "上线后3天总用户数": 204
            },
            {
                "玩法": "炎夏混战",
                "用户类型": "平台盘外",
                "上线后3天参与用户数": 75,
                "上线后3天总用户数": 204
            },
            {
                "玩法": "策略载具",
                "用户类型": "砺刃回流（流失60天以上）",
                "上线后3天参与用户数": 93,
                "上线后3天总用户数": 176
            },
            {
                "玩法": "策略载具",
                "用户类型": "砺刃回流（流失21-59天）",
                "上线后3天参与用户数": 41,
                "上线后3天总用户数": 176
            },
            {
                "玩法": "策略载具",
                "用户类型": "平台盘内",
                "上线后3天参与用户数": 6,
                "上线后3天总用户数": 176
            },
            {
                "玩法": "策略载具",
                "用户类型": "平台盘外",
                "上线后3天参与用户数": 36,
                "上线后3天总用户数": 176
            },
            {
                "玩法": "荒野传说",
                "用户类型": "砺刃回流（流失60天以上）",
                "上线后3天参与用户数": 106,
                "上线后3天总用户数": 225
            },
            {
                "玩法": "荒野传说",
                "用户类型": "砺刃回流（流失21-59天）",
                "上线后3天参与用户数": 58,
                "上线后3天总用户数": 225
            },
            {
                "玩法": "荒野传说",
                "用户类型": "平台盘内",
                "上线后3天参与用户数": 13,
                "上线后3天总用户数": 225
            },
            {
                "玩法": "荒野传说",
                "用户类型": "平台盘外",
                "上线后3天参与用户数": 48,
                "上线后3天总用户数": 225
            }
        ]
    },
    {
        "sql_id": "sql_39",
        "sql": "WITH inflow_modes AS (\n    SELECT '广域战场' AS inflow_mode, '2024-07-23' AS launch_date, 'submodename= ''广域战场模式''' AS match_rule UNION ALL\n    SELECT '消灭战', '2023-08-04', 'modename=''组队竞技'' and submodename like ''%消灭战模式%''' UNION ALL\n    SELECT '幻想混战', '2024-11-15', 'modename=''创意创作间'' and submodename=''幻想混战''' UNION ALL\n    SELECT '荒野传说', '2024-09-03', 'modename=''休闲模式'' and submodename in (''荒野传说'',''荒野沙漠'')' UNION ALL\n    SELECT '策略载具', '2024-10-10', 'modename=''休闲模式'' and submodename like ''%策略载具%''' UNION ALL\n    SELECT '炎夏混战', '2024-06-25', 'modename=''创意创作间'' and submodename like ''%炎夏混战%''' UNION ALL\n    SELECT '单人装备', '2024-05-17', 'modename=''组队竞技'' and submodename like ''%单人装备%''' UNION ALL\n    SELECT '交叉堡垒', '2024-04-12', 'modename=''组队竞技'' and submodename like ''%交叉堡垒%''' UNION ALL\n    SELECT '庆典混战', '2024-04-26', 'submode in (2611)' UNION ALL\n    SELECT 'CG28战场进化', '2024-09-03', 'modename=''传统模式'' and submodename =''CG28-动物丛林''' UNION ALL\n    SELECT 'CG29流浪地球', '2024-11-05', 'modename=''传统模式'' and submodename =''CG29-流浪地球'''\n),\n\noutflow_mapping AS (\n    SELECT \n        vplayerid,\n        dtstatdate,\n        CASE\n            WHEN modename='传统模式' AND submodename LIKE 'CG%' AND mapname='群屿' THEN '主题群屿'\n            WHEN modename='传统模式' AND mapname='群屿' THEN '传统群屿'\n            WHEN modename='传统模式' AND mapname='假日群岛' THEN '假日群岛'\n            WHEN modename='传统模式' AND mapname='山峦' THEN '山峦'\n            WHEN submodename='极能形态模式' THEN '极能形态模式'\n            WHEN modename='生存模式' THEN '隧道'\n            WHEN submodename='广域战场模式' THEN '广域战场'\n            WHEN modename='休闲模式' THEN '休闲模式'\n            WHEN modename='乐园' THEN '乐园'\n            WHEN modename='领地' THEN '领地'\n            WHEN modename='广阔天地' THEN '广阔天地'\n            WHEN modename='组队竞技' THEN '组队竞技'\n            ELSE '其他子模式'\n        END AS outflow_mode\n    FROM dws_jordass_mode_roundrecord_di\n),\n\npre_launch_users AS (\n    SELECT \n        i.inflow_mode,\n        o.outflow_mode,\n        o.vplayerid\n    FROM inflow_modes i\n    JOIN outflow_mapping o ON o.dtstatdate BETWEEN DATE_FORMAT(DATE_SUB(STR_TO_DATE(i.launch_date, '%Y-%m-%d'), INTERVAL 7 DAY), '%Y%m%d') \n                              AND DATE_FORMAT(DATE_SUB(STR_TO_DATE(i.launch_date, '%Y-%m-%d'), INTERVAL 1 DAY), '%Y%m%d')\n    WHERE o.outflow_mode != '其他子模式'\n    GROUP BY i.inflow_mode, o.outflow_mode, o.vplayerid\n),\n\npost_inflow_users AS (\n    SELECT \n        i.inflow_mode,\n        d.vplayerid\n    FROM inflow_modes i\n    JOIN dws_jordass_mode_roundrecord_di d ON d.dtstatdate BETWEEN DATE_FORMAT(STR_TO_DATE(i.launch_date, '%Y-%m-%d'), '%Y%m%d') \n                              AND DATE_FORMAT(DATE_ADD(STR_TO_DATE(i.launch_date, '%Y-%m-%d'), INTERVAL 3 DAY), '%Y%m%d')\n    WHERE \n        (i.inflow_mode = '广域战场' AND d.submodename = '广域战场模式') OR\n        (i.inflow_mode = '消灭战' AND d.modename = '组队竞技' AND d.submodename LIKE '%消灭战模式%') OR\n        (i.inflow_mode = '幻想混战' AND d.modename = '创意创作间' AND d.submodename = '幻想混战') OR\n        (i.inflow_mode = '荒野传说' AND d.modename = '休闲模式' AND d.submodename IN ('荒野传说','荒野沙漠')) OR\n        (i.inflow_mode = '策略载具' AND d.modename = '休闲模式' AND d.submodename LIKE '%策略载具%') OR\n        (i.inflow_mode = '炎夏混战' AND d.modename = '创意创作间' AND d.submodename LIKE '%炎夏混战%') OR\n        (i.inflow_mode = '单人装备' AND d.modename = '组队竞技' AND d.submodename LIKE '%单人装备%') OR\n        (i.inflow_mode = '交叉堡垒' AND d.modename = '组队竞技' AND d.submodename LIKE '%交叉堡垒%') OR\n        (i.inflow_mode = '庆典混战' AND d.submode = 2611) OR\n        (i.inflow_mode = 'CG28战场进化' AND d.modename = '传统模式' AND d.submodename = 'CG28-动物丛林') OR\n        (i.inflow_mode = 'CG29流浪地球' AND d.modename = '传统模式' AND d.submodename = 'CG29-流浪地球')\n    GROUP BY i.inflow_mode, d.vplayerid\n),\n\npost_outflow_users AS (\n    SELECT \n        i.inflow_mode,\n        o.outflow_mode,\n        o.vplayerid\n    FROM inflow_modes i\n    JOIN outflow_mapping o ON o.dtstatdate BETWEEN DATE_FORMAT(STR_TO_DATE(i.launch_date, '%Y-%m-%d'), '%Y%m%d') \n                              AND DATE_FORMAT(DATE_ADD(STR_TO_DATE(i.launch_date, '%Y-%m-%d'), INTERVAL 3 DAY), '%Y%m%d')\n    WHERE o.outflow_mode != '其他子模式'\n    GROUP BY i.inflow_mode, o.outflow_mode, o.vplayerid\n),\n\nmetrics AS (\n    SELECT \n        i.inflow_mode,\n        p.outflow_mode,\n        COUNT(DISTINCT pi.vplayerid) AS inflow_users_3d,\n        COUNT(DISTINCT CASE WHEN po.vplayerid IS NULL THEN p.vplayerid END) AS outflow_users,\n        COUNT(DISTINCT CASE WHEN po.vplayerid IS NOT NULL THEN p.vplayerid END) AS dual_mode_users,\n        COUNT(DISTINCT p.vplayerid) AS pre_launch_outflow_users,\n        COUNT(DISTINCT po.vplayerid) AS post_launch_outflow_users\n    FROM inflow_modes i\n    JOIN pre_launch_users p ON p.inflow_mode = i.inflow_mode\n    LEFT JOIN post_inflow_users pi ON pi.inflow_mode = i.inflow_mode AND pi.vplayerid = p.vplayerid\n    LEFT JOIN post_outflow_users po ON po.inflow_mode = i.inflow_mode AND po.outflow_mode = p.outflow_mode AND po.vplayerid = p.vplayerid\n    GROUP BY i.inflow_mode, p.outflow_mode\n)\n\nSELECT \n    inflow_mode AS '流入玩法',\n    outflow_mode AS '流出玩法',\n    inflow_users_3d AS '上线后3天流入玩法参与用户数',\n    outflow_users AS '上线后3天流出用户数',\n    dual_mode_users AS '上线后3天双栖用户数',\n    pre_launch_outflow_users AS '上线前一周流出玩法总参与用户数',\n    ROUND(outflow_users / NULLIF(pre_launch_outflow_users, 0), 4) AS '流出占比',\n    post_launch_outflow_users AS '上线后3天流出玩法总参与用户数',\n    ROUND(dual_mode_users / NULLIF(pre_launch_outflow_users, 0), 4) AS '双栖占比'\nFROM metrics\nORDER BY inflow_mode, outflow_mode;",
        "status": "success",
        "result": [
            {
                "流入玩法": "CG28战场进化",
                "流出玩法": "主题群屿",
                "上线后3天流入玩法参与用户数": 1,
                "上线后3天流出用户数": 1,
                "上线后3天双栖用户数": 1,
                "上线前一周流出玩法总参与用户数": 2,
                "流出占比": 0.5,
                "上线后3天流出玩法总参与用户数": 1,
                "双栖占比": 0.5
            },
            {
                "流入玩法": "CG28战场进化",
                "流出玩法": "乐园",
                "上线后3天流入玩法参与用户数": 1,
                "上线后3天流出用户数": 11,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 11,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "CG28战场进化",
                "流出玩法": "休闲模式",
                "上线后3天流入玩法参与用户数": 0,
                "上线后3天流出用户数": 3,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 3,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "CG28战场进化",
                "流出玩法": "假日群岛",
                "上线后3天流入玩法参与用户数": 0,
                "上线后3天流出用户数": 9,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 9,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "CG28战场进化",
                "流出玩法": "广域战场",
                "上线后3天流入玩法参与用户数": 0,
                "上线后3天流出用户数": 8,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 8,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "CG28战场进化",
                "流出玩法": "广阔天地",
                "上线后3天流入玩法参与用户数": 0,
                "上线后3天流出用户数": 3,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 3,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "CG28战场进化",
                "流出玩法": "极能形态模式",
                "上线后3天流入玩法参与用户数": 1,
                "上线后3天流出用户数": 15,
                "上线后3天双栖用户数": 1,
                "上线前一周流出玩法总参与用户数": 16,
                "流出占比": 0.94,
                "上线后3天流出玩法总参与用户数": 1,
                "双栖占比": 0.06
            },
            {
                "流入玩法": "CG28战场进化",
                "流出玩法": "组队竞技",
                "上线后3天流入玩法参与用户数": 2,
                "上线后3天流出用户数": 24,
                "上线后3天双栖用户数": 1,
                "上线前一周流出玩法总参与用户数": 25,
                "流出占比": 0.96,
                "上线后3天流出玩法总参与用户数": 1,
                "双栖占比": 0.04
            },
            {
                "流入玩法": "CG28战场进化",
                "流出玩法": "隧道",
                "上线后3天流入玩法参与用户数": 0,
                "上线后3天流出用户数": 44,
                "上线后3天双栖用户数": 3,
                "上线前一周流出玩法总参与用户数": 47,
                "流出占比": 0.94,
                "上线后3天流出玩法总参与用户数": 3,
                "双栖占比": 0.06
            },
            {
                "流入玩法": "CG28战场进化",
                "流出玩法": "领地",
                "上线后3天流入玩法参与用户数": 1,
                "上线后3天流出用户数": 1,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 1,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "CG29流浪地球",
                "流出玩法": "主题群屿",
                "上线后3天流入玩法参与用户数": 1,
                "上线后3天流出用户数": 2,
                "上线后3天双栖用户数": 1,
                "上线前一周流出玩法总参与用户数": 3,
                "流出占比": 0.67,
                "上线后3天流出玩法总参与用户数": 1,
                "双栖占比": 0.33
            },
            {
                "流入玩法": "CG29流浪地球",
                "流出玩法": "乐园",
                "上线后3天流入玩法参与用户数": 1,
                "上线后3天流出用户数": 8,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 8,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "CG29流浪地球",
                "流出玩法": "传统群屿",
                "上线后3天流入玩法参与用户数": 0,
                "上线后3天流出用户数": 1,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 1,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "CG29流浪地球",
                "流出玩法": "假日群岛",
                "上线后3天流入玩法参与用户数": 1,
                "上线后3天流出用户数": 2,
                "上线后3天双栖用户数": 2,
                "上线前一周流出玩法总参与用户数": 4,
                "流出占比": 0.5,
                "上线后3天流出玩法总参与用户数": 2,
                "双栖占比": 0.5
            },
            {
                "流入玩法": "CG29流浪地球",
                "流出玩法": "广域战场",
                "上线后3天流入玩法参与用户数": 0,
                "上线后3天流出用户数": 3,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 3,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "CG29流浪地球",
                "流出玩法": "广阔天地",
                "上线后3天流入玩法参与用户数": 0,
                "上线后3天流出用户数": 1,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 1,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "CG29流浪地球",
                "流出玩法": "极能形态模式",
                "上线后3天流入玩法参与用户数": 1,
                "上线后3天流出用户数": 3,
                "上线后3天双栖用户数": 2,
                "上线前一周流出玩法总参与用户数": 5,
                "流出占比": 0.6,
                "上线后3天流出玩法总参与用户数": 2,
                "双栖占比": 0.4
            },
            {
                "流入玩法": "CG29流浪地球",
                "流出玩法": "组队竞技",
                "上线后3天流入玩法参与用户数": 1,
                "上线后3天流出用户数": 8,
                "上线后3天双栖用户数": 2,
                "上线前一周流出玩法总参与用户数": 10,
                "流出占比": 0.8,
                "上线后3天流出玩法总参与用户数": 2,
                "双栖占比": 0.2
            },
            {
                "流入玩法": "CG29流浪地球",
                "流出玩法": "隧道",
                "上线后3天流入玩法参与用户数": 3,
                "上线后3天流出用户数": 28,
                "上线后3天双栖用户数": 7,
                "上线前一周流出玩法总参与用户数": 35,
                "流出占比": 0.8,
                "上线后3天流出玩法总参与用户数": 7,
                "双栖占比": 0.2
            },
            {
                "流入玩法": "CG29流浪地球",
                "流出玩法": "领地",
                "上线后3天流入玩法参与用户数": 0,
                "上线后3天流出用户数": 7,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 7,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "交叉堡垒",
                "流出玩法": "主题群屿",
                "上线后3天流入玩法参与用户数": 0,
                "上线后3天流出用户数": 47,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 47,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "交叉堡垒",
                "流出玩法": "乐园",
                "上线后3天流入玩法参与用户数": 0,
                "上线后3天流出用户数": 4,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 4,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "交叉堡垒",
                "流出玩法": "休闲模式",
                "上线后3天流入玩法参与用户数": 0,
                "上线后3天流出用户数": 2,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 2,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "交叉堡垒",
                "流出玩法": "传统群屿",
                "上线后3天流入玩法参与用户数": 0,
                "上线后3天流出用户数": 28,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 28,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "交叉堡垒",
                "流出玩法": "假日群岛",
                "上线后3天流入玩法参与用户数": 1,
                "上线后3天流出用户数": 75,
                "上线后3天双栖用户数": 1,
                "上线前一周流出玩法总参与用户数": 76,
                "流出占比": 0.99,
                "上线后3天流出玩法总参与用户数": 1,
                "双栖占比": 0.01
            },
            {
                "流入玩法": "交叉堡垒",
                "流出玩法": "山峦",
                "上线后3天流入玩法参与用户数": 0,
                "上线后3天流出用户数": 12,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 12,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "交叉堡垒",
                "流出玩法": "极能形态模式",
                "上线后3天流入玩法参与用户数": 1,
                "上线后3天流出用户数": 51,
                "上线后3天双栖用户数": 1,
                "上线前一周流出玩法总参与用户数": 52,
                "流出占比": 0.98,
                "上线后3天流出玩法总参与用户数": 1,
                "双栖占比": 0.02
            },
            {
                "流入玩法": "交叉堡垒",
                "流出玩法": "组队竞技",
                "上线后3天流入玩法参与用户数": 1,
                "上线后3天流出用户数": 36,
                "上线后3天双栖用户数": 1,
                "上线前一周流出玩法总参与用户数": 37,
                "流出占比": 0.97,
                "上线后3天流出玩法总参与用户数": 1,
                "双栖占比": 0.03
            },
            {
                "流入玩法": "交叉堡垒",
                "流出玩法": "领地",
                "上线后3天流入玩法参与用户数": 0,
                "上线后3天流出用户数": 4,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 4,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "单人装备",
                "流出玩法": "主题群屿",
                "上线后3天流入玩法参与用户数": 0,
                "上线后3天流出用户数": 5,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 5,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "单人装备",
                "流出玩法": "乐园",
                "上线后3天流入玩法参与用户数": 1,
                "上线后3天流出用户数": 6,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 6,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "单人装备",
                "流出玩法": "休闲模式",
                "上线后3天流入玩法参与用户数": 0,
                "上线后3天流出用户数": 2,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 2,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "单人装备",
                "流出玩法": "传统群屿",
                "上线后3天流入玩法参与用户数": 0,
                "上线后3天流出用户数": 3,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 3,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "单人装备",
                "流出玩法": "假日群岛",
                "上线后3天流入玩法参与用户数": 0,
                "上线后3天流出用户数": 7,
                "上线后3天双栖用户数": 2,
                "上线前一周流出玩法总参与用户数": 9,
                "流出占比": 0.78,
                "上线后3天流出玩法总参与用户数": 2,
                "双栖占比": 0.22
            },
            {
                "流入玩法": "单人装备",
                "流出玩法": "极能形态模式",
                "上线后3天流入玩法参与用户数": 0,
                "上线后3天流出用户数": 19,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 19,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "单人装备",
                "流出玩法": "组队竞技",
                "上线后3天流入玩法参与用户数": 1,
                "上线后3天流出用户数": 24,
                "上线后3天双栖用户数": 5,
                "上线前一周流出玩法总参与用户数": 29,
                "流出占比": 0.83,
                "上线后3天流出玩法总参与用户数": 5,
                "双栖占比": 0.17
            },
            {
                "流入玩法": "单人装备",
                "流出玩法": "领地",
                "上线后3天流入玩法参与用户数": 0,
                "上线后3天流出用户数": 7,
                "上线后3天双栖用户数": 1,
                "上线前一周流出玩法总参与用户数": 8,
                "流出占比": 0.88,
                "上线后3天流出玩法总参与用户数": 1,
                "双栖占比": 0.12
            },
            {
                "流入玩法": "幻想混战",
                "流出玩法": "主题群屿",
                "上线后3天流入玩法参与用户数": 0,
                "上线后3天流出用户数": 9,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 9,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "幻想混战",
                "流出玩法": "乐园",
                "上线后3天流入玩法参与用户数": 1,
                "上线后3天流出用户数": 8,
                "上线后3天双栖用户数": 1,
                "上线前一周流出玩法总参与用户数": 9,
                "流出占比": 0.89,
                "上线后3天流出玩法总参与用户数": 1,
                "双栖占比": 0.11
            },
            {
                "流入玩法": "幻想混战",
                "流出玩法": "传统群屿",
                "上线后3天流入玩法参与用户数": 0,
                "上线后3天流出用户数": 1,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 1,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "幻想混战",
                "流出玩法": "假日群岛",
                "上线后3天流入玩法参与用户数": 0,
                "上线后3天流出用户数": 7,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 7,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "幻想混战",
                "流出玩法": "广域战场",
                "上线后3天流入玩法参与用户数": 0,
                "上线后3天流出用户数": 2,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 2,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "幻想混战",
                "流出玩法": "极能形态模式",
                "上线后3天流入玩法参与用户数": 0,
                "上线后3天流出用户数": 3,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 3,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "幻想混战",
                "流出玩法": "组队竞技",
                "上线后3天流入玩法参与用户数": 1,
                "上线后3天流出用户数": 11,
                "上线后3天双栖用户数": 1,
                "上线前一周流出玩法总参与用户数": 12,
                "流出占比": 0.92,
                "上线后3天流出玩法总参与用户数": 1,
                "双栖占比": 0.08
            },
            {
                "流入玩法": "幻想混战",
                "流出玩法": "隧道",
                "上线后3天流入玩法参与用户数": 1,
                "上线后3天流出用户数": 28,
                "上线后3天双栖用户数": 10,
                "上线前一周流出玩法总参与用户数": 38,
                "流出占比": 0.74,
                "上线后3天流出玩法总参与用户数": 10,
                "双栖占比": 0.26
            },
            {
                "流入玩法": "幻想混战",
                "流出玩法": "领地",
                "上线后3天流入玩法参与用户数": 0,
                "上线后3天流出用户数": 1,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 1,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "广域战场",
                "流出玩法": "主题群屿",
                "上线后3天流入玩法参与用户数": 2,
                "上线后3天流出用户数": 6,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 6,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "广域战场",
                "流出玩法": "乐园",
                "上线后3天流入玩法参与用户数": 2,
                "上线后3天流出用户数": 11,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 11,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "广域战场",
                "流出玩法": "休闲模式",
                "上线后3天流入玩法参与用户数": 0,
                "上线后3天流出用户数": 2,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 2,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "广域战场",
                "流出玩法": "假日群岛",
                "上线后3天流入玩法参与用户数": 1,
                "上线后3天流出用户数": 8,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 8,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "广域战场",
                "流出玩法": "极能形态模式",
                "上线后3天流入玩法参与用户数": 1,
                "上线后3天流出用户数": 13,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 13,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "广域战场",
                "流出玩法": "组队竞技",
                "上线后3天流入玩法参与用户数": 3,
                "上线后3天流出用户数": 24,
                "上线后3天双栖用户数": 2,
                "上线前一周流出玩法总参与用户数": 26,
                "流出占比": 0.92,
                "上线后3天流出玩法总参与用户数": 2,
                "双栖占比": 0.08
            },
            {
                "流入玩法": "广域战场",
                "流出玩法": "隧道",
                "上线后3天流入玩法参与用户数": 2,
                "上线后3天流出用户数": 24,
                "上线后3天双栖用户数": 3,
                "上线前一周流出玩法总参与用户数": 27,
                "流出占比": 0.89,
                "上线后3天流出玩法总参与用户数": 3,
                "双栖占比": 0.11
            },
            {
                "流入玩法": "广域战场",
                "流出玩法": "领地",
                "上线后3天流入玩法参与用户数": 0,
                "上线后3天流出用户数": 1,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 1,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "庆典混战",
                "流出玩法": "主题群屿",
                "上线后3天流入玩法参与用户数": 0,
                "上线后3天流出用户数": 7,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 7,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "庆典混战",
                "流出玩法": "乐园",
                "上线后3天流入玩法参与用户数": 1,
                "上线后3天流出用户数": 9,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 9,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "庆典混战",
                "流出玩法": "休闲模式",
                "上线后3天流入玩法参与用户数": 0,
                "上线后3天流出用户数": 1,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 1,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "庆典混战",
                "流出玩法": "传统群屿",
                "上线后3天流入玩法参与用户数": 1,
                "上线后3天流出用户数": 0,
                "上线后3天双栖用户数": 1,
                "上线前一周流出玩法总参与用户数": 1,
                "流出占比": 0,
                "上线后3天流出玩法总参与用户数": 1,
                "双栖占比": 1
            },
            {
                "流入玩法": "庆典混战",
                "流出玩法": "假日群岛",
                "上线后3天流入玩法参与用户数": 2,
                "上线后3天流出用户数": 8,
                "上线后3天双栖用户数": 2,
                "上线前一周流出玩法总参与用户数": 10,
                "流出占比": 0.8,
                "上线后3天流出玩法总参与用户数": 2,
                "双栖占比": 0.2
            },
            {
                "流入玩法": "庆典混战",
                "流出玩法": "山峦",
                "上线后3天流入玩法参与用户数": 0,
                "上线后3天流出用户数": 1,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 1,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "庆典混战",
                "流出玩法": "广阔天地",
                "上线后3天流入玩法参与用户数": 0,
                "上线后3天流出用户数": 1,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 1,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "庆典混战",
                "流出玩法": "极能形态模式",
                "上线后3天流入玩法参与用户数": 2,
                "上线后3天流出用户数": 21,
                "上线后3天双栖用户数": 1,
                "上线前一周流出玩法总参与用户数": 22,
                "流出占比": 0.95,
                "上线后3天流出玩法总参与用户数": 1,
                "双栖占比": 0.05
            },
            {
                "流入玩法": "庆典混战",
                "流出玩法": "组队竞技",
                "上线后3天流入玩法参与用户数": 4,
                "上线后3天流出用户数": 37,
                "上线后3天双栖用户数": 5,
                "上线前一周流出玩法总参与用户数": 42,
                "流出占比": 0.88,
                "上线后3天流出玩法总参与用户数": 5,
                "双栖占比": 0.12
            },
            {
                "流入玩法": "庆典混战",
                "流出玩法": "领地",
                "上线后3天流入玩法参与用户数": 0,
                "上线后3天流出用户数": 2,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 2,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "消灭战",
                "流出玩法": "主题群屿",
                "上线后3天流入玩法参与用户数": 1,
                "上线后3天流出用户数": 3,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 3,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "消灭战",
                "流出玩法": "乐园",
                "上线后3天流入玩法参与用户数": 1,
                "上线后3天流出用户数": 6,
                "上线后3天双栖用户数": 1,
                "上线前一周流出玩法总参与用户数": 7,
                "流出占比": 0.86,
                "上线后3天流出玩法总参与用户数": 1,
                "双栖占比": 0.14
            },
            {
                "流入玩法": "消灭战",
                "流出玩法": "休闲模式",
                "上线后3天流入玩法参与用户数": 2,
                "上线后3天流出用户数": 11,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 11,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "消灭战",
                "流出玩法": "传统群屿",
                "上线后3天流入玩法参与用户数": 0,
                "上线后3天流出用户数": 1,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 1,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "消灭战",
                "流出玩法": "假日群岛",
                "上线后3天流入玩法参与用户数": 0,
                "上线后3天流出用户数": 9,
                "上线后3天双栖用户数": 1,
                "上线前一周流出玩法总参与用户数": 10,
                "流出占比": 0.9,
                "上线后3天流出玩法总参与用户数": 1,
                "双栖占比": 0.1
            },
            {
                "流入玩法": "消灭战",
                "流出玩法": "广阔天地",
                "上线后3天流入玩法参与用户数": 0,
                "上线后3天流出用户数": 9,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 9,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "消灭战",
                "流出玩法": "极能形态模式",
                "上线后3天流入玩法参与用户数": 2,
                "上线后3天流出用户数": 10,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 10,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "消灭战",
                "流出玩法": "组队竞技",
                "上线后3天流入玩法参与用户数": 2,
                "上线后3天流出用户数": 27,
                "上线后3天双栖用户数": 3,
                "上线前一周流出玩法总参与用户数": 30,
                "流出占比": 0.9,
                "上线后3天流出玩法总参与用户数": 3,
                "双栖占比": 0.1
            },
            {
                "流入玩法": "消灭战",
                "流出玩法": "领地",
                "上线后3天流入玩法参与用户数": 1,
                "上线后3天流出用户数": 3,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 3,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "炎夏混战",
                "流出玩法": "主题群屿",
                "上线后3天流入玩法参与用户数": 0,
                "上线后3天流出用户数": 13,
                "上线后3天双栖用户数": 1,
                "上线前一周流出玩法总参与用户数": 14,
                "流出占比": 0.93,
                "上线后3天流出玩法总参与用户数": 1,
                "双栖占比": 0.07
            },
            {
                "流入玩法": "炎夏混战",
                "流出玩法": "乐园",
                "上线后3天流入玩法参与用户数": 0,
                "上线后3天流出用户数": 6,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 6,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "炎夏混战",
                "流出玩法": "传统群屿",
                "上线后3天流入玩法参与用户数": 0,
                "上线后3天流出用户数": 2,
                "上线后3天双栖用户数": 2,
                "上线前一周流出玩法总参与用户数": 4,
                "流出占比": 0.5,
                "上线后3天流出玩法总参与用户数": 2,
                "双栖占比": 0.5
            },
            {
                "流入玩法": "炎夏混战",
                "流出玩法": "假日群岛",
                "上线后3天流入玩法参与用户数": 0,
                "上线后3天流出用户数": 17,
                "上线后3天双栖用户数": 1,
                "上线前一周流出玩法总参与用户数": 18,
                "流出占比": 0.94,
                "上线后3天流出玩法总参与用户数": 1,
                "双栖占比": 0.06
            },
            {
                "流入玩法": "炎夏混战",
                "流出玩法": "广阔天地",
                "上线后3天流入玩法参与用户数": 0,
                "上线后3天流出用户数": 2,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 2,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "炎夏混战",
                "流出玩法": "极能形态模式",
                "上线后3天流入玩法参与用户数": 0,
                "上线后3天流出用户数": 12,
                "上线后3天双栖用户数": 2,
                "上线前一周流出玩法总参与用户数": 14,
                "流出占比": 0.86,
                "上线后3天流出玩法总参与用户数": 2,
                "双栖占比": 0.14
            },
            {
                "流入玩法": "炎夏混战",
                "流出玩法": "组队竞技",
                "上线后3天流入玩法参与用户数": 0,
                "上线后3天流出用户数": 30,
                "上线后3天双栖用户数": 2,
                "上线前一周流出玩法总参与用户数": 32,
                "流出占比": 0.94,
                "上线后3天流出玩法总参与用户数": 2,
                "双栖占比": 0.06
            },
            {
                "流入玩法": "炎夏混战",
                "流出玩法": "隧道",
                "上线后3天流入玩法参与用户数": 0,
                "上线后3天流出用户数": 30,
                "上线后3天双栖用户数": 2,
                "上线前一周流出玩法总参与用户数": 32,
                "流出占比": 0.94,
                "上线后3天流出玩法总参与用户数": 2,
                "双栖占比": 0.06
            },
            {
                "流入玩法": "炎夏混战",
                "流出玩法": "领地",
                "上线后3天流入玩法参与用户数": 0,
                "上线后3天流出用户数": 1,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 1,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "策略载具",
                "流出玩法": "主题群屿",
                "上线后3天流入玩法参与用户数": 1,
                "上线后3天流出用户数": 4,
                "上线后3天双栖用户数": 3,
                "上线前一周流出玩法总参与用户数": 7,
                "流出占比": 0.57,
                "上线后3天流出玩法总参与用户数": 3,
                "双栖占比": 0.43
            },
            {
                "流入玩法": "策略载具",
                "流出玩法": "乐园",
                "上线后3天流入玩法参与用户数": 2,
                "上线后3天流出用户数": 11,
                "上线后3天双栖用户数": 3,
                "上线前一周流出玩法总参与用户数": 14,
                "流出占比": 0.79,
                "上线后3天流出玩法总参与用户数": 3,
                "双栖占比": 0.21
            },
            {
                "流入玩法": "策略载具",
                "流出玩法": "休闲模式",
                "上线后3天流入玩法参与用户数": 1,
                "上线后3天流出用户数": 4,
                "上线后3天双栖用户数": 1,
                "上线前一周流出玩法总参与用户数": 5,
                "流出占比": 0.8,
                "上线后3天流出玩法总参与用户数": 1,
                "双栖占比": 0.2
            },
            {
                "流入玩法": "策略载具",
                "流出玩法": "传统群屿",
                "上线后3天流入玩法参与用户数": 0,
                "上线后3天流出用户数": 1,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 1,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "策略载具",
                "流出玩法": "假日群岛",
                "上线后3天流入玩法参与用户数": 1,
                "上线后3天流出用户数": 6,
                "上线后3天双栖用户数": 2,
                "上线前一周流出玩法总参与用户数": 8,
                "流出占比": 0.75,
                "上线后3天流出玩法总参与用户数": 2,
                "双栖占比": 0.25
            },
            {
                "流入玩法": "策略载具",
                "流出玩法": "广域战场",
                "上线后3天流入玩法参与用户数": 0,
                "上线后3天流出用户数": 2,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 2,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "策略载具",
                "流出玩法": "广阔天地",
                "上线后3天流入玩法参与用户数": 1,
                "上线后3天流出用户数": 2,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 2,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "策略载具",
                "流出玩法": "极能形态模式",
                "上线后3天流入玩法参与用户数": 1,
                "上线后3天流出用户数": 8,
                "上线后3天双栖用户数": 4,
                "上线前一周流出玩法总参与用户数": 12,
                "流出占比": 0.67,
                "上线后3天流出玩法总参与用户数": 4,
                "双栖占比": 0.33
            },
            {
                "流入玩法": "策略载具",
                "流出玩法": "组队竞技",
                "上线后3天流入玩法参与用户数": 2,
                "上线后3天流出用户数": 7,
                "上线后3天双栖用户数": 8,
                "上线前一周流出玩法总参与用户数": 15,
                "流出占比": 0.47,
                "上线后3天流出玩法总参与用户数": 8,
                "双栖占比": 0.53
            },
            {
                "流入玩法": "策略载具",
                "流出玩法": "隧道",
                "上线后3天流入玩法参与用户数": 2,
                "上线后3天流出用户数": 19,
                "上线后3天双栖用户数": 5,
                "上线前一周流出玩法总参与用户数": 24,
                "流出占比": 0.79,
                "上线后3天流出玩法总参与用户数": 5,
                "双栖占比": 0.21
            },
            {
                "流入玩法": "策略载具",
                "流出玩法": "领地",
                "上线后3天流入玩法参与用户数": 1,
                "上线后3天流出用户数": 4,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 4,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "荒野传说",
                "流出玩法": "主题群屿",
                "上线后3天流入玩法参与用户数": 1,
                "上线后3天流出用户数": 1,
                "上线后3天双栖用户数": 1,
                "上线前一周流出玩法总参与用户数": 2,
                "流出占比": 0.5,
                "上线后3天流出玩法总参与用户数": 1,
                "双栖占比": 0.5
            },
            {
                "流入玩法": "荒野传说",
                "流出玩法": "乐园",
                "上线后3天流入玩法参与用户数": 1,
                "上线后3天流出用户数": 11,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 11,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "荒野传说",
                "流出玩法": "休闲模式",
                "上线后3天流入玩法参与用户数": 0,
                "上线后3天流出用户数": 3,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 3,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "荒野传说",
                "流出玩法": "假日群岛",
                "上线后3天流入玩法参与用户数": 1,
                "上线后3天流出用户数": 9,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 9,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "荒野传说",
                "流出玩法": "广域战场",
                "上线后3天流入玩法参与用户数": 0,
                "上线后3天流出用户数": 8,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 8,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "荒野传说",
                "流出玩法": "广阔天地",
                "上线后3天流入玩法参与用户数": 0,
                "上线后3天流出用户数": 3,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 3,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            },
            {
                "流入玩法": "荒野传说",
                "流出玩法": "极能形态模式",
                "上线后3天流入玩法参与用户数": 2,
                "上线后3天流出用户数": 15,
                "上线后3天双栖用户数": 1,
                "上线前一周流出玩法总参与用户数": 16,
                "流出占比": 0.94,
                "上线后3天流出玩法总参与用户数": 1,
                "双栖占比": 0.06
            },
            {
                "流入玩法": "荒野传说",
                "流出玩法": "组队竞技",
                "上线后3天流入玩法参与用户数": 2,
                "上线后3天流出用户数": 24,
                "上线后3天双栖用户数": 1,
                "上线前一周流出玩法总参与用户数": 25,
                "流出占比": 0.96,
                "上线后3天流出玩法总参与用户数": 1,
                "双栖占比": 0.04
            },
            {
                "流入玩法": "荒野传说",
                "流出玩法": "隧道",
                "上线后3天流入玩法参与用户数": 1,
                "上线后3天流出用户数": 44,
                "上线后3天双栖用户数": 3,
                "上线前一周流出玩法总参与用户数": 47,
                "流出占比": 0.94,
                "上线后3天流出玩法总参与用户数": 3,
                "双栖占比": 0.06
            },
            {
                "流入玩法": "荒野传说",
                "流出玩法": "领地",
                "上线后3天流入玩法参与用户数": 0,
                "上线后3天流出用户数": 1,
                "上线后3天双栖用户数": 0,
                "上线前一周流出玩法总参与用户数": 1,
                "流出占比": 1,
                "上线后3天流出玩法总参与用户数": 0,
                "双栖占比": 0
            }
        ]
    },
    {
        "sql_id": "sql_45",
        "sql": "\nWITH \n-- Players who played puzzle carnival during 2024-01-01 to 2024-01-07\nweek1_players AS (\n    SELECT DISTINCT vplayerid\n    FROM dws_jordass_matchlog_stat_di\n    WHERE dtstatdate BETWEEN '20240101' AND '20240107'\n    AND imode = 1287652322611036928\n),\n\n-- Players who didn't play puzzle carnival during 2024-01-08 to 2024-01-14\nweek2_non_players AS (\n    SELECT DISTINCT vplayerid\n    FROM dws_jordass_matchlog_stat_di\n    WHERE dtstatdate BETWEEN '20240108' AND '20240114'\n    AND imode = 1287652322611036928\n),\n\n-- Players who returned to play puzzle carnival during 2024-01-15 to 2024-01-21\nweek3_return_players AS (\n    SELECT DISTINCT vplayerid\n    FROM dws_jordass_matchlog_stat_di\n    WHERE dtstatdate BETWEEN '20240115' AND '20240121'\n    AND imode = 1287652322611036928\n)\n\n-- Final count of players who fit all criteria\nSELECT COUNT(DISTINCT p.vplayerid) AS player_count\nFROM week1_players p\nWHERE p.vplayerid NOT IN (SELECT vplayerid FROM week2_non_players)\nAND p.vplayerid IN (SELECT vplayerid FROM week3_return_players);\n",
        "status": "success",
        "result": [
            {
                "player_count": 114
            }
        ]
    },
    {
        "sql_id": "sql_46",
        "sql": "\nWITH weekly_active_days AS (\n    SELECT \n        WEEK(dtstatdate, 1) - WEEK('2024-01-01', 1) + 1 AS week_num,\n        vplayerid,\n        COUNT(DISTINCT dtstatdate) AS active_days\n    FROM dws_jordass_login_di\n    WHERE dtstatdate BETWEEN '20240101' AND '20240202'\n    GROUP BY WEEK(dtstatdate, 1) - WEEK('2024-01-01', 1) + 1, vplayerid\n)\n\nSELECT \n    week_num AS '统计周',\n    active_days AS '周活跃天数',\n    COUNT(vplayerid) AS '玩家数'\nFROM weekly_active_days\nGROUP BY week_num, active_days\nORDER BY week_num, active_days;\n",
        "status": "success",
        "result": [
            {
                "统计周": 1,
                "周活跃天数": 1,
                "玩家数": 226
            },
            {
                "统计周": 1,
                "周活跃天数": 2,
                "玩家数": 3
            },
            {
                "统计周": 1,
                "周活跃天数": 3,
                "玩家数": 1
            },
            {
                "统计周": 1,
                "周活跃天数": 4,
                "玩家数": 2
            },
            {
                "统计周": 1,
                "周活跃天数": 5,
                "玩家数": 1
            },
            {
                "统计周": 1,
                "周活跃天数": 6,
                "玩家数": 1
            },
            {
                "统计周": 1,
                "周活跃天数": 7,
                "玩家数": 5
            },
            {
                "统计周": 2,
                "周活跃天数": 1,
                "玩家数": 7
            },
            {
                "统计周": 2,
                "周活跃天数": 2,
                "玩家数": 3
            },
            {
                "统计周": 2,
                "周活跃天数": 3,
                "玩家数": 1
            },
            {
                "统计周": 2,
                "周活跃天数": 4,
                "玩家数": 1
            },
            {
                "统计周": 2,
                "周活跃天数": 5,
                "玩家数": 1
            },
            {
                "统计周": 2,
                "周活跃天数": 6,
                "玩家数": 1
            },
            {
                "统计周": 2,
                "周活跃天数": 7,
                "玩家数": 4
            },
            {
                "统计周": 3,
                "周活跃天数": 1,
                "玩家数": 4
            },
            {
                "统计周": 3,
                "周活跃天数": 2,
                "玩家数": 3
            },
            {
                "统计周": 3,
                "周活跃天数": 3,
                "玩家数": 1
            },
            {
                "统计周": 3,
                "周活跃天数": 4,
                "玩家数": 3
            },
            {
                "统计周": 3,
                "周活跃天数": 5,
                "玩家数": 1
            },
            {
                "统计周": 3,
                "周活跃天数": 6,
                "玩家数": 1
            },
            {
                "统计周": 3,
                "周活跃天数": 7,
                "玩家数": 3
            },
            {
                "统计周": 4,
                "周活跃天数": 1,
                "玩家数": 3
            },
            {
                "统计周": 4,
                "周活跃天数": 2,
                "玩家数": 5
            },
            {
                "统计周": 4,
                "周活跃天数": 3,
                "玩家数": 1
            },
            {
                "统计周": 4,
                "周活跃天数": 4,
                "玩家数": 1
            },
            {
                "统计周": 4,
                "周活跃天数": 5,
                "玩家数": 1
            },
            {
                "统计周": 4,
                "周活跃天数": 6,
                "玩家数": 1
            },
            {
                "统计周": 4,
                "周活跃天数": 7,
                "玩家数": 3
            },
            {
                "统计周": 5,
                "周活跃天数": 1,
                "玩家数": 6
            },
            {
                "统计周": 5,
                "周活跃天数": 2,
                "玩家数": 2
            },
            {
                "统计周": 5,
                "周活跃天数": 3,
                "玩家数": 1
            },
            {
                "统计周": 5,
                "周活跃天数": 4,
                "玩家数": 1
            },
            {
                "统计周": 5,
                "周活跃天数": 5,
                "玩家数": 5
            }
        ]
    },
    {
        "sql_id": "sql_48",
        "sql": "\nSELECT \n    COUNT(DISTINCT CASE \n        WHEN SUBSTRING(cbitmap, 2, 7) = '0000000' AND SUBSTRING(cbitmap, 1, 1) = '1' \n        THEN vplayerid \n    END) AS lost_7day_return_users,\n    COUNT(DISTINCT CASE \n        WHEN SUBSTRING(cbitmap, 2, 30) = '000000000000000000000000000000' AND SUBSTRING(cbitmap, 1, 1) = '1' \n        THEN vplayerid \n    END) AS lost_30day_return_users\nFROM dws_jordass_login_df\nWHERE dtstatdate = '20231201'\n",
        "status": "success",
        "result": [
            {
                "lost_7day_return_users": 94,
                "lost_30day_return_users": 83
            }
        ]
    },
    {
        "sql_id": "sql_49",
        "sql": "\nWITH eligible_modes AS (\n    SELECT matchsubmodegroup\n    FROM dim_jordass_submodeonline_nf\n    WHERE DATEDIFF('2024-10-01', onlinedate) >= 7\n      AND DATEDIFF('2024-10-07', onlinedate) <= 90\n),\n\ndaily_participation AS (\n    SELECT \n        m.dtstatdate,\n        COUNT(DISTINCT m.vplayerid) AS participation_count\n    FROM dws_jordass_matchlog_stat_di m\n    JOIN eligible_modes e ON m.imode = e.matchsubmodegroup\n    WHERE m.dtstatdate BETWEEN '20241001' AND '20241007'\n    GROUP BY m.dtstatdate\n),\n\nretention_data AS (\n    SELECT \n        m1.dtstatdate,\n        COUNT(DISTINCT m1.vplayerid) AS retained_count\n    FROM dws_jordass_matchlog_stat_di m1\n    JOIN dws_jordass_matchlog_stat_di m2 \n        ON m1.vplayerid = m2.vplayerid \n        AND m1.imode = m2.imode\n        AND m2.dtstatdate = DATE_FORMAT(DATE_ADD(STR_TO_DATE(m1.dtstatdate, '%Y%m%d'), INTERVAL 1 DAY), '%Y%m%d')\n    JOIN eligible_modes e ON m1.imode = e.matchsubmodegroup\n    WHERE m1.dtstatdate BETWEEN '20241001' AND '20241006'\n    GROUP BY m1.dtstatdate\n)\n\nSELECT \n    '20241001-20241007' AS period,\n    p.dtstatdate AS date,\n    p.participation_count,\n    COALESCE(r.retained_count, 0) AS next_day_retention\nFROM daily_participation p\nLEFT JOIN retention_data r ON p.dtstatdate = r.dtstatdate\nORDER BY p.dtstatdate;\n",
        "status": "success",
        "result": [
            {
                "period": "20241001-20241007",
                "date": "20241001",
                "participation_count": 137,
                "next_day_retention": 12
            },
            {
                "period": "20241001-20241007",
                "date": "20241002",
                "participation_count": 120,
                "next_day_retention": 11
            },
            {
                "period": "20241001-20241007",
                "date": "20241003",
                "participation_count": 136,
                "next_day_retention": 12
            },
            {
                "period": "20241001-20241007",
                "date": "20241004",
                "participation_count": 110,
                "next_day_retention": 18
            },
            {
                "period": "20241001-20241007",
                "date": "20241005",
                "participation_count": 134,
                "next_day_retention": 20
            },
            {
                "period": "20241001-20241007",
                "date": "20241006",
                "participation_count": 111,
                "next_day_retention": 14
            },
            {
                "period": "20241001-20241007",
                "date": "20241007",
                "participation_count": 113,
                "next_day_retention": 0
            }
        ]
    },
    {
        "sql_id": "sql_56",
        "sql": "\nWITH new_users AS (\n    SELECT \n        dregdate,\n        vplayerid\n    FROM \n        dws_jordass_login_df\n    WHERE \n        dregdate BETWEEN '20240101' AND '20240131'\n),\n\nuser_revenue AS (\n    SELECT \n        nu.dregdate,\n        nu.vplayerid,\n        w.dtstatdate,\n        w.imoney,\n        DATEDIFF(STR_TO_DATE(w.dtstatdate, '%Y%m%d'), STR_TO_DATE(nu.dregdate, '%Y%m%d')) AS days_since_reg\n    FROM \n        new_users nu\n    LEFT JOIN \n        dws_jordass_water_di w ON nu.vplayerid = w.vplayerid\n    WHERE \n        w.dtstatdate >= nu.dregdate\n        AND DATEDIFF(STR_TO_DATE(w.dtstatdate, '%Y%m%d'), STR_TO_DATE(nu.dregdate, '%Y%m%d')) < 180\n),\n\nltv_calculation AS (\n    SELECT \n        dregdate,\n        vplayerid,\n        SUM(CASE WHEN days_since_reg < 1 THEN imoney ELSE 0 END) AS ltv1,\n        SUM(CASE WHEN days_since_reg < 3 THEN imoney ELSE 0 END) AS ltv3,\n        SUM(CASE WHEN days_since_reg < 7 THEN imoney ELSE 0 END) AS ltv7,\n        SUM(CASE WHEN days_since_reg < 14 THEN imoney ELSE 0 END) AS ltv14,\n        SUM(CASE WHEN days_since_reg < 30 THEN imoney ELSE 0 END) AS ltv30,\n        SUM(CASE WHEN days_since_reg < 60 THEN imoney ELSE 0 END) AS ltv60,\n        SUM(CASE WHEN days_since_reg < 90 THEN imoney ELSE 0 END) AS ltv90,\n        SUM(CASE WHEN days_since_reg < 180 THEN imoney ELSE 0 END) AS ltv180\n    FROM \n        user_revenue\n    GROUP BY \n        dregdate, vplayerid\n)\n\nSELECT \n    dregdate AS '注册日期',\n    COUNT(vplayerid) AS '新进用户数',\n    ROUND(AVG(ltv1), 2) AS 'LTV1',\n    ROUND(AVG(ltv3), 2) AS 'LTV3',\n    ROUND(AVG(ltv7), 2) AS 'LTV7',\n    ROUND(AVG(ltv14), 2) AS 'LTV14',\n    ROUND(AVG(ltv30), 2) AS 'LTV30',\n    ROUND(AVG(ltv60), 2) AS 'LTV60',\n    ROUND(AVG(ltv90), 2) AS 'LTV90',\n    ROUND(AVG(ltv180), 2) AS 'LTV180'\nFROM \n    ltv_calculation\nGROUP BY \n    dregdate\nORDER BY \n    dregdate;\n",
        "status": "success",
        "result": [
            {
                "注册日期": "20240101",
                "新进用户数": 31,
                "LTV1": 3954.84,
                "LTV3": 3954.84,
                "LTV7": 11370.97,
                "LTV14": 11409.68,
                "LTV30": 13145.16,
                "LTV60": 17764.52,
                "LTV90": 19906.45,
                "LTV180": 37712.9
            },
            {
                "注册日期": "20240102",
                "新进用户数": 21,
                "LTV1": 1152.38,
                "LTV3": 1157.14,
                "LTV7": 1157.14,
                "LTV14": 1157.14,
                "LTV30": 1328.57,
                "LTV60": 3647.62,
                "LTV90": 9490.48,
                "LTV180": 22785.71
            },
            {
                "注册日期": "20240103",
                "新进用户数": 20,
                "LTV1": 30,
                "LTV3": 480,
                "LTV7": 480,
                "LTV14": 480,
                "LTV30": 730,
                "LTV60": 6910,
                "LTV90": 7650,
                "LTV180": 17640
            },
            {
                "注册日期": "20240104",
                "新进用户数": 11,
                "LTV1": 1800,
                "LTV3": 1800,
                "LTV7": 19963.64,
                "LTV14": 20354.55,
                "LTV30": 25463.64,
                "LTV60": 37300,
                "LTV90": 38480,
                "LTV180": 47152.73
            },
            {
                "注册日期": "20240105",
                "新进用户数": 28,
                "LTV1": 0,
                "LTV3": 521.43,
                "LTV7": 1007.14,
                "LTV14": 1007.14,
                "LTV30": 3278.57,
                "LTV60": 15278.57,
                "LTV90": 42014.29,
                "LTV180": 57646.43
            },
            {
                "注册日期": "20240106",
                "新进用户数": 24,
                "LTV1": 75,
                "LTV3": 75,
                "LTV7": 75,
                "LTV14": 87.5,
                "LTV30": 229.17,
                "LTV60": 8837.5,
                "LTV90": 10062.5,
                "LTV180": 20983.33
            },
            {
                "注册日期": "20240107",
                "新进用户数": 27,
                "LTV1": 0,
                "LTV3": 48.15,
                "LTV7": 48.15,
                "LTV14": 940.74,
                "LTV30": 2925.93,
                "LTV60": 8588.89,
                "LTV90": 15103.7,
                "LTV180": 28533.33
            },
            {
                "注册日期": "20240108",
                "新进用户数": 16,
                "LTV1": 0,
                "LTV3": 0,
                "LTV7": 0,
                "LTV14": 1100,
                "LTV30": 1643.75,
                "LTV60": 9643.75,
                "LTV90": 10662.5,
                "LTV180": 15018.75
            },
            {
                "注册日期": "20240109",
                "新进用户数": 11,
                "LTV1": 0,
                "LTV3": 0,
                "LTV7": 0,
                "LTV14": 2527.27,
                "LTV30": 3109.09,
                "LTV60": 4581.82,
                "LTV90": 6272.73,
                "LTV180": 7936.36
            },
            {
                "注册日期": "20240110",
                "新进用户数": 18,
                "LTV1": 100,
                "LTV3": 1322.22,
                "LTV7": 4961.11,
                "LTV14": 7527.78,
                "LTV30": 11250,
                "LTV60": 17555.56,
                "LTV90": 23022.22,
                "LTV180": 37772.22
            },
            {
                "注册日期": "20240111",
                "新进用户数": 21,
                "LTV1": 561.9,
                "LTV3": 561.9,
                "LTV7": 561.9,
                "LTV14": 566.67,
                "LTV30": 1842.86,
                "LTV60": 3985.71,
                "LTV90": 5376.19,
                "LTV180": 16338.1
            },
            {
                "注册日期": "20240112",
                "新进用户数": 19,
                "LTV1": 31.58,
                "LTV3": 157.89,
                "LTV7": 157.89,
                "LTV14": 347.37,
                "LTV30": 18405.26,
                "LTV60": 21152.63,
                "LTV90": 21215.79,
                "LTV180": 54542.11
            },
            {
                "注册日期": "20240113",
                "新进用户数": 28,
                "LTV1": 0,
                "LTV3": 107.14,
                "LTV7": 107.14,
                "LTV14": 571.43,
                "LTV30": 4771.43,
                "LTV60": 7971.43,
                "LTV90": 9028.57,
                "LTV180": 12753.57
            },
            {
                "注册日期": "20240114",
                "新进用户数": 22,
                "LTV1": 0,
                "LTV3": 27.27,
                "LTV7": 39559.09,
                "LTV14": 39559.09,
                "LTV30": 40436.36,
                "LTV60": 49627.27,
                "LTV90": 54500,
                "LTV180": 66336.36
            },
            {
                "注册日期": "20240115",
                "新进用户数": 19,
                "LTV1": 0,
                "LTV3": 31.58,
                "LTV7": 126.32,
                "LTV14": 1063.16,
                "LTV30": 13200,
                "LTV60": 14884.21,
                "LTV90": 15968.42,
                "LTV180": 30315.79
            },
            {
                "注册日期": "20240116",
                "新进用户数": 21,
                "LTV1": 700,
                "LTV3": 728.57,
                "LTV7": 728.57,
                "LTV14": 795.24,
                "LTV30": 995.24,
                "LTV60": 6171.43,
                "LTV90": 11766.67,
                "LTV180": 32780.95
            },
            {
                "注册日期": "20240117",
                "新进用户数": 19,
                "LTV1": 0,
                "LTV3": 0,
                "LTV7": 136.84,
                "LTV14": 326.32,
                "LTV30": 6868.42,
                "LTV60": 12931.58,
                "LTV90": 23278.95,
                "LTV180": 33194.74
            },
            {
                "注册日期": "20240118",
                "新进用户数": 20,
                "LTV1": 0,
                "LTV3": 1690,
                "LTV7": 2130,
                "LTV14": 2810,
                "LTV30": 6070,
                "LTV60": 8800,
                "LTV90": 9725,
                "LTV180": 20810
            },
            {
                "注册日期": "20240119",
                "新进用户数": 24,
                "LTV1": 0,
                "LTV3": 1250,
                "LTV7": 1250,
                "LTV14": 1250,
                "LTV30": 2112.5,
                "LTV60": 4870.83,
                "LTV90": 5308.33,
                "LTV180": 13720.83
            },
            {
                "注册日期": "20240120",
                "新进用户数": 29,
                "LTV1": 0,
                "LTV3": 27.59,
                "LTV7": 27.59,
                "LTV14": 468.97,
                "LTV30": 2941.38,
                "LTV60": 16031.03,
                "LTV90": 17555.17,
                "LTV180": 21720.69
            },
            {
                "注册日期": "20240121",
                "新进用户数": 13,
                "LTV1": 0,
                "LTV3": 0,
                "LTV7": 0,
                "LTV14": 23.08,
                "LTV30": 10123.08,
                "LTV60": 11307.69,
                "LTV90": 16761.54,
                "LTV180": 50600
            },
            {
                "注册日期": "20240122",
                "新进用户数": 13,
                "LTV1": 0,
                "LTV3": 0,
                "LTV7": 0,
                "LTV14": 0,
                "LTV30": 1823.08,
                "LTV60": 11392.31,
                "LTV90": 12138.46,
                "LTV180": 23438.46
            },
            {
                "注册日期": "20240123",
                "新进用户数": 20,
                "LTV1": 0,
                "LTV3": 5,
                "LTV7": 220,
                "LTV14": 220,
                "LTV30": 220,
                "LTV60": 26440,
                "LTV90": 27675,
                "LTV180": 39940
            },
            {
                "注册日期": "20240124",
                "新进用户数": 16,
                "LTV1": 0,
                "LTV3": 487.5,
                "LTV7": 487.5,
                "LTV14": 681.25,
                "LTV30": 831.25,
                "LTV60": 1993.75,
                "LTV90": 4443.75,
                "LTV180": 11662.5
            },
            {
                "注册日期": "20240125",
                "新进用户数": 12,
                "LTV1": 0,
                "LTV3": 0,
                "LTV7": 0,
                "LTV14": 5133.33,
                "LTV30": 5358.33,
                "LTV60": 32698.33,
                "LTV90": 46965,
                "LTV180": 49656.67
            },
            {
                "注册日期": "20240126",
                "新进用户数": 17,
                "LTV1": 0,
                "LTV3": 0,
                "LTV7": 0,
                "LTV14": 0,
                "LTV30": 535.29,
                "LTV60": 647.06,
                "LTV90": 30417.65,
                "LTV180": 51952.94
            },
            {
                "注册日期": "20240127",
                "新进用户数": 19,
                "LTV1": 0,
                "LTV3": 0,
                "LTV7": 0,
                "LTV14": 0,
                "LTV30": 20321.05,
                "LTV60": 37094.74,
                "LTV90": 49900,
                "LTV180": 89957.37
            },
            {
                "注册日期": "20240128",
                "新进用户数": 10,
                "LTV1": 1980,
                "LTV3": 1980,
                "LTV7": 4260,
                "LTV14": 4260,
                "LTV30": 6560,
                "LTV60": 10560,
                "LTV90": 13600,
                "LTV180": 21450
            },
            {
                "注册日期": "20240129",
                "新进用户数": 20,
                "LTV1": 0,
                "LTV3": 450,
                "LTV7": 450,
                "LTV14": 690,
                "LTV30": 5300,
                "LTV60": 16120,
                "LTV90": 21180,
                "LTV180": 44574.5
            },
            {
                "注册日期": "20240130",
                "新进用户数": 21,
                "LTV1": 0,
                "LTV3": 0,
                "LTV7": 0,
                "LTV14": 0,
                "LTV30": 214.29,
                "LTV60": 1538.1,
                "LTV90": 4176.19,
                "LTV180": 10619.05
            },
            {
                "注册日期": "20240131",
                "新进用户数": 21,
                "LTV1": 0,
                "LTV3": 0,
                "LTV7": 0,
                "LTV14": 1219.05,
                "LTV30": 5871.43,
                "LTV60": 10357.14,
                "LTV90": 12085.71,
                "LTV180": 16538.1
            }
        ]
    },
    {
        "sql_id": "sql_57",
        "sql": "WITH daily_stats AS (\n    SELECT \n        SUBSTRING(dteventtime, 1, 10) AS activity_date,\n        COUNT(*) AS pv,\n        COUNT(DISTINCT uid) AS uv\n    FROM \n        dwd_jordass_activitypress_hi\n    WHERE \n        ireason = 2411291018 \n        AND buttontype = 10045 \n        AND extarg1 IN (117, 115)\n        AND dteventtime >= '2024-11-29 00:00:00'\n        AND dteventtime <= '2024-12-19 23:59:59'\n    GROUP BY \n        SUBSTRING(dteventtime, 1, 10)\n)\n\nSELECT \n    REPLACE(activity_date, '-', '') AS '日期',\n    pv,\n    uv\nFROM \n    daily_stats\n\nUNION ALL\n\nSELECT \n    '汇总' AS '日期',\n    SUM(pv) AS pv,\n    COUNT(DISTINCT uid) AS uv\nFROM \n    dwd_jordass_activitypress_hi\nWHERE \n    ireason = 2411291018 \n    AND buttontype = 10045 \n    AND extarg1 IN (117, 115)\n    AND dteventtime >= '2024-11-29 00:00:00'\n    AND dteventtime <= '2024-12-19 23:59:59'\n\nORDER BY \n    CASE WHEN 日期 = '汇总' THEN 1 ELSE 0 END,\n    日期;",
        "status": "error",
        "error_message": "Max retry times reached"
    },
    {
        "sql_id": "sql_59",
        "sql": "\nWITH giveaway_triggers AS (\n    SELECT \n        vplayerid,\n        dteventtime,\n        arg1,\n        ROW_NUMBER() OVER (PARTITION BY vplayerid ORDER BY dteventtime) AS trigger_sequence\n    FROM dwd_jordass_activityrecord_hi\n    WHERE actid = 2411070621 \n      AND acttype = 10062\n      AND dteventtime BETWEEN '2025-01-11 00:00:00' AND '2025-01-24 23:59:59'\n      AND strarg1 <> '0'\n),\n\nuser_xth_trigger AS (\n    SELECT \n        vplayerid,\n        dteventtime AS xth_trigger_time,\n        trigger_sequence AS x_value\n    FROM giveaway_triggers\n    WHERE trigger_sequence >= 1\n),\n\nuser_total_draws AS (\n    SELECT \n        u.vplayerid,\n        u.x_value,\n        SUM(a.arg1) AS total_draws\n    FROM user_xth_trigger u\n    JOIN dwd_jordass_activityrecord_hi a ON u.vplayerid = a.vplayerid\n    WHERE a.actid = 2411070621 \n      AND a.acttype = 10062\n      AND a.dteventtime <= u.xth_trigger_time\n      AND a.dteventtime BETWEEN '2025-01-11 00:00:00' AND '2025-01-24 23:59:59'\n    GROUP BY u.vplayerid, u.x_value\n)\n\nSELECT \n    x_value AS '第X次触发',\n    COUNT(DISTINCT vplayerid) AS '触发用户数',\n    SUM(total_draws) AS '用户总抽奖次数'\nFROM user_total_draws\nGROUP BY x_value\nORDER BY x_value;\n",
        "status": "success",
        "result": [
            {
                "第X次触发": 1,
                "触发用户数": 29,
                "用户总抽奖次数": 32
            },
            {
                "第X次触发": 2,
                "触发用户数": 27,
                "用户总抽奖次数": 144
            },
            {
                "第X次触发": 3,
                "触发用户数": 4,
                "用户总抽奖次数": 22
            },
            {
                "第X次触发": 4,
                "触发用户数": 4,
                "用户总抽奖次数": 36
            },
            {
                "第X次触发": 5,
                "触发用户数": 3,
                "用户总抽奖次数": 29
            },
            {
                "第X次触发": 6,
                "触发用户数": 3,
                "用户总抽奖次数": 43
            },
            {
                "第X次触发": 7,
                "触发用户数": 2,
                "用户总抽奖次数": 36
            },
            {
                "第X次触发": 8,
                "触发用户数": 2,
                "用户总抽奖次数": 43
            },
            {
                "第X次触发": 9,
                "触发用户数": 2,
                "用户总抽奖次数": 51
            },
            {
                "第X次触发": 10,
                "触发用户数": 1,
                "用户总抽奖次数": 26
            },
            {
                "第X次触发": 11,
                "触发用户数": 1,
                "用户总抽奖次数": 26
            },
            {
                "第X次触发": 12,
                "触发用户数": 1,
                "用户总抽奖次数": 34
            },
            {
                "第X次触发": 13,
                "触发用户数": 1,
                "用户总抽奖次数": 36
            },
            {
                "第X次触发": 14,
                "触发用户数": 1,
                "用户总抽奖次数": 36
            },
            {
                "第X次触发": 15,
                "触发用户数": 1,
                "用户总抽奖次数": 45
            },
            {
                "第X次触发": 16,
                "触发用户数": 1,
                "用户总抽奖次数": 47
            },
            {
                "第X次触发": 17,
                "触发用户数": 1,
                "用户总抽奖次数": 47
            },
            {
                "第X次触发": 18,
                "触发用户数": 1,
                "用户总抽奖次数": 57
            },
            {
                "第X次触发": 19,
                "触发用户数": 1,
                "用户总抽奖次数": 59
            },
            {
                "第X次触发": 20,
                "触发用户数": 1,
                "用户总抽奖次数": 59
            },
            {
                "第X次触发": 21,
                "触发用户数": 1,
                "用户总抽奖次数": 70
            },
            {
                "第X次触发": 22,
                "触发用户数": 1,
                "用户总抽奖次数": 72
            },
            {
                "第X次触发": 23,
                "触发用户数": 1,
                "用户总抽奖次数": 72
            },
            {
                "第X次触发": 24,
                "触发用户数": 1,
                "用户总抽奖次数": 84
            },
            {
                "第X次触发": 25,
                "触发用户数": 1,
                "用户总抽奖次数": 86
            },
            {
                "第X次触发": 26,
                "触发用户数": 1,
                "用户总抽奖次数": 86
            },
            {
                "第X次触发": 27,
                "触发用户数": 1,
                "用户总抽奖次数": 99
            },
            {
                "第X次触发": 28,
                "触发用户数": 1,
                "用户总抽奖次数": 101
            },
            {
                "第X次触发": 29,
                "触发用户数": 1,
                "用户总抽奖次数": 101
            },
            {
                "第X次触发": 30,
                "触发用户数": 1,
                "用户总抽奖次数": 115
            }
        ]
    }
]