{"sql_id": "sql_1", "sql": "\nselect \n    a.suserid,\n    a.sgamecode,\n    sum(a.ionlinetime) as ionlinetime\nfrom \n    dws_mgamejp_login_user_activity_di a\njoin \n    dim_vplayerid_vies_df b\non \n    a.suserid = b.suserid\nwhere \n    b.dtstatdate = '20250724'\n    and b.itag = '其他'\n    and a.dtstatdate between '20250530' and '20250724'\n    and a.sgamecode in ('initiatived','jordass','esports','allianceforce','strategy','playzone','su')\n    and a.saccounttype = '-100'\n    and a.suseridtype in ('qq','wxid')\n    and a.splattype = '-100'\n    and a.splat = '-100'\ngroup by \n    a.suserid, a.sgamecode\n;\n", "status": "success", "result": [{"suserid": "suserid_3", "sgamecode": "esports", "ionlinetime": 50}, {"suserid": "suserid_1", "sgamecode": "initiatived", "ionlinetime": 300}, {"suserid": "suserid_2", "sgamecode": "jordass", "ionlinetime": 400}, {"suserid": "suserid_5", "sgamecode": "strategy", "ionlinetime": 120}, {"suserid": "suserid_4", "sgamecode": "allianceforce", "ionlinetime": 80}, {"suserid": "suserid_6", "sgamecode": "playzone", "ionlinetime": 200}]}
{"sql_id": "sql_2", "sql": "\nselect distinct a.vplayerid\nfrom (\n    select vplayerid\n    from dws_argothek_ce1_cbt2_vplayerid_suserid_di\n    where dtstatdate between '20250717' and '20250723'\n    and platid = 255\n    and vplayerid not in (\n        select vplayerid \n        from dim_extract_311381_conf\n        where vplayerid like '721%'\n    )\n    group by vplayerid\n) a\njoin (\n    select distinct vplayerid\n    from dws_argothek_ce1_login_di\n    where dtstatdate between '20250717' and '20250723'\n    and platid = 255\n) b on a.vplayerid = b.vplayerid;\n", "status": "success", "result": []}
{"sql_id": "sql_3", "sql": "\nSELECT DISTINCT dim.iuserid AS gplayerid\nFROM dim_argothek_gplayerid2qqwxid_df dim\nJOIN dws_argothek_oss_login_di oss ON dim.iuserid = oss.iuserid\nJOIN dws_mgamejp_login_user_activity_di mgame ON dim.suserid = mgame.suserid\nWHERE \n    (oss.statis_date BETWEEN 20250101 AND 20250131 AND oss.iloginway = 1) -- 勇者盟约端游活跃\n    AND \n    (\n        (mgame.dtstatdate BETWEEN 20250101 AND 20250131 AND mgame.sgamecode = 'initiatived' AND mgame.splattype = 'PC') -- 峡谷端游活跃\n        OR\n        (mgame.dtstatdate BETWEEN 20250101 AND 20250131 AND mgame.sgamecode = 'initiatived' AND mgame.splattype = '-100') -- 峡谷手游活跃\n    );\n", "status": "success", "result": []}
{"sql_id": "sql_4", "sql": "\nselect \n    split_part(vrolename, '#', 1) as nickname,\n    count(distinct iuserid) as user_count\nfrom dwd_argothek_playerlogin_hi\nwhere dteventtime between '2023-07-12 00:00:00' and '2025-07-15 23:59:59'\ngroup by split_part(vrolename, '#', 1)\norder by user_count desc\nlimit 1;\n", "status": "success", "result": [{"nickname": "player3", "user_count": 3}]}
{"sql_id": "sql_6", "sql": "\nSELECT DISTINCT a.vplayerid\nFROM dws_argothek_ce1_cbt2_vplayerid_suserid_di a\nJOIN dim_argothek_gplayerid2qqwxid_df b ON a.suserid = b.suserid\nWHERE a.dtstatdate BETWEEN '20250612' AND '20250714'\n  AND a.itag = 'T2'\n  AND b.iregdate < '20250529'\n  AND a.platid = 0;  -- 假设platid=0表示手游\n", "status": "success", "result": []}
{"sql_id": "sql_7", "sql": "\nselect\n    dtstatdate as `日期`,\n    iregway as `注册渠道`,\n    count(distinct vplayerid) as `新进用户数`\nfrom dws_argothek_ce1_cbt2_vplayerid_suserid_di\nwhere dtstatdate between '20250703' and '20250706'\n  and is_reg = '1'\n  and sourcename not in ('内部体验', '买量测试')\n  and platid <> 255\n  and iregway in ('89903934', '89903933', '89903932', '89902725', '89902724', '89902723', '89900960', '89900961', '89900962')\ngroup by dtstatdate, iregway\norder by dtstatdate, iregway;\n", "status": "success", "result": []}
{"sql_id": "sql_8", "sql": "\nWITH monthly_stats AS (\n    SELECT \n        DATE_FORMAT(dteventtime, '%Y-%m') AS month,\n        gamepodid,\n        DATE_FORMAT(dteventtime, '%Y-%m-%d %H:00:00') AS peak_hour,\n        COUNT(DISTINCT matchid) AS total_matches,\n        SUM(CASE WHEN lower(completionState) IN ('completed', 'surrendered') AND queueid = 'competitive' THEN 1 ELSE 0 END) AS competitive_matches,\n        SUM(CASE WHEN lower(completionState) IN ('completed', 'surrendered') AND queueid = 'unrated' THEN 1 ELSE 0 END) AS unrated_matches,\n        SUM(CASE WHEN lower(completionState) IN ('completed', 'surrendered') AND queueid = 'swiftplay' THEN 1 ELSE 0 END) AS swiftplay_matches\n    FROM dwd_argothek_matchdetails_hi\n    WHERE dteventtime BETWEEN '2025-04-01' AND '2025-06-30 23:59:59'\n    GROUP BY DATE_FORMAT(dteventtime, '%Y-%m'), gamepodid, DATE_FORMAT(dteventtime, '%Y-%m-%d %H:00:00')\n),\n\npeak_hours AS (\n    SELECT \n        month,\n        gamepodid,\n        peak_hour,\n        total_matches,\n        competitive_matches,\n        unrated_matches,\n        swiftplay_matches,\n        ROW_NUMBER() OVER (PARTITION BY month, gamepodid ORDER BY total_matches DESC) AS rn\n    FROM monthly_stats\n)\n\nSELECT \n    month,\n    gamepodid AS '服务器节点',\n    peak_hour AS '峰值时间',\n    total_matches AS '总游戏结束数',\n    competitive_matches AS '排位结束数',\n    unrated_matches AS '普通结束数',\n    swiftplay_matches AS '极速结束数'\nFROM peak_hours\nWHERE rn = 1\nORDER BY month, gamepodid;\n", "status": "success", "result": [{"month": "2025-04", "服务器节点": "gp1", "峰值时间": "2025-04-01 18:00:00", "总游戏结束数": 2, "排位结束数": 0, "普通结束数": 1, "极速结束数": 1}, {"month": "2025-04", "服务器节点": "gp2", "峰值时间": "2025-04-02 12:00:00", "总游戏结束数": 1, "排位结束数": 1, "普通结束数": 0, "极速结束数": 0}, {"month": "2025-05", "服务器节点": "gp1", "峰值时间": "2025-05-01 18:00:00", "总游戏结束数": 2, "排位结束数": 1, "普通结束数": 0, "极速结束数": 1}, {"month": "2025-05", "服务器节点": "gp2", "峰值时间": "2025-05-02 12:00:00", "总游戏结束数": 1, "排位结束数": 1, "普通结束数": 0, "极速结束数": 0}]}
{"sql_id": "sql_9", "sql": "\nSELECT \n    b.city_level,\n    COUNT(DISTINCT a.suserid) AS user_count\nFROM \n    dim_mgamejp_account_allinfo_nf a\nJOIN \n    dim_uf_player_gameinfo_mf b ON a.suserid = b.userid\nWHERE \n    a.saccounttype = \"-100\"\n    AND a.suseridtype IN (\"qq\", \"wxid\")\n    AND a.sgamecode IN (\"esports\", \"mobile_live\", \"initiatived\", \"allianceforce\", \"strategy\", \"jordass\", \"su\", \"playzone\", \"battlezone\", \"battlearena\", \"weapon\", \"playhub\", \"manager\", \"apgame\")\n    AND a.splattype = \"-100\"\n    AND a.ilastactdate >= \"20250104\"\n    AND b.kp_imp_date = \"202506\"\nGROUP BY \n    b.city_level\nORDER BY \n    user_count DESC;\n", "status": "success", "result": [{"city_level": "1", "user_count": 4}, {"city_level": "2", "user_count": 2}, {"city_level": "4", "user_count": 1}, {"city_level": "3", "user_count": 1}]}
{"sql_id": "sql_10", "sql": "\nWITH season_dates AS (\n    SELECT \n        dtstatdate,\n        seasonidname,\n        idate AS season_start_date\n    FROM dim_argothek_seasondate_df\n    WHERE idate BETWEEN '20230712' AND '20250615'\n),\n\nbp_purchases AS (\n    SELECT \n        g.purchaseditemid,\n        s.seasonidname,\n        COUNT(DISTINCT g.subject) AS purchase_count\n    FROM dwd_argothek_commercialization_gearid_df g\n    JOIN season_dates s ON g.dtstatdate = s.dtstatdate\n    WHERE g.purchaseSource = 'BATTLEPASS_PROGRESS'\n      AND g.itemtype = 'd5f120f8-ff8c-4aac-92ea-f2b5acbe9475'\n      AND g.dtstatdate BETWEEN '20230712' AND '20250615'\n    GROUP BY g.purchaseditemid, s.seasonidname\n),\n\nskin_usage AS (\n    SELECT \n        e.expressionassetid AS item_id,\n        s.seasonidname,\n        COUNT(DISTINCT p.subject) AS usage_count\n    FROM dwd_argothek_playerloadout_hi p\n    JOIN dwd_argothek_playerloadout_expressions_hi e ON p.apeventid = e.apeventid\n    JOIN season_dates s ON p.dteventtime >= s.season_start_date \n                       AND p.dteventtime < DATE_ADD(s.season_start_date, INTERVAL 1 SEASON)\n    WHERE e.expressionassetid IS NOT NULL \n      AND e.expressiontypeid = 'd5f120f8-ff8c-4aac-92ea-f2b5acbe9475'\n      AND p.dteventtime BETWEEN '2023-07-12' AND '2025-06-15'\n    GROUP BY e.expressionassetid, s.seasonidname\n)\n\nSELECT \n    COALESCE(p.purchaseditemid, u.item_id) AS item_id,\n    COALESCE(p.seasonidname, u.seasonidname) AS season_name,\n    IFNULL(u.usage_count, 0) AS current_season_users,\n    IFNULL(p.purchase_count, 0) AS current_season_purchasers\nFROM bp_purchases p\nFULL OUTER JOIN skin_usage u ON p.purchaseditemid = u.item_id AND p.seasonidname = u.seasonidname\nORDER BY season_name, item_id;\n", "status": "success", "result": null}
{"sql_id": "sql_11", "sql": "\nselect\n    count(distinct a.iuserid) as active_players,\n    count(distinct case when b.iuserid is not null then a.iuserid end) as active_with_all_items_players\nfrom (\n    select distinct iuserid\n    from dws_argothek_oss_useractivity_df\n    where statis_date between date_sub('20250617', 29) and '20250617'\n      and iworldid = 255\n      and iactivity like '1%'\n) a\nleft join (\n    select iuserid\n    from dwd_argothek_gearrecord_df\n    where dtstatdate <= '20250617'\n      and igoodsid in (\n          '71d260ca-4bad-81f2-0298-44860341a7a6',\n          '48601754-442d-98cb-2109-3fb2075500ec',\n          'a9126263-439c-7be6-d668-52a6c0c0a36f',\n          '34ecc788-4034-71d2-a0ac-c398b8ecb2ae',\n          '56f98991-43f8-dcc8-189e-08b7ae6c42ad',\n          '8453f8ef-4c0b-46e2-8768-3e9e45c67a2c',\n          '06d90274-435f-3e32-9d57-26bc228ae2e5',\n          '8196dea4-4229-c951-13a9-088fb13b3512',\n          '3abc330f-444a-6dfd-5863-81856ba62624',\n          '041a43a4-46fe-dab7-c974-36bf91eab33d',\n          '5b863cb9-4e41-ec89-69ee-49a223d05ff1'\n      )\n    group by iuserid\n    having count(distinct igoodsid) = 11\n) b on a.iuserid = b.iuserid;\n", "status": "success", "result": [{"active_players": 0, "active_with_all_items_players": 0}]}
{"sql_id": "sql_13", "sql": "\nSELECT DISTINCT t1.swxid\nFROM dim_mgamejp_tbplayerid2wxid_nf t1\nJOIN (\n    SELECT iuserid\n    FROM dws_argothek_oss_login_di\n    WHERE statis_date BETWEEN '20230712' AND '20250612'\n    GROUP BY iuserid\n    HAVING COUNT(DISTINCT statis_date) >= 30\n) t2 ON t1.splayerid = t2.iuserid\nLEFT JOIN (\n    SELECT iuserid\n    FROM dws_argothek_oss_login_di\n    WHERE statis_date >= '20250312'\n    GROUP BY iuserid\n) t3 ON t2.iuserid = t3.iuserid\nLEFT JOIN (\n    SELECT iuserid, SUM(ftranamt)/100 AS total_payment\n    FROM dws_argothek_oss_portaltransaction_di\n    GROUP BY iuserid\n    HAVING SUM(ftranamt)/100 >= 1500\n) t4 ON t2.iuserid = t4.iuserid\nWHERE t3.iuserid IS NULL AND t4.iuserid IS NULL;\n", "status": "success", "result": []}
{"sql_id": "sql_14", "sql": "\nselect distinct a.suserid\nfrom (\n    select suserid\n    from dim_argothek_gplayerid2qqwxid_df\n    where dtstatdate = '20250531'\n    and substr(cbitmap, 1, 1) = '1'\n) a\nleft join (\n    select suserid\n    from dim_argothek_gplayerid2qqwxid_df\n    where dtstatdate = '20250610'\n    and substr(cbitmap, 1, 1) = '1'\n) b on a.suserid = b.suserid\nwhere b.suserid is null;\n", "status": "success", "result": []}
{"sql_id": "sql_15", "sql": "\nSELECT DISTINCT a.iuserid AS gplayerid\nFROM dim_argothek_gplayerid2qqwxid_df a\nJOIN dws_mgamejp_login_user_activity_di b ON a.iuserid = b.suserid\nWHERE a.dtstatdate = '20250531' \n  AND b.dtstatdate = '20250531'\n  AND b.sgamecode = 'initiatived' \n  AND b.splattype = 'PC'\n  AND INSTR(SUBSTR(REVERSE(RPAD(a.cbitmap,128,'0')),1,31),'1') = 0 \n  AND INSTR(SUBSTR(REVERSE(RPAD(a.cbitmap,128,'0')),32,31),'1') > 0;\n", "status": "success", "result": []}
{"sql_id": "sql_16", "sql": "\nwith match_stats as (\n    select \n        date_format(dteventtime, 'yyyyMMdd') as dt,\n        case\n            when competitiveTier in (3, 4, 5) then '黑铁'\n            when competitiveTier in (6, 7, 8) then '黄铜'\n            when competitiveTier in (9, 10, 11) then '白银'\n            when competitiveTier in (12, 13, 14) then '黄金'\n            when competitiveTier in (15, 16, 17) then '白金'\n            when competitiveTier in (18, 19, 20) then '钻石'\n            when competitiveTier in (21, 22, 23) then '超凡'\n            when competitiveTier >= 24 then '神话及以上'\n            else '无段位'\n        end as tier,\n        matchid,\n        completionstate,\n        max(roundswon) - min(roundswon) as roundsdiff\n    from dwd_argothek_playermatchstats_hi\n    where dteventtime between '2023-07-12' and '2025-05-31'\n      and queueid = 'competitive'\n    group by \n        date_format(dteventtime, 'yyyyMMdd'),\n        case\n            when competitiveTier in (3, 4, 5) then '黑铁'\n            when competitiveTier in (6, 7, 8) then '黄铜'\n            when competitiveTier in (9, 10, 11) then '白银'\n            when competitiveTier in (12, 13, 14) then '黄金'\n            when competitiveTier in (15, 16, 17) then '白金'\n            when competitiveTier in (18, 19, 20) then '钻石'\n            when competitiveTier in (21, 22, 23) then '超凡'\n            when competitiveTier >= 24 then '神话及以上'\n            else '无段位'\n        end,\n        matchid,\n        completionstate\n)\n\nselect \n    dt as '日期',\n    tier as '段位',\n    count(distinct case when completionstate != 'surrender' then matchid end) as '非投降局对局数',\n    count(distinct case when completionstate = 'surrender' then matchid end) as '投降局对局数',\n    count(distinct case when completionstate != 'surrender' and roundsdiff >= 6 then matchid end) as '非投降局回合差>=6',\n    count(distinct case when completionstate != 'surrender' and roundsdiff >= 8 then matchid end) as '非投降局回合差>=8'\nfrom match_stats\ngroup by dt, tier\n\nunion all\n\nselect \n    dt as '日期',\n    '全量段位' as '段位',\n    count(distinct case when completionstate != 'surrender' then matchid end) as '非投降局对局数',\n    count(distinct case when completionstate = 'surrender' then matchid end) as '投降局对局数',\n    count(distinct case when completionstate != 'surrender' and roundsdiff >= 6 then matchid end) as '非投降局回合差>=6',\n    count(distinct case when completionstate != 'surrender' and roundsdiff >= 8 then matchid end) as '非投降局回合差>=8'\nfrom match_stats\ngroup by dt\norder by dt, tier\n", "status": "success", "result": null}
{"sql_id": "sql_18", "sql": "\nselect\n    statis_date,\n    iloginway as channel,\n    count(distinct iuserid) as user_count\nfrom dws_argothek_oss_login_di\nwhere statis_date between '20250506' and '20250512'\n  and iloginway in (1,10,11,12,35,20,28,29,30,31,32,33,34,36)\ngroup by statis_date, iloginway\norder by statis_date, iloginway;\n", "status": "success", "result": [{"statis_date": 20250506, "channel": 1, "user_count": 2}, {"statis_date": 20250506, "channel": 10, "user_count": 1}, {"statis_date": 20250507, "channel": 11, "user_count": 1}, {"statis_date": 20250508, "channel": 12, "user_count": 1}, {"statis_date": 20250509, "channel": 35, "user_count": 1}, {"statis_date": 20250510, "channel": 20, "user_count": 1}, {"statis_date": 20250511, "channel": 28, "user_count": 1}]}
{"sql_id": "sql_19", "sql": "\nwith \n-- 获取2024-05-02的日活跃用户\ndaily_active_users as (\n    select distinct d.iuserid\n    from dws_argothek_oss_login_di d\n    where d.statis_date = 20240502\n    and d.ilogincount > 0\n),\n\n-- 获取这些用户在2024-05-02玩的模式\nuser_modes as (\n    select \n        g.iuserid,\n        p.queueid\n    from daily_active_users d\n    join dim_argothek_gplayerid_vroleid_df g on d.iuserid = g.iuserid\n    join dwd_argothek_playermatchstats_hi p on g.vroleid = p.vroleid\n    where p.dteventtime like '2024-05-02%'\n    group by g.iuserid, p.queueid\n),\n\n-- 统计每个用户玩的模式情况\nuser_mode_stats as (\n    select \n        iuserid,\n        count(distinct queueid) as mode_count,\n        max(case when queueid = 'QuickMatch' then 1 else 0 end) as has_quickmatch,\n        max(case when queueid = 'RushMode' then 1 else 0 end) as has_rushmode,\n        max(case when queueid = 'CombatArena' then 1 else 0 end) as has_combatarena,\n        max(case when queueid not in ('QuickMatch', 'RushMode', 'CombatArena') then 1 else 0 end) as has_other_mode\n    from user_modes\n    group by iuserid\n),\n\n-- 计算周活跃频次\nweekly_activity as (\n    select \n        g.iuserid,\n        count(distinct d.statis_date) as active_days\n    from daily_active_users a\n    join dim_argothek_gplayerid_vroleid_df g on a.iuserid = g.iuserid\n    join dws_argothek_oss_login_di d on g.iuserid = d.iuserid\n    where d.statis_date between 20250426 and 20250502\n    and d.ilogincount > 0\n    group by g.iuserid\n)\n\nselect\n    sum(case when mode_count = 1 and has_quickmatch = 1 then 1 else 0 end) as quickmatch_only_players,\n    sum(case when mode_count = 1 and has_rushmode = 1 then 1 else 0 end) as rushmode_only_players,\n    sum(case when mode_count = 1 and has_combatarena = 1 then 1 else 0 end) as combatarena_only_players,\n    sum(case when mode_count <= 3 and has_other_mode = 0 then 1 else 0 end) as three_modes_only_players,\n    avg(case when mode_count <= 3 and has_other_mode = 0 then w.active_days else null end) as three_modes_players_avg_active_days\nfrom user_mode_stats m\nleft join weekly_activity w on m.iuserid = w.iuserid;\n", "status": "success", "result": [{"quickmatch_only_players": null, "rushmode_only_players": null, "combatarena_only_players": null, "three_modes_only_players": null, "three_modes_players_avg_active_days": null}]}
{"sql_id": "sql_20", "sql": "\nWITH \n-- 网吧特权用户基础数据\nnetbar_users AS (\n    SELECT \n        substr(tdbank_imp_date, 1, 6) AS month,\n        iuserid,\n        sum(ionlinetime)/3600 AS total_online_hours,\n        count(DISTINCT substr(dteventtime, 1, 8)) AS active_days,\n        max(CASE WHEN inetbarlevel = 2 THEN 1 ELSE 0 END) AS is_netbar_user,\n        max(CASE WHEN icampuslevel > 0 THEN 1 ELSE 0 END) AS is_campus_user\n    FROM dwd_argothek_playerlogout_hi\n    WHERE tdbank_imp_date BETWEEN '20240101' AND '20240430'\n    GROUP BY substr(tdbank_imp_date, 1, 6), iuserid\n    HAVING is_netbar_user = 1\n),\n\n-- 排位模式数据\ncompetitive_stats AS (\n    SELECT \n        substr(tdbank_imp_date, 1, 6) AS month,\n        vroleid,\n        sum(gamelengthmillis)/3600000 AS competitive_hours,\n        count(DISTINCT CASE WHEN partyid IS NOT NULL THEN matchid END) AS party_matches,\n        count(DISTINCT matchid) AS total_matches\n    FROM dwd_argothek_playermatchstats_hi\n    WHERE tdbank_imp_date BETWEEN '20240101' AND '20240430'\n      AND queueid = 'competitive'\n    GROUP BY substr(tdbank_imp_date, 1, 6), vroleid\n),\n\n-- 付费数据\npayment_stats AS (\n    SELECT \n        substr(statis_date, 1, 6) AS month,\n        iuserid,\n        sum(ftranamt)/100 AS total_payment,\n        max(CASE WHEN ftranamt > 0 THEN 1 ELSE 0 END) AS is_payer\n    FROM dws_argothek_oss_portaltransaction_di\n    WHERE statis_date BETWEEN '20240101' AND '20240430'\n    GROUP BY substr(statis_date, 1, 6), iuserid\n)\n\n-- 最终结果\nSELECT \n    n.month,\n    -- 人均对局时长（小时）\n    avg(n.total_online_hours) AS avg_play_hours,\n    -- 网吧时间占当月游戏时间比例\n    sum(n.total_online_hours) / (SELECT sum(total_online_hours) FROM netbar_users WHERE month = n.month) AS netbar_time_ratio,\n    -- 有对局的天数\n    avg(n.active_days) AS avg_active_days,\n    -- 排位模式时长（小时）\n    avg(COALESCE(c.competitive_hours, 0)) AS avg_competitive_hours,\n    -- 排位模式组队率\n    CASE WHEN sum(c.total_matches) > 0 \n         THEN sum(c.party_matches)/sum(c.total_matches) \n         ELSE 0 END AS competitive_party_rate,\n    -- 月付费率\n    avg(COALESCE(p.is_payer, 0)) AS payment_rate,\n    -- 月ARPA\n    sum(COALESCE(p.total_payment, 0)) / count(DISTINCT n.iuserid) AS arpa,\n    -- 月ARPPA\n    sum(COALESCE(p.total_payment, 0)) / NULLIF(sum(COALESCE(p.is_payer, 0)), 0) AS arppu,\n    -- 高校特权激活率\n    avg(n.is_campus_user) AS campus_activation_rate\nFROM netbar_users n\nLEFT JOIN competitive_stats c ON n.month = c.month AND n.iuserid = c.vroleid\nLEFT JOIN payment_stats p ON n.month = p.month AND n.iuserid = p.iuserid\nGROUP BY n.month\nORDER BY n.month;\n", "status": "success", "result": null}
{"sql_id": "sql_22", "sql": "\nselect dim.suserid as QQ\nfrom (\n    select iuserid, count(distinct statis_date) as login_days\n    from dws_argothek_oss_login_di\n    where statis_date between '20250330' and '20250428'\n      and iloginway = 3\n    group by iuserid\n    having count(distinct statis_date) between 5 and 8\n    order by login_days desc\n    limit 1\n) login\njoin dim_argothek_gplayerid2qqwxid_df dim\non login.iuserid = dim.iuserid\nwhere dim.dtstatdate = '20250428'\n  and dim.swxid_type = 'qq';\n", "status": "success", "result": [{"QQ": "12345678"}]}
{"sql_id": "sql_23", "sql": "\nSELECT DISTINCT g.suserid AS qq\nFROM dim_argothek_gplayerid2qqwxid_df g\nJOIN dws_argothek_oss_login_di l ON g.iuserid = l.iuserid\nJOIN dim_argothek_gplayerid_vroleid_df r ON g.iuserid = r.iuserid\nJOIN dwd_argothek_playermatchstats_hi p ON r.vroleid = p.vroleid\nWHERE l.iloginway = 3\n  AND g.swxid_type = 'qq'\n  AND p.isplayercompleted = 1\n  AND p.dteventtime BETWEEN '2025-03-24' AND '2025-03-30'\n", "status": "success", "result": [{"qq": "1000000005"}, {"qq": "20000000000000000002"}, {"qq": "20000000000000000001"}, {"qq": "1000000006"}, {"qq": "20000000000000000009"}, {"qq": "1000000002"}, {"qq": "20000000000000000004"}, {"qq": "1000000004"}, {"qq": "1000000003"}, {"qq": "1000000008"}, {"qq": "20000000000000000003"}, {"qq": "20000000000000000006"}, {"qq": "20000000000000000005"}, {"qq": "1000000010"}, {"qq": "1000000001"}, {"qq": "20000000000000000008"}]}
{"sql_id": "sql_24", "sql": "\nwith hero_data as (\n    select 'e370fa57-4757-3604-3648-499e1f642d3f' as hero_id, '2023-07-26' as launch_date union all\n    select 'cc8b64c8-4b25-4ff9-6e7f-37b4da43d235', '2023-07-26' union all\n    select '0e38b510-41a8-5780-5e8f-568b2a4f2d6c', '2023-11-01' union all\n    select '1dbf2edd-4729-0984-3115-daa5eed44993', '2024-03-27' union all\n    select 'efba5359-4016-a1e5-7626-b1ae76895940', '2024-08-29' union all\n    select 'b444168c-4e35-8076-db47-ef9bf368f384', '2025-01-09' union all\n    select 'df1cb487-4902-002e-5c17-d28e83e78588', '2025-03-06'\n),\n\nplayer_hero_picks as (\n    select \n        h.hero_id,\n        p.subject as player_id,\n        count(*) as pick_count\n    from \n        dwd_argothek_playermatchdetail_hi p\n    join \n        hero_data h on p.characterid = h.hero_id\n    where \n        p.provisioningflowid = 'Matchmaking'\n        and p.dteventtime >= h.launch_date \n        and p.dteventtime <= date_add(h.launch_date, 6)\n    group by \n        h.hero_id, p.subject\n)\n\nselect \n    h.hero_id,\n    count(distinct case when p.pick_count > 3 then p.player_id end) as players_over_3_picks,\n    count(distinct case when p.pick_count > 10 then p.player_id end) as players_over_10_picks,\n    count(distinct p.player_id) as total_players,\n    round(count(distinct case when p.pick_count > 3 then p.player_id end) * 100.0 / \n          nullif(count(distinct p.player_id), 0), 2) as over_3_picks_percentage,\n    round(count(distinct case when p.pick_count > 10 then p.player_id end) * 100.0 / \n          nullif(count(distinct p.player_id), 0), 2) as over_10_picks_percentage\nfrom \n    hero_data h\nleft join \n    player_hero_picks p on h.hero_id = p.hero_id\ngroup by \n    h.hero_id\norder by \n    h.launch_date;\n", "status": "success", "result": null}
{"sql_id": "sql_26", "sql": "\nselect \n    sum(case when a.tag = 'EnemiesBlinded' then a.amount else 0 end) as enemies_blinded_count,\n    sum(case when a.tag = 'AlliesBlinded' then a.amount else 0 end) as allies_blinded_count\nfrom dwd_argothek_abilityinfo_effects_hi a\njoin dwd_argothek_matchdetails_hi b on a.matchinfomatchid = b.matchid\nwhere a.dteventtime between '2024-01-01' and '2024-12-16'\n  and b.provisioningflowid = 'Matchmaking'\n  and b.provisioningflowid not in ('custom', 'newbie', 'training');\n", "status": "success", "result": [{"enemies_blinded_count": 8, "allies_blinded_count": 4}]}
{"sql_id": "sql_27", "sql": "\nselect count(*) as weapon_purchase_count\nfrom dwd_argothek_apinventorymovementlog_hi\nwhere transactiontype = 'Purchase'\n  and matchinfogamemode not in ('Custom', 'New Player', 'Training')\n  and dteventtime between '2024-01-01' and '2024-12-16';\n", "status": "success", "result": [{"weapon_purchase_count": 1}]}
{"sql_id": "sql_28", "sql": "\nwith first_play as (\n    select '广域战场' as itype, min(dtstatdate) as first_date, vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= '20240723' and dtstatdate <= date_add('20240723',6)\n      and modename = '广域战场模式'\n    group by vplayerid\n    \n    union all\n    select '消灭战', min(dtstatdate), vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= '20230804' and dtstatdate <= date_add('20230804',6)\n      and modename = '组队竞技' and firstroundtime like '%消灭战模式%'\n    group by vplayerid\n    \n    union all\n    select '幻想混战', min(dtstatdate), vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= '20241115' and dtstatdate <= date_add('20241115',6)\n      and modename = '创意创作间' and firstroundtime like '%幻想混战%'\n    group by vplayerid\n    \n    union all\n    select '荒野传说', min(dtstatdate), vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= '20240903' and dtstatdate <= date_add('20240903',6)\n      and modename = '休闲模式' and firstroundtime like '%荒野传说%'\n    group by vplayerid\n    \n    union all\n    select '策略载具', min(dtstatdate), vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= '20241010' and dtstatdate <= date_add('20241010',6)\n      and modename = '休闲模式' and firstroundtime like '%策略载具%'\n    group by vplayerid\n    \n    union all\n    select '炎夏混战', min(dtstatdate), vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= '20240625' and dtstatdate <= date_add('20240625',6)\n      and modename = '创意创作间' and firstroundtime like '%炎夏混战%'\n    group by vplayerid\n    \n    union all\n    select '单人装备', min(dtstatdate), vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= '20240517' and dtstatdate <= date_add('20240517',6)\n      and modename = '组队竞技' and firstroundtime like '%单人装备%'\n    group by vplayerid\n    \n    union all\n    select '交叉堡垒', min(dtstatdate), vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= '20240412' and dtstatdate <= date_add('20240412',6)\n      and modename = '组队竞技' and firstroundtime like '%交叉堡垒%'\n    group by vplayerid\n),\n\nretention_data as (\n    select '广域战场' as itype, dtstatdate, vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= '20240723' and dtstatdate <= date_add('20240723',13)\n      and modename = '广域战场模式'\n    \n    union all\n    select '消灭战', dtstatdate, vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= '20230804' and dtstatdate <= date_add('20230804',13)\n      and modename = '组队竞技' and firstroundtime like '%消灭战模式%'\n    \n    union all\n    select '幻想混战', dtstatdate, vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= '20241115' and dtstatdate <= date_add('20241115',13)\n      and modename = '创意创作间' and firstroundtime like '%幻想混战%'\n    \n    union all\n    select '荒野传说', dtstatdate, vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= '20240903' and dtstatdate <= date_add('20240903',13)\n      and modename = '休闲模式' and firstroundtime like '%荒野传说%'\n    \n    union all\n    select '策略载具', dtstatdate, vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= '20241010' and dtstatdate <= date_add('20241010',13)\n      and modename = '休闲模式' and firstroundtime like '%策略载具%'\n    \n    union all\n    select '炎夏混战', dtstatdate, vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= '20240625' and dtstatdate <= date_add('20240625',13)\n      and modename = '创意创作间' and firstroundtime like '%炎夏混战%'\n    \n    union all\n    select '单人装备', dtstatdate, vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= '20240517' and dtstatdate <= date_add('20240517',13)\n      and modename = '组队竞技' and firstroundtime like '%单人装备%'\n    \n    union all\n    select '交叉堡垒', dtstatdate, vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= '20240412' and dtstatdate <= date_add('20240412',13)\n      and modename = '组队竞技' and firstroundtime like '%交叉堡垒%'\n)\n\nselect \n    a.itype as 玩法,\n    a.first_date as 上线首周首次玩的日期,\n    datediff(b.dtstatdate, a.first_date) as 第几天留存,\n    count(distinct a.vplayerid) as 玩法留存用户数\nfrom \n    first_play a\njoin \n    retention_data b on a.itype = b.itype and a.vplayerid = b.vplayerid\nwhere \n    datediff(b.dtstatdate, a.first_date) between 0 and 7\ngroup by \n    a.itype, a.first_date, datediff(b.dtstatdate, a.first_date)\norder by \n    a.itype, datediff(b.dtstatdate, a.first_date);\n", "status": "success", "result": [{"玩法": "广域战场", "上线首周首次玩的日期": "20240726", "第几天留存": 0, "玩法留存用户数": 1}, {"玩法": "广域战场", "上线首周首次玩的日期": "20240723", "第几天留存": 0, "玩法留存用户数": 2}, {"玩法": "广域战场", "上线首周首次玩的日期": "20240727", "第几天留存": 0, "玩法留存用户数": 1}, {"玩法": "广域战场", "上线首周首次玩的日期": "20240724", "第几天留存": 0, "玩法留存用户数": 1}, {"玩法": "广域战场", "上线首周首次玩的日期": "20240728", "第几天留存": 0, "玩法留存用户数": 1}, {"玩法": "广域战场", "上线首周首次玩的日期": "20240725", "第几天留存": 0, "玩法留存用户数": 1}, {"玩法": "广域战场", "上线首周首次玩的日期": "20240729", "第几天留存": 0, "玩法留存用户数": 1}, {"玩法": "广域战场", "上线首周首次玩的日期": "20240724", "第几天留存": 1, "玩法留存用户数": 1}, {"玩法": "广域战场", "上线首周首次玩的日期": "20240729", "第几天留存": 1, "玩法留存用户数": 1}, {"玩法": "广域战场", "上线首周首次玩的日期": "20240723", "第几天留存": 1, "玩法留存用户数": 2}, {"玩法": "广域战场", "上线首周首次玩的日期": "20240724", "第几天留存": 2, "玩法留存用户数": 1}, {"玩法": "广域战场", "上线首周首次玩的日期": "20240729", "第几天留存": 2, "玩法留存用户数": 1}, {"玩法": "广域战场", "上线首周首次玩的日期": "20240723", "第几天留存": 2, "玩法留存用户数": 1}, {"玩法": "广域战场", "上线首周首次玩的日期": "20240724", "第几天留存": 3, "玩法留存用户数": 1}, {"玩法": "广域战场", "上线首周首次玩的日期": "20240723", "第几天留存": 3, "玩法留存用户数": 1}, {"玩法": "广域战场", "上线首周首次玩的日期": "20240729", "第几天留存": 3, "玩法留存用户数": 1}, {"玩法": "广域战场", "上线首周首次玩的日期": "20240729", "第几天留存": 4, "玩法留存用户数": 1}, {"玩法": "广域战场", "上线首周首次玩的日期": "20240724", "第几天留存": 4, "玩法留存用户数": 1}, {"玩法": "广域战场", "上线首周首次玩的日期": "20240723", "第几天留存": 4, "玩法留存用户数": 1}, {"玩法": "广域战场", "上线首周首次玩的日期": "20240723", "第几天留存": 5, "玩法留存用户数": 1}, {"玩法": "广域战场", "上线首周首次玩的日期": "20240724", "第几天留存": 5, "玩法留存用户数": 1}, {"玩法": "广域战场", "上线首周首次玩的日期": "20240729", "第几天留存": 5, "玩法留存用户数": 1}, {"玩法": "广域战场", "上线首周首次玩的日期": "20240724", "第几天留存": 6, "玩法留存用户数": 1}, {"玩法": "广域战场", "上线首周首次玩的日期": "20240723", "第几天留存": 6, "玩法留存用户数": 1}, {"玩法": "广域战场", "上线首周首次玩的日期": "20240729", "第几天留存": 6, "玩法留存用户数": 1}, {"玩法": "广域战场", "上线首周首次玩的日期": "20240723", "第几天留存": 7, "玩法留存用户数": 2}, {"玩法": "广域战场", "上线首周首次玩的日期": "20240724", "第几天留存": 7, "玩法留存用户数": 1}, {"玩法": "广域战场", "上线首周首次玩的日期": "20240729", "第几天留存": 7, "玩法留存用户数": 1}]}
{"sql_id": "sql_29", "sql": "\nwith daily_stats as (\n    select \n        dtstatdate,\n        case\n            when modename = '传统模式' and submodename like 'CG%' and mapname = '群屿' then '主题群屿'\n            when modename = '传统模式' and mapname = '群屿' then '传统群屿'\n            when modename = '传统模式' and mapname = '假日群岛' then '假日群岛'\n            when modename = '传统模式' and mapname = '荣耀之城' then '荣耀之城'\n            when submodename = '广域战场模式' then '广域战场'\n            when submodename = '极能形态模式' then '极能形态'\n            when modename = '组队竞技' then '组竞'\n            when modename = '休闲模式' then '休闲'\n            when modename = '乐园' then '乐园'\n            when modename = '领地' then '领地'\n            when modename = '广阔天地' then '广阔天地'\n            when modename = '生存模式' then '隧道'\n            else '其他模式'\n        end as play_mode,\n        count(distinct m.vplayerid) as daily_players,\n        sum(roundcnt) as daily_rounds\n    from dws_jordass_mode_roundrecord_di m\n    where dtstatdate between '20240618' and '20250330'\n    group by dtstatdate,\n        case\n            when modename = '传统模式' and submodename like 'CG%' and mapname = '群屿' then '主题群屿'\n            when modename = '传统模式' and mapname = '群屿' then '传统群屿'\n            when modename = '传统模式' and mapname = '假日群岛' then '假日群岛'\n            when modename = '传统模式' and mapname = '荣耀之城' then '荣耀之城'\n            when submodename = '广域战场模式' then '广域战场'\n            when submodename = '极能形态模式' then '极能形态'\n            when modename = '组队竞技' then '组竞'\n            when modename = '休闲模式' then '休闲'\n            when modename = '乐园' then '乐园'\n            when modename = '领地' then '领地'\n            when modename = '广阔天地' then '广阔天地'\n            when modename = '生存模式' then '隧道'\n            else '其他模式'\n        end\n),\n\ndaily_active as (\n    select \n        dtstatdate,\n        count(distinct vplayerid) as daily_active_users\n    from dws_jordass_login_di\n    where dtstatdate between '20240618' and '20250330'\n    group by dtstatdate\n),\n\nweekly_stats as (\n    select \n        date_format(date_sub(to_date(dtstatdate, 'yyyyMMdd'), dayofweek(to_date(dtstatdate, 'yyyyMMdd'))-2), 'yyyyMMdd') as week_start,\n        play_mode,\n        avg(daily_players) as avg_daily_players,\n        avg(daily_players / nullif(d.daily_active_users, 0)) as avg_daily_participation_rate,\n        avg(daily_rounds) as avg_daily_rounds\n    from daily_stats s\n    join daily_active d on s.dtstatdate = d.dtstatdate\n    group by \n        date_format(date_sub(to_date(dtstatdate, 'yyyyMMdd'), dayofweek(to_date(dtstatdate, 'yyyyMMdd'))-2), 'yyyyMMdd'),\n        play_mode\n)\n\nselect \n    week_start,\n    play_mode,\n    avg_daily_players,\n    avg_daily_participation_rate,\n    avg_daily_rounds\nfrom weekly_stats\norder by week_start, play_mode;\n", "status": "success", "result": null}
{"sql_id": "sql_30", "sql": "\nwith main_user as (\n    select substr(dtstatdate, 1, 6) mons,\n        case\n            when modename = '传统模式' and submodename like 'CG%' and mapname = '群屿' then '主题群屿'\n            when modename = '传统模式' and mapname = '群屿' then '传统群屿'\n            when modename = '传统模式' and mapname = '假日群岛' then '假日群岛'\n            when modename = '传统模式' and mapname = '荣耀之城' then '荣耀之城'\n            when submodename = '广域战场模式' then '广域战场'\n            when submodename = '极能形态模式' then '极能形态'\n            when modename = '组队竞技' then '组竞'\n            when modename = '休闲模式' then '休闲'\n            when modename = '乐园' then '乐园'\n            when modename = '领地' then '领地'\n            when modename = '广阔天地' then '广阔天地'\n            else '其他模式'\n        end imodename,\n        vplayerid,\n        sum(roundtime) / 60 roundtime,\n        sum(roundcnt) roundcnt\n   from dws_jordass_mode_roundrecord_di\n   where dtstatdate between '20190508' and '20250330'\n   group by vplayerid, substr(dtstatdate, 1, 6),\n        case\n            when modename = '传统模式' and submodename like 'CG%' and mapname = '群屿' then '主题群屿'\n            when modename = '传统模式' and mapname = '群屿' then '传统群屿'\n            when modename = '传统模式' and mapname = '假日群岛' then '假日群岛'\n            when modename = '传统模式' and mapname = '荣耀之城' then '荣耀之城'\n            when submodename = '广域战场模式' then '广域战场'\n            when submodename = '极能形态模式' then '极能形态'\n            when modename = '组队竞技' then '组竞'\n            when modename = '休闲模式' then '休闲'\n            when modename = '乐园' then '乐园'\n            when modename = '领地' then '领地'\n            when modename = '广阔天地' then '广阔天地'\n            else '其他模式'\n        end\n)\n\nselect a.mons,\n       a.imodename,\n       a.iusernum,\n       b.iusernumall\nfrom (\n    select mons,\n          imodename,\n          count(vplayerid) iusernum\n    from (\n        select mons, vplayerid, imodename\n        from (\n            select mons,\n                vplayerid,\n                imodename,\n                roundtime,\n                row_number() over (partition by mons, vplayerid order by roundtime desc) as rn\n            from main_user\n        )ff1\n        where rn = 1\n    )f1\n   group by mons, imodename\n) a\nleft join (\n    select mons,\n        imodename,\n        count(vplayerid) iusernumall\n   from main_user\n   group by mons, imodename\n) b \non a.imodename = b.imodename and a.mons = b.mons\norder by a.mons, a.imodename\n;\n", "status": "success", "result": [{"mons": "201905", "imodename": "主题群屿", "iusernum": 119, "iusernumall": 119}, {"mons": "201905", "imodename": "乐园", "iusernum": 2, "iusernumall": 2}, {"mons": "201905", "imodename": "传统群屿", "iusernum": 4, "iusernumall": 4}, {"mons": "201905", "imodename": "假日群岛", "iusernum": 1, "iusernumall": 1}, {"mons": "201905", "imodename": "其他模式", "iusernum": 2, "iusernumall": 2}, {"mons": "201905", "imodename": "广阔天地", "iusernum": 2, "iusernumall": 2}, {"mons": "201905", "imodename": "组竞", "iusernum": 1, "iusernumall": 1}, {"mons": "201905", "imodename": "荣耀之城", "iusernum": 1, "iusernumall": 1}, {"mons": "201905", "imodename": "领地", "iusernum": 2, "iusernumall": 2}, {"mons": "201906", "imodename": "传统群屿", "iusernum": 1, "iusernumall": 1}, {"mons": "201908", "imodename": "假日群岛", "iusernum": 1, "iusernumall": 1}, {"mons": "201909", "imodename": "荣耀之城", "iusernum": 1, "iusernumall": 1}, {"mons": "201910", "imodename": "广域战场", "iusernum": 1, "iusernumall": 1}, {"mons": "201911", "imodename": "极能形态", "iusernum": 1, "iusernumall": 1}, {"mons": "201912", "imodename": "组竞", "iusernum": 1, "iusernumall": 1}, {"mons": "202001", "imodename": "主题群屿", "iusernum": 1, "iusernumall": 1}, {"mons": "202001", "imodename": "乐园", "iusernum": 2, "iusernumall": 2}, {"mons": "202001", "imodename": "传统群屿", "iusernum": 3, "iusernumall": 3}, {"mons": "202001", "imodename": "假日群岛", "iusernum": 2, "iusernumall": 2}, {"mons": "202001", "imodename": "其他模式", "iusernum": 2, "iusernumall": 2}, {"mons": "202001", "imodename": "广阔天地", "iusernum": 2, "iusernumall": 2}, {"mons": "202001", "imodename": "组竞", "iusernum": 2, "iusernumall": 2}, {"mons": "202001", "imodename": "荣耀之城", "iusernum": 1, "iusernumall": 1}, {"mons": "202001", "imodename": "领地", "iusernum": 2, "iusernumall": 2}, {"mons": "202002", "imodename": "领地", "iusernum": 1, "iusernumall": 1}, {"mons": "202004", "imodename": "其他模式", "iusernum": 1, "iusernumall": 1}, {"mons": "202006", "imodename": "假日群岛", "iusernum": 1, "iusernumall": 1}, {"mons": "202007", "imodename": "荣耀之城", "iusernum": 1, "iusernumall": 1}, {"mons": "202008", "imodename": "广域战场", "iusernum": 1, "iusernumall": 1}, {"mons": "202009", "imodename": "极能形态", "iusernum": 1, "iusernumall": 1}, {"mons": "202010", "imodename": "组竞", "iusernum": 1, "iusernumall": 1}, {"mons": "202011", "imodename": "乐园", "iusernum": 1, "iusernumall": 1}, {"mons": "202012", "imodename": "领地", "iusernum": 1, "iusernumall": 1}, {"mons": "202101", "imodename": "广阔天地", "iusernum": 1, "iusernumall": 1}, {"mons": "202102", "imodename": "其他模式", "iusernum": 1, "iusernumall": 1}, {"mons": "202103", "imodename": "传统群屿", "iusernum": 1, "iusernumall": 1}, {"mons": "202104", "imodename": "假日群岛", "iusernum": 1, "iusernumall": 1}, {"mons": "202105", "imodename": "荣耀之城", "iusernum": 1, "iusernumall": 1}, {"mons": "202106", "imodename": "乐园", "iusernum": 1, "iusernumall": 1}, {"mons": "202106", "imodename": "传统群屿", "iusernum": 1, "iusernumall": 1}, {"mons": "202106", "imodename": "假日群岛", "iusernum": 1, "iusernumall": 1}, {"mons": "202106", "imodename": "其他模式", "iusernum": 1, "iusernumall": 1}, {"mons": "202106", "imodename": "广阔天地", "iusernum": 1, "iusernumall": 1}, {"mons": "202106", "imodename": "荣耀之城", "iusernum": 1, "iusernumall": 1}, {"mons": "202209", "imodename": "极能形态", "iusernum": 2, "iusernumall": 2}, {"mons": "202212", "imodename": "主题群屿", "iusernum": 2, "iusernumall": 2}, {"mons": "202301", "imodename": "主题群屿", "iusernum": 32, "iusernumall": 34}, {"mons": "202301", "imodename": "其他模式", "iusernum": 10, "iusernumall": 15}, {"mons": "202301", "imodename": "组竞", "iusernum": 5, "iusernumall": 7}, {"mons": "202304", "imodename": "乐园", "iusernum": 4, "iusernumall": 4}, {"mons": "202305", "imodename": "乐园", "iusernum": 4, "iusernumall": 5}, {"mons": "202305", "imodename": "其他模式", "iusernum": 1, "iusernumall": 1}, {"mons": "202306", "imodename": "乐园", "iusernum": 19, "iusernumall": 23}, {"mons": "202306", "imodename": "休闲", "iusernum": 3, "iusernumall": 3}, {"mons": "202306", "imodename": "传统群屿", "iusernum": 1, "iusernumall": 6}, {"mons": "202307", "imodename": "乐园", "iusernum": 1, "iusernumall": 6}, {"mons": "202307", "imodename": "休闲", "iusernum": 3, "iusernumall": 5}, {"mons": "202307", "imodename": "假日群岛", "iusernum": 5, "iusernumall": 6}, {"mons": "202307", "imodename": "其他模式", "iusernum": 14, "iusernumall": 18}, {"mons": "202307", "imodename": "广阔天地", "iusernum": 4, "iusernumall": 6}, {"mons": "202307", "imodename": "极能形态", "iusernum": 1, "iusernumall": 4}, {"mons": "202307", "imodename": "组竞", "iusernum": 9, "iusernumall": 15}, {"mons": "202308", "imodename": "主题群屿", "iusernum": 1, "iusernumall": 2}, {"mons": "202308", "imodename": "乐园", "iusernum": 2, "iusernumall": 5}, {"mons": "202308", "imodename": "休闲", "iusernum": 3, "iusernumall": 9}, {"mons": "202308", "imodename": "假日群岛", "iusernum": 6, "iusernumall": 11}, {"mons": "202308", "imodename": "其他模式", "iusernum": 9, "iusernumall": 12}, {"mons": "202308", "imodename": "广阔天地", "iusernum": 3, "iusernumall": 7}, {"mons": "202308", "imodename": "极能形态", "iusernum": 12, "iusernumall": 13}, {"mons": "202308", "imodename": "组竞", "iusernum": 315, "iusernumall": 325}, {"mons": "202401", "imodename": "主题群屿", "iusernum": 1, "iusernumall": 1}, {"mons": "202401", "imodename": "其他模式", "iusernum": 1, "iusernumall": 1}, {"mons": "202402", "imodename": "主题群屿", "iusernum": 24, "iusernumall": 27}, {"mons": "202402", "imodename": "其他模式", "iusernum": 6, "iusernumall": 9}, {"mons": "202402", "imodename": "组竞", "iusernum": 10, "iusernumall": 13}, {"mons": "202403", "imodename": "主题群屿", "iusernum": 41, "iusernumall": 83}, {"mons": "202403", "imodename": "传统群屿", "iusernum": 22, "iusernumall": 34}, {"mons": "202403", "imodename": "假日群岛", "iusernum": 38, "iusernumall": 78}, {"mons": "202403", "imodename": "其他模式", "iusernum": 14, "iusernumall": 38}, {"mons": "202403", "imodename": "极能形态", "iusernum": 40, "iusernumall": 60}, {"mons": "202404", "imodename": "主题群屿", "iusernum": 60, "iusernumall": 94}, {"mons": "202404", "imodename": "乐园", "iusernum": 7, "iusernumall": 15}, {"mons": "202404", "imodename": "休闲", "iusernum": 1, "iusernumall": 3}, {"mons": "202404", "imodename": "传统群屿", "iusernum": 35, "iusernumall": 42}, {"mons": "202404", "imodename": "假日群岛", "iusernum": 68, "iusernumall": 129}, {"mons": "202404", "imodename": "其他模式", "iusernum": 39, "iusernumall": 82}, {"mons": "202404", "imodename": "广阔天地", "iusernum": 3, "iusernumall": 5}, {"mons": "202404", "imodename": "极能形态", "iusernum": 86, "iusernumall": 119}, {"mons": "202404", "imodename": "组竞", "iusernum": 308, "iusernumall": 338}, {"mons": "202404", "imodename": "领地", "iusernum": 4, "iusernumall": 6}, {"mons": "202405", "imodename": "主题群屿", "iusernum": 35, "iusernumall": 56}, {"mons": "202405", "imodename": "乐园", "iusernum": 4, "iusernumall": 6}, {"mons": "202405", "imodename": "休闲", "iusernum": 5, "iusernumall": 7}, {"mons": "202405", "imodename": "传统群屿", "iusernum": 17, "iusernumall": 22}, {"mons": "202405", "imodename": "假日群岛", "iusernum": 35, "iusernumall": 62}, {"mons": "202405", "imodename": "其他模式", "iusernum": 17, "iusernumall": 34}, {"mons": "202405", "imodename": "极能形态", "iusernum": 40, "iusernumall": 59}, {"mons": "202405", "imodename": "组竞", "iusernum": 255, "iusernumall": 265}, {"mons": "202405", "imodename": "领地", "iusernum": 3, "iusernumall": 8}, {"mons": "202406", "imodename": "主题群屿", "iusernum": 58, "iusernumall": 108}, {"mons": "202406", "imodename": "乐园", "iusernum": 5, "iusernumall": 10}, {"mons": "202406", "imodename": "传统群屿", "iusernum": 35, "iusernumall": 56}, {"mons": "202406", "imodename": "假日群岛", "iusernum": 50, "iusernumall": 120}, {"mons": "202406", "imodename": "其他模式", "iusernum": 259, "iusernumall": 315}, {"mons": "202406", "imodename": "极能形态", "iusernum": 91, "iusernumall": 122}, {"mons": "202406", "imodename": "组竞", "iusernum": 22, "iusernumall": 38}, {"mons": "202406", "imodename": "领地", "iusernum": 1, "iusernumall": 3}, {"mons": "202407", "imodename": "主题群屿", "iusernum": 4, "iusernumall": 7}, {"mons": "202407", "imodename": "乐园", "iusernum": 8, "iusernumall": 11}, {"mons": "202407", "imodename": "休闲", "iusernum": 1, "iusernumall": 2}, {"mons": "202407", "imodename": "传统群屿", "iusernum": 2, "iusernumall": 2}, {"mons": "202407", "imodename": "假日群岛", "iusernum": 9, "iusernumall": 15}, {"mons": "202407", "imodename": "其他模式", "iusernum": 35, "iusernumall": 49}, {"mons": "202407", "imodename": "广域战场", "iusernum": 290, "iusernumall": 294}, {"mons": "202407", "imodename": "极能形态", "iusernum": 8, "iusernumall": 16}, {"mons": "202407", "imodename": "组竞", "iusernum": 20, "iusernumall": 36}, {"mons": "202408", "imodename": "主题群屿", "iusernum": 1, "iusernumall": 1}, {"mons": "202408", "imodename": "乐园", "iusernum": 5, "iusernumall": 7}, {"mons": "202408", "imodename": "休闲", "iusernum": 1, "iusernumall": 1}, {"mons": "202408", "imodename": "假日群岛", "iusernum": 5, "iusernumall": 8}, {"mons": "202408", "imodename": "其他模式", "iusernum": 33, "iusernumall": 41}, {"mons": "202408", "imodename": "广域战场", "iusernum": 5, "iusernumall": 8}, {"mons": "202408", "imodename": "广阔天地", "iusernum": 1, "iusernumall": 2}, {"mons": "202408", "imodename": "极能形态", "iusernum": 7, "iusernumall": 12}, {"mons": "202408", "imodename": "组竞", "iusernum": 15, "iusernumall": 21}, {"mons": "202409", "imodename": "主题群屿", "iusernum": 14, "iusernumall": 17}, {"mons": "202409", "imodename": "乐园", "iusernum": 4, "iusernumall": 7}, {"mons": "202409", "imodename": "休闲", "iusernum": 227, "iusernumall": 230}, {"mons": "202409", "imodename": "传统群屿", "iusernum": 2, "iusernumall": 2}, {"mons": "202409", "imodename": "假日群岛", "iusernum": 12, "iusernumall": 14}, {"mons": "202409", "imodename": "其他模式", "iusernum": 41, "iusernumall": 46}, {"mons": "202409", "imodename": "极能形态", "iusernum": 3, "iusernumall": 6}, {"mons": "202409", "imodename": "组竞", "iusernum": 6, "iusernumall": 13}, {"mons": "202410", "imodename": "主题群屿", "iusernum": 6, "iusernumall": 10}, {"mons": "202410", "imodename": "乐园", "iusernum": 9, "iusernumall": 20}, {"mons": "202410", "imodename": "休闲", "iusernum": 179, "iusernumall": 185}, {"mons": "202410", "imodename": "传统群屿", "iusernum": 1, "iusernumall": 1}, {"mons": "202410", "imodename": "假日群岛", "iusernum": 3, "iusernumall": 11}, {"mons": "202410", "imodename": "其他模式", "iusernum": 24, "iusernumall": 41}, {"mons": "202410", "imodename": "广域战场", "iusernum": 2, "iusernumall": 4}, {"mons": "202410", "imodename": "广阔天地", "iusernum": 1, "iusernumall": 3}, {"mons": "202410", "imodename": "极能形态", "iusernum": 6, "iusernumall": 15}, {"mons": "202410", "imodename": "组竞", "iusernum": 8, "iusernumall": 21}, {"mons": "202410", "imodename": "领地", "iusernum": 3, "iusernumall": 10}, {"mons": "202411", "imodename": "主题群屿", "iusernum": 8, "iusernumall": 14}, {"mons": "202411", "imodename": "乐园", "iusernum": 11, "iusernumall": 16}, {"mons": "202411", "imodename": "传统群屿", "iusernum": 1, "iusernumall": 2}, {"mons": "202411", "imodename": "假日群岛", "iusernum": 9, "iusernumall": 19}, {"mons": "202411", "imodename": "其他模式", "iusernum": 312, "iusernumall": 333}, {"mons": "202411", "imodename": "广域战场", "iusernum": 4, "iusernumall": 7}, {"mons": "202411", "imodename": "极能形态", "iusernum": 4, "iusernumall": 11}, {"mons": "202411", "imodename": "组竞", "iusernum": 12, "iusernumall": 27}, {"mons": "202411", "imodename": "领地", "iusernum": 1, "iusernumall": 4}, {"mons": "202501", "imodename": "主题群屿", "iusernum": 19, "iusernumall": 24}, {"mons": "202501", "imodename": "其他模式", "iusernum": 11, "iusernumall": 12}, {"mons": "202501", "imodename": "组竞", "iusernum": 7, "iusernumall": 8}, {"mons": "202502", "imodename": "主题群屿", "iusernum": 10, "iusernumall": 20}, {"mons": "202502", "imodename": "乐园", "iusernum": 2, "iusernumall": 5}, {"mons": "202502", "imodename": "休闲", "iusernum": 5, "iusernumall": 9}, {"mons": "202502", "imodename": "其他模式", "iusernum": 8, "iusernumall": 16}, {"mons": "202502", "imodename": "广阔天地", "iusernum": 4, "iusernumall": 8}, {"mons": "202502", "imodename": "组竞", "iusernum": 3, "iusernumall": 7}, {"mons": "202502", "imodename": "领地", "iusernum": 6, "iusernumall": 11}, {"mons": "202503", "imodename": "主题群屿", "iusernum": 27, "iusernumall": 30}, {"mons": "202503", "imodename": "乐园", "iusernum": 1, "iusernumall": 4}, {"mons": "202503", "imodename": "休闲", "iusernum": 3, "iusernumall": 9}, {"mons": "202503", "imodename": "传统群屿", "iusernum": 1, "iusernumall": 2}, {"mons": "202503", "imodename": "其他模式", "iusernum": 3, "iusernumall": 10}, {"mons": "202503", "imodename": "广阔天地", "iusernum": 3, "iusernumall": 10}, {"mons": "202503", "imodename": "组竞", "iusernum": 1, "iusernumall": 4}, {"mons": "202503", "imodename": "领地", "iusernum": 4, "iusernumall": 10}]}
{"sql_id": "sql_31", "sql": "\nwith collaboration_platform_active as (\n    select distinct vplayerid\n    from dwd_jordass_buttonpress_pre_di\n    where dtstatdate between '20250217' and '20250318'\n    and buttontype = 'ugcmbuttonclick'\n),\ncollaboration_gameplay_active as (\n    select distinct vplayerid\n    from dws_jordass_matchlog_stat_di\n    where dtstatdate between '20250217' and '20250318'\n    and vtemp1 = '协作'\n),\ntarget_users as (\n    select a.vplayerid\n    from collaboration_platform_active a\n    left join collaboration_gameplay_active b on a.vplayerid = b.vplayerid\n    where b.vplayerid is null\n),\nuser_main_gameplay as (\n    select \n        vplayerid,\n        modename,\n        sum(roundtime) as total_time\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate between '20250217' and '20250318'\n    and modename in ('传统模式','休闲模式','组队竞技','领地','乐园','广阔天地','创意创作间','生存模式')\n    group by vplayerid, modename\n),\nuser_main_gameplay_ranked as (\n    select \n        vplayerid,\n        modename,\n        row_number() over (partition by vplayerid order by total_time desc) as rn\n    from user_main_gameplay\n)\n\nselect \n    modename as '主玩玩法',\n    count(distinct t.vplayerid) as '人数'\nfrom target_users t\njoin user_main_gameplay_ranked g on t.vplayerid = g.vplayerid and g.rn = 1\ngroup by modename\norder by count(distinct t.vplayerid) desc;\n", "status": "success", "result": []}
{"sql_id": "sql_32", "sql": "\nselect \n    dtstatdate,\n    count(distinct vplayerid) as participant_count,\n    sum(roundtime)/60 as total_duration_minutes\nfrom dws_jordass_mode_roundrecord_di\nwhere \n    (dtstatdate between '20230114' and '20230128') or\n    (dtstatdate between '20240202' and '20240216') or\n    (dtstatdate between '20250121' and '20250204')\ngroup by dtstatdate\norder by dtstatdate;\n", "status": "success", "result": [{"dtstatdate": "20230114", "participant_count": 4, "total_duration_minutes": 150}, {"dtstatdate": "20230116", "participant_count": 5, "total_duration_minutes": 210}, {"dtstatdate": "20230117", "participant_count": 5, "total_duration_minutes": 203.33}, {"dtstatdate": "20230118", "participant_count": 4, "total_duration_minutes": 160}, {"dtstatdate": "20230119", "participant_count": 1, "total_duration_minutes": 25}, {"dtstatdate": "20230120", "participant_count": 5, "total_duration_minutes": 195}, {"dtstatdate": "20230122", "participant_count": 4, "total_duration_minutes": 160}, {"dtstatdate": "20230124", "participant_count": 5, "total_duration_minutes": 205}, {"dtstatdate": "20230125", "participant_count": 5, "total_duration_minutes": 190}, {"dtstatdate": "20230126", "participant_count": 1, "total_duration_minutes": 30}, {"dtstatdate": "20230128", "participant_count": 5, "total_duration_minutes": 205}, {"dtstatdate": "20240202", "participant_count": 4, "total_duration_minutes": 150}, {"dtstatdate": "20240204", "participant_count": 4, "total_duration_minutes": 250}, {"dtstatdate": "20240205", "participant_count": 4, "total_duration_minutes": 170}, {"dtstatdate": "20240206", "participant_count": 1, "total_duration_minutes": 50}, {"dtstatdate": "20240208", "participant_count": 5, "total_duration_minutes": 255}, {"dtstatdate": "20240209", "participant_count": 5, "total_duration_minutes": 220}, {"dtstatdate": "20240210", "participant_count": 5, "total_duration_minutes": 175}, {"dtstatdate": "20240211", "participant_count": 5, "total_duration_minutes": 205}, {"dtstatdate": "20240212", "participant_count": 1, "total_duration_minutes": 30}, {"dtstatdate": "20240213", "participant_count": 1, "total_duration_minutes": 40}, {"dtstatdate": "20240214", "participant_count": 4, "total_duration_minutes": 180}, {"dtstatdate": "20250121", "participant_count": 4, "total_duration_minutes": 150}, {"dtstatdate": "20250122", "participant_count": 5, "total_duration_minutes": 170}, {"dtstatdate": "20250124", "participant_count": 1, "total_duration_minutes": 30}, {"dtstatdate": "20250126", "participant_count": 4, "total_duration_minutes": 150}, {"dtstatdate": "20250127", "participant_count": 7, "total_duration_minutes": 257.5}, {"dtstatdate": "20250128", "participant_count": 5, "total_duration_minutes": 260}, {"dtstatdate": "20250129", "participant_count": 4, "total_duration_minutes": 160}, {"dtstatdate": "20250131", "participant_count": 1, "total_duration_minutes": 30}, {"dtstatdate": "20250201", "participant_count": 5, "total_duration_minutes": 240}, {"dtstatdate": "20250204", "participant_count": 1, "total_duration_minutes": 45}]}
{"sql_id": "sql_33", "sql": "\nselect\n    count(distinct a.vplayerid) as total_players,\n    count(distinct case when b.vplayerid is not null then a.vplayerid end) as existing_players,\n    count(distinct case when b.vplayerid is null then a.vplayerid end) as new_players\nfrom (\n    select vplayerid\n    from dws_jordass_matchlog_stat_di\n    where dtstatdate between '20241214' and '20241220'\n    and imode = 1344338933661592832\n    and platid = 255\n    group by vplayerid\n) a\nleft join (\n    select vplayerid\n    from dws_jordass_playermatchrecord_stat_df\n    where dtstatdate <= '20241213'\n    and imode = 1344338933661592832\n    and platid = 255\n    group by vplayerid\n) b\non a.vplayerid = b.vplayerid;\n", "status": "success", "result": [{"total_players": 11, "existing_players": 6, "new_players": 5}]}
{"sql_id": "sql_34", "sql": "\nselect\n    ds,\n    count(distinct vplayerid) as user_cnt,\n    count(distinct vplayerid, irank) as user_times\nfrom (\n    select\n        s2.ds,\n        s2.vplayerid,\n        s2.irank\n    from (\n        select dtstatdate as ds, vplayerid, dteventtime\n        from dws_jordass_buttonpress_pre_di\n        where buttontype = 411111\n        and  ((dtstatdate between '20240917' and '20240923') or (dtstatdate between '20241008' and '20241014'))\n    ) s1\n    join (\n        select dtstatdate as ds, vplayerid, dteventtime, row_number() over (partition by vplayerid order by dteventtime) as irank\n        from dws_jordass_buttonpress_pre_di\n        where buttontype = 411120\n        and ((dtstatdate between '20240917' and '20240923') or (dtstatdate between '20241008' and '20241014'))\n    ) s2 on s1.vplayerid = s2.vplayerid and s1.ds = s2.ds and s2.dteventtime > s1.dteventtime\n    join (\n        select dtstatdate as ds, vplayerid, dteventtime\n        from dws_jordass_buttonpress_pre_di\n        where buttontype = 411123\n        and ((dtstatdate between '20240917' and '20240923') or (dtstatdate between '20241008' and '20241014'))\n    ) s3 on s2.vplayerid = s3.vplayerid and s2.ds = s3.ds and s3.dteventtime > s2.dteventtime\n)f \ngroup by ds;\n", "status": "success", "result": [{"ds": "20240922", "user_cnt": 1, "user_times": 1}, {"ds": "20241014", "user_cnt": 1, "user_times": 1}, {"ds": "20240920", "user_cnt": 3, "user_times": 3}, {"ds": "20240919", "user_cnt": 5, "user_times": 7}, {"ds": "20240917", "user_cnt": 1, "user_times": 1}, {"ds": "20240923", "user_cnt": 1, "user_times": 1}, {"ds": "20240918", "user_cnt": 5, "user_times": 7}, {"ds": "20240921", "user_cnt": 1, "user_times": 1}, {"ds": "20241008", "user_cnt": 1, "user_times": 1}, {"ds": "20241010", "user_cnt": 6, "user_times": 6}, {"ds": "20241009", "user_cnt": 6, "user_times": 11}]}
{"sql_id": "sql_35", "sql": "\nwith round_user as (\n    select dtstatdate,\n        case \n            when mode in (401,402,403) then '第一人称'\n            when mode =101 then '单排'\n            when mode =102 then '双排'\n            when mode in (103,603) then '四排'\n        end modename,\n        vplayerid,\n        sum(roundcnt) roundcnt,\n        sum(roundtime) roundtime\n    from dws_jordass_mode_roundrecord_di\n    where ((dtstatdate between '20240326' and '20240409')\n    or (dtstatdate between '20240528' and '20240611'))\n    and mode in (401,402,403,101,102,103,603)\n    group by dtstatdate,\n    case when mode in (401,402,403) then '第一人称'\n        when mode =101 then '单排'\n        when mode =102 then '双排'\n        when mode in (103,603) then '四排'\n    end,\n    vplayerid\n)\n\nselect \n    a.dtstatdate,\n    a.modename,\n    count(distinct a.vplayerid) iusernum,\n    sum(a.roundcnt) roundcnt,\n    sum(a.roundtime) roundtime,\n    count(distinct b1.vplayerid) stay2,\n    count(distinct b2.vplayerid) stay7,\n    count(distinct c1.vplayerid) playstay2,\n    count(distinct c2.vplayerid) playstay7\nfrom (\n    select * from round_user \n    where((dtstatdate between '20240326' and '20240403') or (dtstatdate between '20240528' and '20240605'))\n) a\nleft join (\n    select dtstatdate,vplayerid \n    from dws_jordass_login_di\n    where ((dtstatdate between '20240326' and '20240404') or (dtstatdate between '20240528' and '20240606')) \n    and platid =255\n    group by dtstatdate,vplayerid\n) b1 \non a.vplayerid = b1.vplayerid and date_add(a.dtstatdate,1) = b1.dtstatdate\nleft join (\n    select dtstatdate,vplayerid \n    from dws_jordass_login_di\n    where ((dtstatdate between '20240326' and '20240409') or (dtstatdate between '20240528' and '20240611')) and platid =255\n    group by dtstatdate,vplayerid\n) b2 \non a.vplayerid = b2.vplayerid and date_add(a.dtstatdate,6) = b2.dtstatdate\nleft join round_user c1 \non a.vplayerid = c1.vplayerid and date_add(a.dtstatdate,1) = c1.dtstatdate and a.modename= c1.modename\nleft join round_user c2 \non a.vplayerid = c2.vplayerid and date_add(a.dtstatdate,6) = c2.dtstatdate and a.modename= c2.modename\ngroup by a.dtstatdate,a.modename\n;\n", "status": "success", "result": [{"dtstatdate": "20240330", "modename": "四排", "iusernum": 43, "roundcnt": 383, "roundtime": 406666, "stay2": 5, "stay7": 0, "playstay2": 8, "playstay7": 6}, {"dtstatdate": "20240530", "modename": "四排", "iusernum": 38, "roundcnt": 242, "roundtime": 289732, "stay2": 5, "stay7": 6, "playstay2": 35, "playstay7": 2}, {"dtstatdate": "20240602", "modename": "双排", "iusernum": 2, "roundcnt": 2, "roundtime": 439, "stay2": 0, "stay7": 0, "playstay2": 0, "playstay7": 0}, {"dtstatdate": "20240326", "modename": "单排", "iusernum": 1, "roundcnt": 2, "roundtime": 997, "stay2": 0, "stay7": 1, "playstay2": 0, "playstay7": 0}, {"dtstatdate": "20240326", "modename": "双排", "iusernum": 5, "roundcnt": 19, "roundtime": 8711, "stay2": 1, "stay7": 2, "playstay2": 0, "playstay7": 0}, {"dtstatdate": "20240326", "modename": "四排", "iusernum": 38, "roundcnt": 285, "roundtime": 336281, "stay2": 3, "stay7": 7, "playstay2": 1, "playstay7": 5}, {"dtstatdate": "20240331", "modename": "四排", "iusernum": 38, "roundcnt": 296, "roundtime": 376187, "stay2": 5, "stay7": 0, "playstay2": 5, "playstay7": 5}, {"dtstatdate": "20240528", "modename": "四排", "iusernum": 42, "roundcnt": 284, "roundtime": 351792, "stay2": 9, "stay7": 7, "playstay2": 35, "playstay7": 6}, {"dtstatdate": "20240605", "modename": "四排", "iusernum": 42, "roundcnt": 247, "roundtime": 331124, "stay2": 6, "stay7": 0, "playstay2": 6, "playstay7": 35}, {"dtstatdate": "20240601", "modename": "双排", "iusernum": 8, "roundcnt": 19, "roundtime": 11623, "stay2": 0, "stay7": 0, "playstay2": 0, "playstay7": 0}, {"dtstatdate": "20240604", "modename": "四排", "iusernum": 37, "roundcnt": 293, "roundtime": 335822, "stay2": 3, "stay7": 0, "playstay2": 7, "playstay7": 7}, {"dtstatdate": "20240330", "modename": "双排", "iusernum": 4, "roundcnt": 13, "roundtime": 7994, "stay2": 0, "stay7": 0, "playstay2": 0, "playstay7": 0}, {"dtstatdate": "20240530", "modename": "双排", "iusernum": 5, "roundcnt": 37, "roundtime": 22921, "stay2": 1, "stay7": 1, "playstay2": 2, "playstay7": 0}, {"dtstatdate": "20240401", "modename": "单排", "iusernum": 1, "roundcnt": 1, "roundtime": 730, "stay2": 0, "stay7": 0, "playstay2": 0, "playstay7": 0}, {"dtstatdate": "20240403", "modename": "双排", "iusernum": 1, "roundcnt": 2, "roundtime": 765, "stay2": 0, "stay7": 0, "playstay2": 1, "playstay7": 0}, {"dtstatdate": "20240604", "modename": "双排", "iusernum": 2, "roundcnt": 7, "roundtime": 3783, "stay2": 0, "stay7": 0, "playstay2": 0, "playstay7": 0}, {"dtstatdate": "20240402", "modename": "双排", "iusernum": 7, "roundcnt": 16, "roundtime": 12280, "stay2": 2, "stay7": 0, "playstay2": 0, "playstay7": 1}, {"dtstatdate": "20240603", "modename": "四排", "iusernum": 43, "roundcnt": 183, "roundtime": 220353, "stay2": 9, "stay7": 0, "playstay2": 2, "playstay7": 0}, {"dtstatdate": "20240530", "modename": "单排", "iusernum": 2, "roundcnt": 3, "roundtime": 1515, "stay2": 0, "stay7": 0, "playstay2": 1, "playstay7": 0}, {"dtstatdate": "20240403", "modename": "单排", "iusernum": 2, "roundcnt": 3, "roundtime": 1517, "stay2": 0, "stay7": 0, "playstay2": 0, "playstay7": 0}, {"dtstatdate": "20240331", "modename": "双排", "iusernum": 6, "roundcnt": 34, "roundtime": 30560, "stay2": 0, "stay7": 0, "playstay2": 1, "playstay7": 1}, {"dtstatdate": "20240528", "modename": "单排", "iusernum": 1, "roundcnt": 1, "roundtime": 1883, "stay2": 0, "stay7": 0, "playstay2": 1, "playstay7": 0}, {"dtstatdate": "20240603", "modename": "单排", "iusernum": 4, "roundcnt": 6, "roundtime": 2745, "stay2": 1, "stay7": 0, "playstay2": 0, "playstay7": 0}, {"dtstatdate": "20240604", "modename": "单排", "iusernum": 1, "roundcnt": 1, "roundtime": 562, "stay2": 0, "stay7": 0, "playstay2": 0, "playstay7": 0}, {"dtstatdate": "20240328", "modename": "双排", "iusernum": 2, "roundcnt": 2, "roundtime": 2427, "stay2": 2, "stay7": 0, "playstay2": 0, "playstay7": 0}, {"dtstatdate": "20240603", "modename": "双排", "iusernum": 1, "roundcnt": 3, "roundtime": 2680, "stay2": 1, "stay7": 0, "playstay2": 0, "playstay7": 0}, {"dtstatdate": "20240330", "modename": "第一人称", "iusernum": 1, "roundcnt": 1, "roundtime": 301, "stay2": 0, "stay7": 0, "playstay2": 0, "playstay7": 0}, {"dtstatdate": "20240329", "modename": "四排", "iusernum": 43, "roundcnt": 327, "roundtime": 404190, "stay2": 2, "stay7": 9, "playstay2": 0, "playstay7": 11}, {"dtstatdate": "20240401", "modename": "四排", "iusernum": 44, "roundcnt": 261, "roundtime": 272629, "stay2": 5, "stay7": 0, "playstay2": 5, "playstay7": 6}, {"dtstatdate": "20240531", "modename": "单排", "iusernum": 2, "roundcnt": 6, "roundtime": 3002, "stay2": 0, "stay7": 0, "playstay2": 0, "playstay7": 0}, {"dtstatdate": "20240602", "modename": "单排", "iusernum": 3, "roundcnt": 4, "roundtime": 2765, "stay2": 0, "stay7": 0, "playstay2": 2, "playstay7": 0}, {"dtstatdate": "20240327", "modename": "第一人称", "iusernum": 1, "roundcnt": 7, "roundtime": 8737, "stay2": 0, "stay7": 0, "playstay2": 0, "playstay7": 0}, {"dtstatdate": "20240402", "modename": "单排", "iusernum": 1, "roundcnt": 1, "roundtime": 1288, "stay2": 0, "stay7": 0, "playstay2": 0, "playstay7": 0}, {"dtstatdate": "20240531", "modename": "四排", "iusernum": 44, "roundcnt": 328, "roundtime": 366291, "stay2": 3, "stay7": 8, "playstay2": 11, "playstay7": 1}, {"dtstatdate": "20240402", "modename": "四排", "iusernum": 42, "roundcnt": 260, "roundtime": 322039, "stay2": 8, "stay7": 0, "playstay2": 25, "playstay7": 4}, {"dtstatdate": "20240327", "modename": "单排", "iusernum": 3, "roundcnt": 59, "roundtime": 37746, "stay2": 3, "stay7": 2, "playstay2": 0, "playstay7": 0}, {"dtstatdate": "20240529", "modename": "四排", "iusernum": 40, "roundcnt": 339, "roundtime": 342914, "stay2": 10, "stay7": 10, "playstay2": 4, "playstay7": 5}, {"dtstatdate": "20240327", "modename": "四排", "iusernum": 37, "roundcnt": 262, "roundtime": 270292, "stay2": 5, "stay7": 3, "playstay2": 1, "playstay7": 2}, {"dtstatdate": "20240331", "modename": "第一人称", "iusernum": 3, "roundcnt": 15, "roundtime": 9441, "stay2": 0, "stay7": 0, "playstay2": 0, "playstay7": 0}, {"dtstatdate": "20240528", "modename": "双排", "iusernum": 4, "roundcnt": 7, "roundtime": 8759, "stay2": 0, "stay7": 1, "playstay2": 3, "playstay7": 0}, {"dtstatdate": "20240330", "modename": "单排", "iusernum": 2, "roundcnt": 8, "roundtime": 4421, "stay2": 0, "stay7": 0, "playstay2": 0, "playstay7": 0}, {"dtstatdate": "20240327", "modename": "双排", "iusernum": 5, "roundcnt": 26, "roundtime": 10401, "stay2": 2, "stay7": 1, "playstay2": 0, "playstay7": 0}, {"dtstatdate": "20240601", "modename": "四排", "iusernum": 47, "roundcnt": 314, "roundtime": 413761, "stay2": 5, "stay7": 0, "playstay2": 1, "playstay7": 0}, {"dtstatdate": "20240328", "modename": "四排", "iusernum": 43, "roundcnt": 352, "roundtime": 385959, "stay2": 8, "stay7": 7, "playstay2": 36, "playstay7": 4}, {"dtstatdate": "20240403", "modename": "四排", "iusernum": 35, "roundcnt": 170, "roundtime": 205470, "stay2": 6, "stay7": 0, "playstay2": 29, "playstay7": 1}, {"dtstatdate": "20240602", "modename": "四排", "iusernum": 46, "roundcnt": 267, "roundtime": 327552, "stay2": 9, "stay7": 0, "playstay2": 35, "playstay7": 2}, {"dtstatdate": "20240401", "modename": "双排", "iusernum": 2, "roundcnt": 9, "roundtime": 11860, "stay2": 1, "stay7": 0, "playstay2": 0, "playstay7": 0}, {"dtstatdate": "20240529", "modename": "双排", "iusernum": 5, "roundcnt": 23, "roundtime": 22254, "stay2": 2, "stay7": 2, "playstay2": 2, "playstay7": 0}, {"dtstatdate": "20240605", "modename": "双排", "iusernum": 2, "roundcnt": 13, "roundtime": 7579, "stay2": 0, "stay7": 0, "playstay2": 0, "playstay7": 0}, {"dtstatdate": "20240329", "modename": "第一人称", "iusernum": 1, "roundcnt": 6, "roundtime": 2140, "stay2": 0, "stay7": 1, "playstay2": 0, "playstay7": 0}, {"dtstatdate": "20240326", "modename": "第一人称", "iusernum": 1, "roundcnt": 17, "roundtime": 8087, "stay2": 0, "stay7": 0, "playstay2": 0, "playstay7": 0}, {"dtstatdate": "20240531", "modename": "双排", "iusernum": 5, "roundcnt": 33, "roundtime": 22420, "stay2": 1, "stay7": 1, "playstay2": 1, "playstay7": 0}, {"dtstatdate": "20240403", "modename": "第一人称", "iusernum": 1, "roundcnt": 2, "roundtime": 1053, "stay2": 0, "stay7": 0, "playstay2": 0, "playstay7": 0}, {"dtstatdate": "20240529", "modename": "单排", "iusernum": 2, "roundcnt": 6, "roundtime": 4668, "stay2": 0, "stay7": 0, "playstay2": 0, "playstay7": 0}, {"dtstatdate": "20240329", "modename": "双排", "iusernum": 2, "roundcnt": 12, "roundtime": 6366, "stay2": 0, "stay7": 1, "playstay2": 0, "playstay7": 0}]}
{"sql_id": "sql_37", "sql": "\nselect \n    s1.ds as `ds`,\n    count(distinct s1.vplayerid) as `user_cnt`,\n    coalesce(user_type, '未知') as `user_type`,\n    count(distinct case when s2.ds = date_add(s1.ds, 1) then s1.vplayerid else null end) as `next_day_retention`,\n    count(distinct case when s2.ds = date_add(s1.ds, 2) then s1.vplayerid else null end) as `three_day_retention`,\n    count(distinct case when s2.ds = date_add(s1.ds, 6) then s1.vplayerid else null end) as `seven_day_retention`,\n    count(distinct case when s2.ds = date_add(s1.ds, 13) then s1.vplayerid else null end) as `fourteen_day_retention`,\n    count(distinct case when s2.ds = date_add(s1.ds, 29) then s1.vplayerid else null end) as `thirty_day_retention`\nfrom (\n    select \n        f1.dregdate as ds,\n        f1.vplayerid as vplayerid\n    from dws_jordass_emulator_df f1\n    where f1.dregdate >= '20250401'\n      and f1.dregdate <= '20250530'\n      and f1.platid = 255\n) s1\nleft join (\n    select \n        f1.dtstatdate as ds,\n        f1.vplayerid as vplayerid,\n        '手机端' as user_type\n    from dws_jordass_device_login_di f1\n    where f1.device_type = 0\n      and f1.dtstatdate >= '20250401' and f1.dtstatdate <= date_add('20250530', 29)\n\n    union all\n\n    select \n        f1.dtstatdate as ds,\n        f1.vplayerid as vplayerid,\n        '模拟器' as user_type\n    from dws_jordass_device_login_di f1\n    where f1.device_type in (1,5)\n      and f1.dtstatdate >= '20250401' and f1.dtstatdate <= date_add('20250530', 29)\n\n    union all\n\n    select \n        f1.dtstatdate as ds,\n        f1.vplayerid as vplayerid,\n        '游戏内' as user_type\n    from dws_jordass_login_di f1\n    where f1.dtstatdate >= '20250401' and f1.dtstatdate <= date_add('20250530', 29)\n      and f1.platid = 255\n) s2 on s1.vplayerid = s2.vplayerid\ngroup by s1.ds, user_type;\n", "status": "success", "result": [{"ds": "20250410", "user_cnt": 1, "user_type": "游戏内", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250420", "user_cnt": 2, "user_type": "游戏内", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 1, "fourteen_day_retention": 1, "thirty_day_retention": 0}, {"ds": "20250418", "user_cnt": 3, "user_type": "手机端", "next_day_retention": 0, "three_day_retention": 1, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250504", "user_cnt": 6, "user_type": "手机端", "next_day_retention": 1, "three_day_retention": 0, "seven_day_retention": 1, "fourteen_day_retention": 1, "thirty_day_retention": 1}, {"ds": "20250420", "user_cnt": 3, "user_type": "手机端", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 1, "thirty_day_retention": 1}, {"ds": "20250408", "user_cnt": 1, "user_type": "模拟器", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250502", "user_cnt": 1, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250411", "user_cnt": 2, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250519", "user_cnt": 2, "user_type": "模拟器", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250425", "user_cnt": 1, "user_type": "模拟器", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250423", "user_cnt": 3, "user_type": "游戏内", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250521", "user_cnt": 5, "user_type": "手机端", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 1}, {"ds": "20250401", "user_cnt": 3, "user_type": "模拟器", "next_day_retention": 1, "three_day_retention": 1, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250523", "user_cnt": 1, "user_type": "手机端", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250430", "user_cnt": 2, "user_type": "手机端", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250525", "user_cnt": 3, "user_type": "手机端", "next_day_retention": 0, "three_day_retention": 1, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250518", "user_cnt": 2, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250422", "user_cnt": 1, "user_type": "模拟器", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250507", "user_cnt": 2, "user_type": "模拟器", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250510", "user_cnt": 3, "user_type": "模拟器", "next_day_retention": 1, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 1}, {"ds": "20250527", "user_cnt": 2, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250521", "user_cnt": 1, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250522", "user_cnt": 3, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250511", "user_cnt": 4, "user_type": "手机端", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 1, "fourteen_day_retention": 1, "thirty_day_retention": 0}, {"ds": "20250411", "user_cnt": 3, "user_type": "手机端", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250403", "user_cnt": 2, "user_type": "模拟器", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250413", "user_cnt": 1, "user_type": "手机端", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 1, "thirty_day_retention": 0}, {"ds": "20250413", "user_cnt": 1, "user_type": "模拟器", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 1, "thirty_day_retention": 0}, {"ds": "20250506", "user_cnt": 1, "user_type": "手机端", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250416", "user_cnt": 4, "user_type": "模拟器", "next_day_retention": 1, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 1}, {"ds": "20250530", "user_cnt": 3, "user_type": "模拟器", "next_day_retention": 1, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250530", "user_cnt": 2, "user_type": "游戏内", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 1}, {"ds": "20250414", "user_cnt": 4, "user_type": "模拟器", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 1, "fourteen_day_retention": 1, "thirty_day_retention": 0}, {"ds": "20250524", "user_cnt": 5, "user_type": "游戏内", "next_day_retention": 1, "three_day_retention": 1, "seven_day_retention": 0, "fourteen_day_retention": 1, "thirty_day_retention": 0}, {"ds": "20250508", "user_cnt": 2, "user_type": "游戏内", "next_day_retention": 0, "three_day_retention": 1, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 1}, {"ds": "20250512", "user_cnt": 3, "user_type": "游戏内", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 1, "fourteen_day_retention": 0, "thirty_day_retention": 1}, {"ds": "20250525", "user_cnt": 3, "user_type": "游戏内", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250530", "user_cnt": 2, "user_type": "手机端", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 1}, {"ds": "20250421", "user_cnt": 3, "user_type": "手机端", "next_day_retention": 1, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250429", "user_cnt": 4, "user_type": "手机端", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 1, "fourteen_day_retention": 1, "thirty_day_retention": 0}, {"ds": "20250501", "user_cnt": 1, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250529", "user_cnt": 3, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250505", "user_cnt": 2, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250523", "user_cnt": 4, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250515", "user_cnt": 2, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250407", "user_cnt": 2, "user_type": "模拟器", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250427", "user_cnt": 1, "user_type": "游戏内", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250419", "user_cnt": 6, "user_type": "游戏内", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 1, "thirty_day_retention": 0}, {"ds": "20250402", "user_cnt": 2, "user_type": "手机端", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 1, "fourteen_day_retention": 1, "thirty_day_retention": 0}, {"ds": "20250519", "user_cnt": 3, "user_type": "手机端", "next_day_retention": 1, "three_day_retention": 0, "seven_day_retention": 2, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250430", "user_cnt": 2, "user_type": "游戏内", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 1, "thirty_day_retention": 0}, {"ds": "20250502", "user_cnt": 4, "user_type": "手机端", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 1, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250522", "user_cnt": 2, "user_type": "手机端", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250429", "user_cnt": 3, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250415", "user_cnt": 2, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250528", "user_cnt": 3, "user_type": "手机端", "next_day_retention": 1, "three_day_retention": 1, "seven_day_retention": 1, "fourteen_day_retention": 0, "thirty_day_retention": 1}, {"ds": "20250515", "user_cnt": 1, "user_type": "手机端", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 1}, {"ds": "20250522", "user_cnt": 1, "user_type": "游戏内", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250510", "user_cnt": 3, "user_type": "游戏内", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250425", "user_cnt": 2, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250514", "user_cnt": 4, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250427", "user_cnt": 3, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250517", "user_cnt": 1, "user_type": "游戏内", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250507", "user_cnt": 1, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250514", "user_cnt": 1, "user_type": "游戏内", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250501", "user_cnt": 1, "user_type": "模拟器", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250414", "user_cnt": 2, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250424", "user_cnt": 1, "user_type": "游戏内", "next_day_retention": 0, "three_day_retention": 1, "seven_day_retention": 1, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250403", "user_cnt": 3, "user_type": "手机端", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250422", "user_cnt": 1, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250402", "user_cnt": 1, "user_type": "模拟器", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 1, "fourteen_day_retention": 1, "thirty_day_retention": 0}, {"ds": "20250417", "user_cnt": 2, "user_type": "模拟器", "next_day_retention": 1, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250414", "user_cnt": 2, "user_type": "游戏内", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250501", "user_cnt": 4, "user_type": "游戏内", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250409", "user_cnt": 3, "user_type": "手机端", "next_day_retention": 1, "three_day_retention": 1, "seven_day_retention": 1, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250406", "user_cnt": 5, "user_type": "手机端", "next_day_retention": 0, "three_day_retention": 1, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250423", "user_cnt": 2, "user_type": "模拟器", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250413", "user_cnt": 2, "user_type": "游戏内", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250519", "user_cnt": 3, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250408", "user_cnt": 2, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250516", "user_cnt": 1, "user_type": "模拟器", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250519", "user_cnt": 3, "user_type": "游戏内", "next_day_retention": 1, "three_day_retention": 0, "seven_day_retention": 1, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250425", "user_cnt": 2, "user_type": "手机端", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 1, "fourteen_day_retention": 0, "thirty_day_retention": 1}, {"ds": "20250516", "user_cnt": 4, "user_type": "手机端", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250415", "user_cnt": 3, "user_type": "游戏内", "next_day_retention": 0, "three_day_retention": 1, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250428", "user_cnt": 3, "user_type": "手机端", "next_day_retention": 0, "three_day_retention": 1, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250428", "user_cnt": 3, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250509", "user_cnt": 1, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250428", "user_cnt": 2, "user_type": "游戏内", "next_day_retention": 0, "three_day_retention": 1, "seven_day_retention": 1, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250510", "user_cnt": 6, "user_type": "手机端", "next_day_retention": 1, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250408", "user_cnt": 3, "user_type": "手机端", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250406", "user_cnt": 1, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250430", "user_cnt": 3, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250429", "user_cnt": 3, "user_type": "模拟器", "next_day_retention": 0, "three_day_retention": 1, "seven_day_retention": 1, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250506", "user_cnt": 3, "user_type": "游戏内", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250529", "user_cnt": 2, "user_type": "手机端", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 1, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250424", "user_cnt": 1, "user_type": "手机端", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250529", "user_cnt": 3, "user_type": "游戏内", "next_day_retention": 1, "three_day_retention": 0, "seven_day_retention": 1, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250518", "user_cnt": 2, "user_type": "游戏内", "next_day_retention": 0, "three_day_retention": 1, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250517", "user_cnt": 1, "user_type": "手机端", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250416", "user_cnt": 2, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250501", "user_cnt": 2, "user_type": "手机端", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250527", "user_cnt": 3, "user_type": "手机端", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250506", "user_cnt": 2, "user_type": "模拟器", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250512", "user_cnt": 1, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250505", "user_cnt": 4, "user_type": "游戏内", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250509", "user_cnt": 3, "user_type": "游戏内", "next_day_retention": 0, "three_day_retention": 1, "seven_day_retention": 0, "fourteen_day_retention": 1, "thirty_day_retention": 1}, {"ds": "20250526", "user_cnt": 3, "user_type": "游戏内", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 1, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250526", "user_cnt": 2, "user_type": "模拟器", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250401", "user_cnt": 4, "user_type": "游戏内", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 2, "fourteen_day_retention": 0, "thirty_day_retention": 1}, {"ds": "20250421", "user_cnt": 3, "user_type": "游戏内", "next_day_retention": 1, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250517", "user_cnt": 3, "user_type": "模拟器", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250515", "user_cnt": 3, "user_type": "模拟器", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250508", "user_cnt": 2, "user_type": "手机端", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 1, "fourteen_day_retention": 2, "thirty_day_retention": 0}, {"ds": "20250417", "user_cnt": 3, "user_type": "手机端", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 2, "fourteen_day_retention": 0, "thirty_day_retention": 2}, {"ds": "20250412", "user_cnt": 4, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250513", "user_cnt": 4, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250403", "user_cnt": 2, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250502", "user_cnt": 1, "user_type": "模拟器", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250430", "user_cnt": 2, "user_type": "模拟器", "next_day_retention": 1, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250523", "user_cnt": 1, "user_type": "游戏内", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250521", "user_cnt": 5, "user_type": "游戏内", "next_day_retention": 1, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 1}, {"ds": "20250425", "user_cnt": 3, "user_type": "游戏内", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 1, "thirty_day_retention": 0}, {"ds": "20250405", "user_cnt": 3, "user_type": "手机端", "next_day_retention": 1, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250415", "user_cnt": 2, "user_type": "手机端", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250520", "user_cnt": 2, "user_type": "游戏内", "next_day_retention": 0, "three_day_retention": 1, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 1}, {"ds": "20250405", "user_cnt": 2, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250410", "user_cnt": 3, "user_type": "模拟器", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250507", "user_cnt": 3, "user_type": "游戏内", "next_day_retention": 1, "three_day_retention": 1, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250411", "user_cnt": 4, "user_type": "游戏内", "next_day_retention": 1, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250507", "user_cnt": 5, "user_type": "手机端", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 1, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250512", "user_cnt": 2, "user_type": "模拟器", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250530", "user_cnt": 3, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250413", "user_cnt": 3, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250524", "user_cnt": 1, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250424", "user_cnt": 3, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250526", "user_cnt": 2, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250404", "user_cnt": 2, "user_type": "手机端", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250511", "user_cnt": 2, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250423", "user_cnt": 1, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250529", "user_cnt": 2, "user_type": "模拟器", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250424", "user_cnt": 2, "user_type": "模拟器", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250520", "user_cnt": 1, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250404", "user_cnt": 1, "user_type": "游戏内", "next_day_retention": 1, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250508", "user_cnt": 2, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250506", "user_cnt": 1, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250420", "user_cnt": 3, "user_type": "模拟器", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 1}, {"ds": "20250412", "user_cnt": 1, "user_type": "模拟器", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250504", "user_cnt": 5, "user_type": "游戏内", "next_day_retention": 1, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250405", "user_cnt": 2, "user_type": "游戏内", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 1, "fourteen_day_retention": 1, "thirty_day_retention": 0}, {"ds": "20250426", "user_cnt": 7, "user_type": "手机端", "next_day_retention": 2, "three_day_retention": 1, "seven_day_retention": 2, "fourteen_day_retention": 1, "thirty_day_retention": 0}, {"ds": "20250409", "user_cnt": 3, "user_type": "模拟器", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250429", "user_cnt": 3, "user_type": "游戏内", "next_day_retention": 0, "three_day_retention": 1, "seven_day_retention": 1, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250422", "user_cnt": 3, "user_type": "游戏内", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 1}, {"ds": "20250417", "user_cnt": 3, "user_type": "游戏内", "next_day_retention": 2, "three_day_retention": 2, "seven_day_retention": 1, "fourteen_day_retention": 1, "thirty_day_retention": 1}, {"ds": "20250512", "user_cnt": 3, "user_type": "手机端", "next_day_retention": 0, "three_day_retention": 1, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250412", "user_cnt": 1, "user_type": "手机端", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250509", "user_cnt": 5, "user_type": "手机端", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250505", "user_cnt": 1, "user_type": "模拟器", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250409", "user_cnt": 1, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250417", "user_cnt": 3, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250516", "user_cnt": 2, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250503", "user_cnt": 1, "user_type": "模拟器", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 1}, {"ds": "20250407", "user_cnt": 3, "user_type": "游戏内", "next_day_retention": 0, "three_day_retention": 1, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250423", "user_cnt": 2, "user_type": "手机端", "next_day_retention": 1, "three_day_retention": 0, "seven_day_retention": 1, "fourteen_day_retention": 1, "thirty_day_retention": 0}, {"ds": "20250419", "user_cnt": 4, "user_type": "手机端", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250523", "user_cnt": 2, "user_type": "模拟器", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250404", "user_cnt": 4, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250418", "user_cnt": 2, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250528", "user_cnt": 4, "user_type": "游戏内", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 1, "fourteen_day_retention": 1, "thirty_day_retention": 1}, {"ds": "20250516", "user_cnt": 3, "user_type": "游戏内", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 1, "fourteen_day_retention": 1, "thirty_day_retention": 1}, {"ds": "20250421", "user_cnt": 2, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250503", "user_cnt": 3, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250511", "user_cnt": 2, "user_type": "模拟器", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 1, "thirty_day_retention": 0}, {"ds": "20250511", "user_cnt": 4, "user_type": "游戏内", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250402", "user_cnt": 2, "user_type": "游戏内", "next_day_retention": 1, "three_day_retention": 0, "seven_day_retention": 1, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250407", "user_cnt": 2, "user_type": "手机端", "next_day_retention": 0, "three_day_retention": 1, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 1}, {"ds": "20250411", "user_cnt": 1, "user_type": "模拟器", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250508", "user_cnt": 1, "user_type": "模拟器", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250406", "user_cnt": 2, "user_type": "游戏内", "next_day_retention": 0, "three_day_retention": 1, "seven_day_retention": 1, "fourteen_day_retention": 1, "thirty_day_retention": 0}, {"ds": "20250514", "user_cnt": 2, "user_type": "手机端", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 1}, {"ds": "20250503", "user_cnt": 1, "user_type": "手机端", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250427", "user_cnt": 1, "user_type": "模拟器", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250426", "user_cnt": 1, "user_type": "模拟器", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250528", "user_cnt": 1, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250421", "user_cnt": 1, "user_type": "模拟器", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250522", "user_cnt": 1, "user_type": "模拟器", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 1, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250416", "user_cnt": 3, "user_type": "游戏内", "next_day_retention": 0, "three_day_retention": 1, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250526", "user_cnt": 2, "user_type": "手机端", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250422", "user_cnt": 4, "user_type": "手机端", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250505", "user_cnt": 5, "user_type": "手机端", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250504", "user_cnt": 3, "user_type": "模拟器", "next_day_retention": 1, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250426", "user_cnt": 4, "user_type": "游戏内", "next_day_retention": 1, "three_day_retention": 1, "seven_day_retention": 0, "fourteen_day_retention": 2, "thirty_day_retention": 1}, {"ds": "20250414", "user_cnt": 1, "user_type": "手机端", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 1}, {"ds": "20250401", "user_cnt": 3, "user_type": "手机端", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250416", "user_cnt": 3, "user_type": "手机端", "next_day_retention": 2, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 1}, {"ds": "20250517", "user_cnt": 2, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250415", "user_cnt": 4, "user_type": "模拟器", "next_day_retention": 1, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 1}, {"ds": "20250520", "user_cnt": 3, "user_type": "模拟器", "next_day_retention": 0, "three_day_retention": 2, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250502", "user_cnt": 3, "user_type": "游戏内", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 1}, {"ds": "20250518", "user_cnt": 4, "user_type": "手机端", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 1, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250524", "user_cnt": 3, "user_type": "手机端", "next_day_retention": 1, "three_day_retention": 0, "seven_day_retention": 1, "fourteen_day_retention": 1, "thirty_day_retention": 0}, {"ds": "20250513", "user_cnt": 2, "user_type": "手机端", "next_day_retention": 2, "three_day_retention": 1, "seven_day_retention": 1, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250427", "user_cnt": 2, "user_type": "手机端", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 1}, {"ds": "20250521", "user_cnt": 3, "user_type": "模拟器", "next_day_retention": 0, "three_day_retention": 1, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250525", "user_cnt": 3, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250420", "user_cnt": 2, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250406", "user_cnt": 3, "user_type": "模拟器", "next_day_retention": 0, "three_day_retention": 1, "seven_day_retention": 1, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250408", "user_cnt": 3, "user_type": "游戏内", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250525", "user_cnt": 3, "user_type": "模拟器", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250412", "user_cnt": 1, "user_type": "游戏内", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250403", "user_cnt": 4, "user_type": "游戏内", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 1, "thirty_day_retention": 0}, {"ds": "20250407", "user_cnt": 2, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250409", "user_cnt": 2, "user_type": "游戏内", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250524", "user_cnt": 1, "user_type": "模拟器", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250418", "user_cnt": 2, "user_type": "模拟器", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250527", "user_cnt": 3, "user_type": "模拟器", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250528", "user_cnt": 1, "user_type": "模拟器", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250503", "user_cnt": 2, "user_type": "游戏内", "next_day_retention": 1, "three_day_retention": 1, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250527", "user_cnt": 2, "user_type": "游戏内", "next_day_retention": 0, "three_day_retention": 1, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250520", "user_cnt": 2, "user_type": "手机端", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250418", "user_cnt": 1, "user_type": "游戏内", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250402", "user_cnt": 1, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}, {"ds": "20250410", "user_cnt": 2, "user_type": "未知", "next_day_retention": 0, "three_day_retention": 0, "seven_day_retention": 0, "fourteen_day_retention": 0, "thirty_day_retention": 0}]}
{"sql_id": "sql_38", "sql": "\nwith usertype as (\n    select '广域战场' itype, dtstatdate, dregdate, vplayerid, cbitmap \n    from dws_jordass_login_df\n    where dtstatdate = date_add('20240723',2) and platid =255 and instr(substr(cbitmap,1,3),'1')>0\n    union all\n    select '消灭战' itype, dtstatdate, dregdate, vplayerid, cbitmap \n    from dws_jordass_login_df\n    where dtstatdate = date_add('20230804',2) and platid =255 and instr(substr(cbitmap,1,3),'1')>0\n    union all\n    select '幻想混战' itype, dtstatdate, dregdate, vplayerid, cbitmap \n    from dws_jordass_login_df\n    where dtstatdate = date_add('20241115',2) and platid =255 and instr(substr(cbitmap,1,3),'1')>0\n    union all\n    select '荒野传说' itype, dtstatdate, dregdate, vplayerid, cbitmap \n    from dws_jordass_login_df\n    where dtstatdate = date_add('20240903',2) and platid =255 and instr(substr(cbitmap,1,3),'1')>0\n    union all\n    select '策略载具' itype, dtstatdate, dregdate, vplayerid, cbitmap \n    from dws_jordass_login_df\n    where dtstatdate = date_add('20241010',2) and platid =255 and instr(substr(cbitmap,1,3),'1')>0\n    union all\n    select '炎夏混战' itype, dtstatdate, dregdate, vplayerid, cbitmap \n    from dws_jordass_login_df\n    where dtstatdate = date_add('20240625',2) and platid =255 and instr(substr(cbitmap,1,3),'1')>0\n    union all\n    select '单人装备' itype, dtstatdate, dregdate, vplayerid, cbitmap \n    from dws_jordass_login_df\n    where dtstatdate = date_add('20240517',2) and platid =255 and instr(substr(cbitmap,1,3),'1')>0\n    union all\n    select '交叉堡垒' itype, dtstatdate, dregdate, vplayerid, cbitmap \n    from dws_jordass_login_df\n    where dtstatdate = date_add('20240412',2) and platid =255 and instr(substr(cbitmap,1,3),'1')>0\n),\nplayuser as (\n    select '广域战场' itype, min(dtstatdate) dtstatdate, vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= '20240723' and dtstatdate <= date_add('20240723',2) and submodename= '广域战场模式'\n    group by vplayerid\n    union all\n    select '消灭战' itype, min(dtstatdate), vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= '20230804' and dtstatdate <= date_add('20230804',2) and modename='组队竞技' and submodename like '%消灭战模式%'\n    group by vplayerid\n    union all\n    select '幻想混战' itype, min(dtstatdate), vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= '20241115' and dtstatdate <= date_add('20241115',2) and modename='创意创作间' and submodename='幻想混战'\n    group by vplayerid\n    union all\n    select '荒野传说' itype, min(dtstatdate), vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= '20240903' and dtstatdate <= date_add('20240903',2) and modename='休闲模式' and submodename in ('荒野传说','荒野沙漠')\n    group by vplayerid\n    union all\n    select '策略载具' itype, min(dtstatdate), vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= '20241010' and dtstatdate <= date_add('20241010',2) and modename='休闲模式' and submodename like '%策略载具%'\n    group by vplayerid\n    union all\n    select '炎夏混战' itype, min(dtstatdate), vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= '20240625' and dtstatdate <= date_add('20240625',2) and modename='创意创作间' and submodename like '%炎夏混战%'\n    group by vplayerid\n    union all\n    select '单人装备' itype, min(dtstatdate), vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= '20240517' and dtstatdate <= date_add('20240517',2) and modename='组队竞技' and submodename like '%单人装备%'\n    group by vplayerid\n    union all\n    select '交叉堡垒' itype, min(dtstatdate), vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= '20240412' and dtstatdate <= date_add('20240412',2) and modename='组队竞技' and submodename like '%交叉堡垒%'\n    group by vplayerid\n)\n\nselect \n    t.itype,\n    t.user_type,\n    t.iusernum1,\n    p.iusernum2\nfrom (\n    select \n        a.itype,\n        b.user_type,\n        count(distinct a.vplayerid) iusernum1\n    from playuser a\n    join (\n        select \n            itype, vplayerid,\n            case \n                when datediff(dtstatdate,dregdate)<=2 then '砺刃新增'\n                when instr(substr(cbitmap,4),'1')=0 or instr(substr(cbitmap,4),'1')>=60 then '砺刃回流(流失60天以上)'\n                when instr(substr(cbitmap,4),'1')>=21 then '砺刃回流(流失21-59天)'\n                when instr(substr(cbitmap,4),'1')>=14 then '砺刃回流(流失14-20天)'\n                when instr(substr(cbitmap,4),'1')>7 then '砺刃回流(流失7-13天)'\n                when instr(substr(cbitmap,4),'1')<=7 then '砺刃留存' \n            end user_type\n        from usertype\n    ) b on a.itype = b.itype and a.vplayerid = b.vplayerid\n    group by a.itype,b.user_type\n) t\nleft join (\n    select itype,\n        case \n            when datediff(dtstatdate,dregdate)<=2 then '砺刃新增'\n            when instr(substr(cbitmap,4),'1')=0 or instr(substr(cbitmap,4),'1')>=60 then '砺刃回流(流失60天以上)'\n            when instr(substr(cbitmap,4),'1')>=21 then '砺刃回流(流失21-59天)'\n            when instr(substr(cbitmap,4),'1')>=14 then '砺刃回流(流失14-20天)'\n            when instr(substr(cbitmap,4),'1')>7 then '砺刃回流(流失7-13天)'\n            when instr(substr(cbitmap,4),'1')<=7 then '砺刃留存' \n        end user_type,\n        count(distinct vplayerid) iusernum2\n    from usertype\n    group by itype,\n        case \n            when datediff(dtstatdate,dregdate)<=2 then '砺刃新增'\n            when instr(substr(cbitmap,4),'1')=0 or instr(substr(cbitmap,4),'1')>=60 then '砺刃回流(流失60天以上)'\n            when instr(substr(cbitmap,4),'1')>=21 then '砺刃回流(流失21-59天)'\n            when instr(substr(cbitmap,4),'1')>=14 then '砺刃回流(流失14-20天)'\n            when instr(substr(cbitmap,4),'1')>7 then '砺刃回流(流失7-13天)'\n            when instr(substr(cbitmap,4),'1')<=7 then '砺刃留存' \n        end\n) p on t.itype=p.itype and t.user_type=p.user_type\n;\n", "status": "success", "result": [{"itype": "幻想混战", "user_type": "砺刃留存", "iusernum1": 59, "iusernum2": 249}, {"itype": "单人装备", "user_type": "砺刃留存", "iusernum1": 58, "iusernum2": 246}, {"itype": "炎夏混战", "user_type": "砺刃留存", "iusernum1": 56, "iusernum2": 248}, {"itype": "荒野传说", "user_type": "砺刃留存", "iusernum1": 56, "iusernum2": 250}, {"itype": "广域战场", "user_type": "砺刃留存", "iusernum1": 65, "iusernum2": 249}, {"itype": "策略载具", "user_type": "砺刃留存", "iusernum1": 36, "iusernum2": 248}, {"itype": "消灭战", "user_type": "砺刃留存", "iusernum1": 61, "iusernum2": 242}, {"itype": "交叉堡垒", "user_type": "砺刃留存", "iusernum1": 50, "iusernum2": 243}, {"itype": "消灭战", "user_type": "砺刃回流(流失7-13天)", "iusernum1": 4, "iusernum2": 5}, {"itype": "交叉堡垒", "user_type": "砺刃回流(流失7-13天)", "iusernum1": 1, "iusernum2": 6}]}
{"sql_id": "sql_39", "sql": "\nwith playuser as (\n select '广域战场' itype,dtstatdate,vplayerid\n from dws_jordass_mode_roundrecord_di\n where dtstatdate between '20240723' and date_add('20240723',2) and submodename= '广域战场模式'\n group by 1,2,3\n union all\n select '消灭战' itype,dtstatdate,vplayerid\n from dws_jordass_mode_roundrecord_di\n where dtstatdate between '20230804' and date_add('20230804',2) and modename='组队竞技' and submodename like '%消灭战模式%'\n group by 1,2,3\n union all\n select '幻想混战' itype,dtstatdate,vplayerid\n from dws_jordass_mode_roundrecord_di\n where dtstatdate between '20241115' and date_add('20241115',2) and modename='创意创作间' and submodename='幻想混战'\n group by 1,2,3\n union all\n select '荒野传说' itype,dtstatdate,vplayerid\n from dws_jordass_mode_roundrecord_di\n where dtstatdate between '20240903' and date_add('20240903',2) and modename='休闲模式' and submodename in ('荒野传说','荒野沙漠')\n group by 1,2,3\n union all\n select '策略载具' itype,dtstatdate,vplayerid\n from dws_jordass_mode_roundrecord_di\n where dtstatdate between '20241010' and date_add('20241010',2) and modename='休闲模式' and submodename like '%策略载具%'\n group by 1,2,3\n union all\n select '炎夏混战' itype,dtstatdate,vplayerid\n from dws_jordass_mode_roundrecord_di\n where dtstatdate between '20240625' and date_add('20240625',2) and modename='创意创作间' and submodename like '%炎夏混战%'\n group by 1,2,3\n union all\n select '单人装备' itype,dtstatdate,vplayerid\n from dws_jordass_mode_roundrecord_di\n where dtstatdate between '20240517' and date_add('20240517',2) and modename='组队竞技' and submodename like '%单人装备%'\n group by 1,2,3\n union all\n select '交叉堡垒' itype,dtstatdate,vplayerid\n from dws_jordass_mode_roundrecord_di\n where dtstatdate between '20240412' and date_add('20240412',2) and modename='组队竞技' and submodename like '%交叉堡垒%'\n group by 1,2,3\n union all\n select '庆典混战' as itype,dtstatdate,vplayerid\n from dws_jordass_mode_roundrecord_di\n where dtstatdate between '20240426' and date_add('20240426',2) and submode in (2611)\n group by dtstatdate,vplayerid\n union all\n select 'CG29-流浪地球' as itype,dtstatdate,vplayerid\n from dws_jordass_mode_roundrecord_di\n where dtstatdate between '20240903' and date_add('20240903',2)and submodename = 'CG29-流浪地球'\n group by dtstatdate,vplayerid\n union all\n select 'CG28-动物丛林' as itype,dtstatdate,vplayerid\n from dws_jordass_mode_roundrecord_di\n where dtstatdate between '20241105' and date_add('20241105',2)and submodename = 'CG28-动物丛林'\n group by dtstatdate,vplayerid\n),\nallplayuser as (\n select '广域战场' itype,\n case \n when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n when modename='传统模式' and mapname='群屿' then '传统群屿'\n when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n when modename='传统模式' and mapname='山峦' then '山峦'\n when submodename='极能形态模式' then '极能形态模式'\n when modename='生存模式' then '隧道'\n when submodename='广域战场模式' then '广域战场'\n when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n else '其他子模式'\n end playclass1,\n vplayerid,\n max(case when dtstatdate<'20240723' then 1 else 0 end) islast,\n max(case when dtstatdate>='20240723' then 1 else 0 end) isthis\n from dws_jordass_mode_roundrecord_di\n where dtstatdate between date_sub('20240723',7) and date_add('20240723',2) \n group by \n case \n when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n when modename='传统模式' and mapname='群屿' then '传统群屿'\n when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n when modename='传统模式' and mapname='山峦' then '山峦'\n when submodename='极能形态模式' then '极能形态模式'\n when modename='生存模式' then '隧道'\n when submodename='广域战场模式' then '广域战场'\n when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n else '其他子模式'\n end ,\n vplayerid\n union all\n select '消灭战' itype,\n case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n when modename='传统模式' and mapname='群屿' then '传统群屿'\n when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n when modename='传统模式' and mapname='山峦' then '山峦'\n when submodename='极能形态模式' then '极能形态模式'\n when modename='生存模式' then '隧道'\n when submodename='广域战场模式' then '广域战场'\n when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n else '其他子模式'\n end playclass1,\n vplayerid,\n max(case when dtstatdate<'20230804' then 1 else 0 end) islast,\n max(case when dtstatdate>='20230804' then 1 else 0 end) isthis\n from dws_jordass_mode_roundrecord_di\n where dtstatdate between date_sub('20230804',7) and date_add('20230804',2) \n group by case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n when modename='传统模式' and mapname='群屿' then '传统群屿'\n when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n when modename='传统模式' and mapname='山峦' then '山峦'\n when submodename='极能形态模式' then '极能形态模式'\n when modename='生存模式' then '隧道'\n when submodename='广域战场模式' then '广域战场'\n when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n else '其他子模式'\n end ,\n vplayerid\n union all\n select '幻想混战' itype,\n case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n when modename='传统模式' and mapname='群屿' then '传统群屿'\n when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n when modename='传统模式' and mapname='山峦' then '山峦'\n when submodename='极能形态模式' then '极能形态模式'\n when modename='生存模式' then '隧道'\n when submodename='广域战场模式' then '广域战场'\n when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n else '其他子模式'\n end playclass1,\n vplayerid,\n max(case when dtstatdate<'20241115' then 1 else 0 end) islast,\n max(case when dtstatdate>='20241115' then 1 else 0 end) isthis\n from dws_jordass_mode_roundrecord_di\n where dtstatdate between date_sub('20241115',7) and date_add('20241115',2) \n group by case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n when modename='传统模式' and mapname='群屿' then '传统群屿'\n when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n when modename='传统模式' and mapname='山峦' then '山峦'\n when submodename='极能形态模式' then '极能形态模式'\n when modename='生存模式' then '隧道'\n when submodename='广域战场模式' then '广域战场'\n when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n else '其他子模式'\n end ,\n vplayerid\n union all\n select '荒野传说' itype,\n case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n when modename='传统模式' and mapname='群屿' then '传统群屿'\n when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n when modename='传统模式' and mapname='山峦' then '山峦'\n when submodename='极能形态模式' then '极能形态模式'\n when modename='生存模式' then '隧道'\n when submodename='广域战场模式' then '广域战场'\n when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n else '其他子模式'\n end playclass1,\n vplayerid,\n max(case when dtstatdate<'20240903' then 1 else 0 end) islast,\n max(case when dtstatdate>='20240903' then 1 else 0 end) isthis\n from dws_jordass_mode_roundrecord_di\n where dtstatdate between date_sub('20240903',7) and date_add('20240903',2) \n group by case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n when modename='传统模式' and mapname='群屿' then '传统群屿'\n when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n when modename='传统模式' and mapname='山峦' then '山峦'\n when submodename='极能形态模式' then '极能形态模式'\n when modename='生存模式' then '隧道'\n when submodename='广域战场模式' then '广域战场'\n when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n else '其他子模式'\n end ,\n vplayerid\n union all\n select '策略载具' itype,\n case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n when modename='传统模式' and mapname='群屿' then '传统群屿'\n when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n when modename='传统模式' and mapname='山峦' then '山峦'\n when submodename='极能形态模式' then '极能形态模式'\n when modename='生存模式' then '隧道'\n when submodename='广域战场模式' then '广域战场'\n when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n else '其他子模式'\n end playclass1,\n vplayerid,\n max(case when dtstatdate<'20241010' then 1 else 0 end) islast,\n max(case when dtstatdate>='20241010' then 1 else 0 end) isthis\n from dws_jordass_mode_roundrecord_di\n where dtstatdate between date_sub('20241010',7) and date_add('20241010',2) \n group by case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n when modename='传统模式' and mapname='群屿' then '传统群屿'\n when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n when modename='传统模式' and mapname='山峦' then '山峦'\n when submodename='极能形态模式' then '极能形态模式'\n when modename='生存模式' then '隧道'\n when submodename='广域战场模式' then '广域战场'\n when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n else '其他子模式'\n end ,\n vplayerid\n union all\n select '炎夏混战' itype,\n case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n when modename='传统模式' and mapname='群屿' then '传统群屿'\n when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n when modename='传统模式' and mapname='山峦' then '山峦'\n when submodename='极能形态模式' then '极能形态模式'\n when modename='生存模式' then '隧道'\n when submodename='广域战场模式' then '广域战场'\n when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n else '其他子模式'\n end playclass1,\n vplayerid,\n max(case when dtstatdate<'20240625' then 1 else 0 end) islast,\n max(case when dtstatdate>='20240625' then 1 else 0 end) isthis\n from dws_jordass_mode_roundrecord_di\n where dtstatdate between date_sub('20240625',7) and date_add('20240625',2) \n group by case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n when modename='传统模式' and mapname='群屿' then '传统群屿'\n when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n when modename='传统模式' and mapname='山峦' then '山峦'\n when submodename='极能形态模式' then '极能形态模式'\n when modename='生存模式' then '隧道'\n when submodename='广域战场模式' then '广域战场'\n when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n else '其他子模式'\n end ,\n vplayerid\n union all\n select '单人装备' itype,\n case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n when modename='传统模式' and mapname='群屿' then '传统群屿'\n when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n when modename='传统模式' and mapname='山峦' then '山峦'\n when submodename='极能形态模式' then '极能形态模式'\n when modename='生存模式' then '隧道'\n when submodename='广域战场模式' then '广域战场'\n when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n else '其他子模式'\n end playclass1,\n vplayerid,\n max(case when dtstatdate<'20240517' then 1 else 0 end) islast,\n max(case when dtstatdate>='20240517' then 1 else 0 end) isthis\n from dws_jordass_mode_roundrecord_di\n where dtstatdate between date_sub('20240517',7) and date_add('20240517',2) \n group by case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n when modename='传统模式' and mapname='群屿' then '传统群屿'\n when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n when modename='传统模式' and mapname='山峦' then '山峦'\n when submodename='极能形态模式' then '极能形态模式'\n when modename='生存模式' then '隧道'\n when submodename='广域战场模式' then '广域战场'\n when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n else '其他子模式'\n end ,\n vplayerid\n union all\n select '交叉堡垒' itype,\n case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n when modename='传统模式' and mapname='群屿' then '传统群屿'\n when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n when modename='传统模式' and mapname='山峦' then '山峦'\n when submodename='极能形态模式' then '极能形态模式'\n when modename='生存模式' then '隧道'\n when submodename='广域战场模式' then '广域战场'\n when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n else '其他子模式'\n end playclass1,\n vplayerid,\n max(case when dtstatdate<'", "status": "success", "result": null}
{"sql_id": "sql_40", "sql": "\nwith monthly_users as (\n    select \n        substr(dtstatdate, 1, 6) as month,\n        vplayerid,\n        dregdate,\n        count(distinct case when substr(dtstatdate, 7, 2) between '01' and '31' then dtstatdate end) as active_days\n    from dws_jordass_login_di\n    where dtstatdate between '20240301' and '20240630'\n    group by substr(dtstatdate, 1, 6), vplayerid, dregdate\n),\n\nuser_types as (\n    select \n        m.month,\n        m.vplayerid,\n        case \n            when substr(m.dregdate, 1, 6) = m.month then 'new' -- 新进\n            when not exists (\n                select 1 from dws_jordass_login_di l \n                where l.vplayerid = m.vplayerid \n                and l.dtstatdate between date_format(date_sub(concat(m.month, '01'), interval 1 month), '%Y%m%d') \n                and date_format(last_day(date_sub(concat(m.month, '01'), interval 1 month)), '%Y%m%d')\n            ) then 'return' -- 回流\n            when m.active_days between 1 and 4 then 'light_retain' -- 轻度留存\n            when m.active_days between 5 and 15 then 'medium_retain' -- 中度留存\n            when m.active_days >= 16 then 'heavy_retain' -- 重度留存\n        end as user_type\n    from monthly_users m\n)\n\nselect \n    month,\n    count(distinct case when user_type = 'new' then vplayerid end) as new_users,\n    count(distinct case when user_type = 'return' then vplayerid end) as return_users,\n    count(distinct case when user_type = 'light_retain' then vplayerid end) as light_retain_users,\n    count(distinct case when user_type = 'medium_retain' then vplayerid end) as medium_retain_users,\n    count(distinct case when user_type = 'heavy_retain' then vplayerid end) as heavy_retain_users\nfrom user_types\ngroup by month\norder by month;\n", "status": "success", "result": null}
{"sql_id": "sql_41", "sql": "\nselect\n    dtstatdate as 统计日期,\n    count(distinct vplayerid) as 玩家数\nfrom dws_jordass_login_di\nwhere dtstatdate between '20240101' and '20240103'\ngroup by dtstatdate;\n", "status": "success", "result": [{"统计日期": "20240103", "玩家数": 69}, {"统计日期": "20240102", "玩家数": 73}, {"统计日期": "20240101", "玩家数": 90}]}
{"sql_id": "sql_42", "sql": "\nselect\n    dtstatdate as 日期,\n    split_part(extarg2, '_', 2) as extarg2_part,\n    count(distinct vplayerid) as 人数,\n    count(*) as 次数\nfrom dws_jordass_buttonpress_pre_di\nwhere dtstatdate between '20211101' and '20211130'\nand split_part(extarg2, '_', 2) in ('8', '16', '17')\ngroup by dtstatdate, split_part(extarg2, '_', 2)\norder by dtstatdate, extarg2_part;\n", "status": "success", "result": [{"日期": "20211101", "extarg2_part": "16", "人数": 8, "次数": 8}, {"日期": "20211101", "extarg2_part": "17", "人数": 8, "次数": 8}, {"日期": "20211101", "extarg2_part": "8", "人数": 10, "次数": 13}, {"日期": "20211102", "extarg2_part": "16", "人数": 2, "次数": 2}, {"日期": "20211102", "extarg2_part": "17", "人数": 2, "次数": 2}, {"日期": "20211102", "extarg2_part": "8", "人数": 2, "次数": 2}, {"日期": "20211103", "extarg2_part": "16", "人数": 2, "次数": 2}, {"日期": "20211103", "extarg2_part": "17", "人数": 2, "次数": 2}, {"日期": "20211103", "extarg2_part": "8", "人数": 2, "次数": 2}, {"日期": "20211104", "extarg2_part": "16", "人数": 2, "次数": 2}, {"日期": "20211104", "extarg2_part": "17", "人数": 2, "次数": 2}, {"日期": "20211104", "extarg2_part": "8", "人数": 2, "次数": 2}, {"日期": "20211105", "extarg2_part": "16", "人数": 2, "次数": 2}, {"日期": "20211105", "extarg2_part": "17", "人数": 2, "次数": 2}, {"日期": "20211105", "extarg2_part": "8", "人数": 2, "次数": 2}, {"日期": "20211106", "extarg2_part": "16", "人数": 2, "次数": 2}, {"日期": "20211106", "extarg2_part": "17", "人数": 2, "次数": 2}, {"日期": "20211106", "extarg2_part": "8", "人数": 2, "次数": 2}, {"日期": "20211107", "extarg2_part": "16", "人数": 2, "次数": 2}, {"日期": "20211107", "extarg2_part": "17", "人数": 2, "次数": 2}, {"日期": "20211107", "extarg2_part": "8", "人数": 2, "次数": 2}, {"日期": "20211108", "extarg2_part": "16", "人数": 2, "次数": 2}, {"日期": "20211108", "extarg2_part": "17", "人数": 2, "次数": 2}, {"日期": "20211108", "extarg2_part": "8", "人数": 2, "次数": 2}, {"日期": "20211109", "extarg2_part": "16", "人数": 2, "次数": 2}, {"日期": "20211109", "extarg2_part": "17", "人数": 2, "次数": 2}, {"日期": "20211109", "extarg2_part": "8", "人数": 2, "次数": 2}, {"日期": "20211110", "extarg2_part": "16", "人数": 2, "次数": 2}, {"日期": "20211110", "extarg2_part": "17", "人数": 2, "次数": 2}, {"日期": "20211110", "extarg2_part": "8", "人数": 2, "次数": 2}, {"日期": "20211111", "extarg2_part": "16", "人数": 2, "次数": 2}, {"日期": "20211111", "extarg2_part": "17", "人数": 2, "次数": 2}, {"日期": "20211111", "extarg2_part": "8", "人数": 2, "次数": 2}, {"日期": "20211112", "extarg2_part": "16", "人数": 2, "次数": 2}, {"日期": "20211112", "extarg2_part": "17", "人数": 2, "次数": 2}, {"日期": "20211112", "extarg2_part": "8", "人数": 2, "次数": 2}, {"日期": "20211113", "extarg2_part": "16", "人数": 2, "次数": 2}, {"日期": "20211113", "extarg2_part": "17", "人数": 2, "次数": 2}, {"日期": "20211113", "extarg2_part": "8", "人数": 2, "次数": 2}, {"日期": "20211114", "extarg2_part": "16", "人数": 2, "次数": 2}, {"日期": "20211114", "extarg2_part": "17", "人数": 2, "次数": 2}, {"日期": "20211114", "extarg2_part": "8", "人数": 2, "次数": 2}, {"日期": "20211115", "extarg2_part": "16", "人数": 2, "次数": 2}, {"日期": "20211115", "extarg2_part": "17", "人数": 2, "次数": 2}, {"日期": "20211115", "extarg2_part": "8", "人数": 2, "次数": 2}, {"日期": "20211116", "extarg2_part": "16", "人数": 2, "次数": 2}, {"日期": "20211116", "extarg2_part": "17", "人数": 2, "次数": 2}, {"日期": "20211116", "extarg2_part": "8", "人数": 2, "次数": 2}, {"日期": "20211117", "extarg2_part": "16", "人数": 2, "次数": 2}, {"日期": "20211117", "extarg2_part": "17", "人数": 2, "次数": 2}, {"日期": "20211117", "extarg2_part": "8", "人数": 2, "次数": 2}, {"日期": "20211118", "extarg2_part": "16", "人数": 2, "次数": 2}, {"日期": "20211118", "extarg2_part": "17", "人数": 2, "次数": 2}, {"日期": "20211118", "extarg2_part": "8", "人数": 2, "次数": 2}, {"日期": "20211119", "extarg2_part": "16", "人数": 2, "次数": 2}, {"日期": "20211119", "extarg2_part": "17", "人数": 2, "次数": 2}, {"日期": "20211119", "extarg2_part": "8", "人数": 2, "次数": 2}, {"日期": "20211120", "extarg2_part": "16", "人数": 2, "次数": 2}, {"日期": "20211120", "extarg2_part": "17", "人数": 2, "次数": 2}, {"日期": "20211120", "extarg2_part": "8", "人数": 2, "次数": 2}, {"日期": "20211121", "extarg2_part": "16", "人数": 2, "次数": 2}, {"日期": "20211121", "extarg2_part": "17", "人数": 2, "次数": 2}, {"日期": "20211121", "extarg2_part": "8", "人数": 2, "次数": 2}, {"日期": "20211122", "extarg2_part": "16", "人数": 2, "次数": 2}, {"日期": "20211122", "extarg2_part": "17", "人数": 2, "次数": 2}, {"日期": "20211122", "extarg2_part": "8", "人数": 2, "次数": 2}, {"日期": "20211123", "extarg2_part": "16", "人数": 2, "次数": 2}, {"日期": "20211123", "extarg2_part": "17", "人数": 2, "次数": 2}, {"日期": "20211123", "extarg2_part": "8", "人数": 2, "次数": 2}, {"日期": "20211124", "extarg2_part": "16", "人数": 2, "次数": 2}, {"日期": "20211124", "extarg2_part": "17", "人数": 2, "次数": 2}, {"日期": "20211124", "extarg2_part": "8", "人数": 2, "次数": 2}, {"日期": "20211125", "extarg2_part": "16", "人数": 2, "次数": 2}, {"日期": "20211125", "extarg2_part": "17", "人数": 2, "次数": 2}, {"日期": "20211125", "extarg2_part": "8", "人数": 2, "次数": 2}, {"日期": "20211126", "extarg2_part": "16", "人数": 2, "次数": 2}, {"日期": "20211126", "extarg2_part": "17", "人数": 2, "次数": 2}, {"日期": "20211126", "extarg2_part": "8", "人数": 2, "次数": 2}, {"日期": "20211127", "extarg2_part": "16", "人数": 2, "次数": 2}, {"日期": "20211127", "extarg2_part": "17", "人数": 2, "次数": 2}, {"日期": "20211127", "extarg2_part": "8", "人数": 2, "次数": 2}, {"日期": "20211128", "extarg2_part": "16", "人数": 2, "次数": 2}, {"日期": "20211128", "extarg2_part": "17", "人数": 2, "次数": 2}, {"日期": "20211128", "extarg2_part": "8", "人数": 2, "次数": 2}, {"日期": "20211129", "extarg2_part": "16", "人数": 2, "次数": 2}, {"日期": "20211129", "extarg2_part": "17", "人数": 2, "次数": 2}, {"日期": "20211129", "extarg2_part": "8", "人数": 2, "次数": 2}, {"日期": "20211130", "extarg2_part": "16", "人数": 2, "次数": 2}, {"日期": "20211130", "extarg2_part": "17", "人数": 2, "次数": 2}, {"日期": "20211130", "extarg2_part": "8", "人数": 2, "次数": 2}]}
{"sql_id": "sql_43", "sql": "\nselect \n    case \n        when active_days between 1 and 5 then '轻度'\n        when active_days between 6 and 15 then '中度'\n        when active_days > 16 then '重度'\n    end as activity_level,\n    count(distinct vplayerid) as user_count\nfrom (\n    select \n        vplayerid,\n        count(distinct dtstatdate) as active_days\n    from dws_jordass_login_di\n    where dtstatdate >= '20250101' and dtstatdate <= '20250131'\n    group by vplayerid\n) t\ngroup by \n    case \n        when active_days between 1 and 5 then '轻度'\n        when active_days between 6 and 15 then '中度'\n        when active_days > 16 then '重度'\n    end;\n", "status": "success", "result": [{"activity_level": "轻度", "user_count": 20}, {"activity_level": "中度", "user_count": 7}, {"activity_level": "重度", "user_count": 6}]}
{"sql_id": "sql_44", "sql": "\nselect\n    case \n        when total_pay <= 12 then '小R'\n        when total_pay > 12 and total_pay <= 60 then '中R'\n        when total_pay > 60 and total_pay <= 180 then '大R'\n        when total_pay > 180 then '超R'\n        else '未知'\n    end as pay_tier,\n    count(distinct vplayerid) as pay_user_count,\n    round(sum(total_pay), 2) as pay_amount\nfrom (\n    select\n        vplayerid,\n        sum(imoney/100) as total_pay\n    from dws_jordass_water_di\n    where dtstatdate >= '20240101' and dtstatdate <= '20241231'\n    group by vplayerid\n) t\ngroup by \n    case \n        when total_pay <= 12 then '小R'\n        when total_pay > 12 and total_pay <= 60 then '中R'\n        when total_pay > 60 and total_pay <= 180 then '大R'\n        when total_pay > 180 then '超R'\n        else '未知'\n    end;\n", "status": "success", "result": [{"pay_tier": "超R", "pay_user_count": 245, "pay_amount": 138889089814.7}, {"pay_tier": "大R", "pay_user_count": 159, "pay_amount": 17191.2}, {"pay_tier": "小R", "pay_user_count": 166, "pay_amount": 963.5}, {"pay_tier": "中R", "pay_user_count": 212, "pay_amount": 6626.9}]}
{"sql_id": "sql_45", "sql": "\nselect count(distinct a.vplayerid) as player_num\nfrom (\n select distinct vplayerid\n from dws_jordass_matchlog_stat_di\n where dtstatdate between '20240101' and '20240107'\n and imode = 1287652322611036928\n) a\nleft join (\n select distinct vplayerid\n from dws_jordass_matchlog_stat_di\n where dtstatdate between '20240108' and '20240114'\n and imode = 1287652322611036928\n) b on a.vplayerid = b.vplayerid\njoin (\n select distinct vplayerid\n from dws_jordass_matchlog_stat_di\n where dtstatdate between '20240115' and '20240121'\n and imode = 1287652322611036928\n) c on a.vplayerid = c.vplayerid\nwhere b.vplayerid is null;\n", "status": "success", "result": [{"player_num": 114}]}
{"sql_id": "sql_46", "sql": "\nselect\n weekofyear(dtstatdate) as week, -- 统计周\n count(distinct dtstatdate) as active_days, -- 活跃天数\n count(distinct vplayerid) as user_num -- 玩家数\nfrom dws_jordass_login_di\nwhere dtstatdate >= '20240101' and dtstatdate <= '20240202'\ngroup by\n weekofyear(dtstatdate),\n count(distinct dtstatdate);\n", "status": "success", "result": null}
{"sql_id": "sql_47", "sql": "\nselect count(distinct a.vplayerid) as player_count\nfrom (\n    select distinct vplayerid\n    from dws_jordass_login_di\n    where dtstatdate between '20230701' and '20230831'\n    and vgameappid = 'wx'\n) a\njoin (\n    select distinct vplayerid\n    from dws_jordass_water_di\n    where dtstatdate between '20230701' and '20230831'\n    and vgameappid = 'wx'\n) b on a.vplayerid = b.vplayerid\nleft join (\n    select distinct vplayerid\n    from dws_jordass_login_di\n    where dtstatdate between '20230901' and '20230921'\n    and vgameappid = 'wx'\n) c on a.vplayerid = c.vplayerid\nwhere c.vplayerid is null;\n", "status": "success", "result": [{"player_count": 74}]}
{"sql_id": "sql_48", "sql": "\nselect\n    count(distinct case when is_backflow_7 then vplayerid end) as backflow_7_user,\n    count(distinct case when is_backflow_30 then vplayerid end) as backflow_30_user\nfrom (\n    select\n        vplayerid,\n        -- 检查是否满足流失7天回流条件\n        (instr(substr(cbitmap, 1, 1), '1') > 0) and\n        (instr(substr(cbitmap, 2, 7), '1') = 0) as is_backflow_7,\n        \n        -- 检查是否满足流失30天回流条件\n        (instr(substr(cbitmap, 1, 1), '1') > 0) and\n        (instr(substr(cbitmap, 2, 30), '1') = 0) as is_backflow_30\n    from\n        dws_jordass_login_df\n    where\n        dtstatdate = '20231201'\n        and platid = 255\n) as user_flags;\n", "status": "success", "result": [{"backflow_7_user": 88, "backflow_30_user": 72}]}
{"sql_id": "sql_49", "sql": "\nwith play_user as (\n    select distinct\n        p.dtstatdate as ds,\n        p.vplayerid\n    from\n        dws_jordass_matchlog_stat_di p\n    join\n        dim_jordass_submodeonline_nf c\n    on\n        p.imode = c.matchsubmodegroup\n    where\n        p.dtstatdate between '20241001' and '20241008'\n        and datediff('20241001', c.onlinedate) >= 7\n        and datediff('20241007', c.onlinedate) <= 90\n)\nselect\n    '20241001-20241007' as period,\n    a.ds,\n    count(distinct a.vplayerid) as play_user_num,\n    count(distinct b.vplayerid) as retention_user_num\nfrom\n    play_user a\nleft join\n    play_user b\non\n    a.vplayerid = b.vplayerid\n    and b.ds = date_add(a.ds, 1)\nwhere\n    a.ds between '20241001' and '20241007'\ngroup by\n    a.ds\norder by\n    a.ds;\n", "status": "success", "result": [{"period": "20241001-20241007", "ds": "20241001", "play_user_num": 137, "retention_user_num": 17}, {"period": "20241001-20241007", "ds": "20241002", "play_user_num": 120, "retention_user_num": 13}, {"period": "20241001-20241007", "ds": "20241003", "play_user_num": 136, "retention_user_num": 15}, {"period": "20241001-20241007", "ds": "20241004", "play_user_num": 110, "retention_user_num": 21}, {"period": "20241001-20241007", "ds": "20241005", "play_user_num": 134, "retention_user_num": 22}, {"period": "20241001-20241007", "ds": "20241006", "play_user_num": 111, "retention_user_num": 18}, {"period": "20241001-20241007", "ds": "20241007", "play_user_num": 113, "retention_user_num": 13}]}
{"sql_id": "sql_50", "sql": "\nwith button_clicks as (\n    select \n        vplayerid,\n        max(case when buttontype = '400211' then 1 else 0 end) as clicked_400211,\n        max(case when buttontype = '400212' then 1 else 0 end) as clicked_400212\n    from dws_jordass_buttonpress_pre_di\n    where dtstatdate between '20241001' and '20241031'\n    group by vplayerid\n),\nuser_types as (\n    select\n        vplayerid,\n        case \n            when clicked_400211 = 1 and clicked_400212 = 1 then '400211&400212'\n            when clicked_400211 = 1 then '400211'\n            when clicked_400212 = 1 then '400212'\n            else 'other'\n        end as user_type\n    from button_clicks\n),\ngender_info as (\n    select \n        vplayerid,\n        case \n            when gender = 1 then 'male'\n            when gender = 2 then 'female'\n            else 'other'\n        end as gender_type\n    from (\n        select \n            vplayerid, \n            gender,\n            row_number() over (partition by vplayerid order by dteventtime desc) as rn\n        from dwd_jordass_playerlogin_hi\n    ) t\n    where rn = 1\n),\njordass_activity as (\n    select\n        vplayerid,\n        case\n            when sum(ilogincount) between 1 and 4 then 'light'\n            when sum(ilogincount) between 5 and 15 then 'medium'\n            when sum(ilogincount) >= 16 then 'heavy'\n            else 'other'\n        end as jordass_activity\n    from dws_jordass_login_di\n    where dtstatdate between '20241001' and '20241031'\n    group by vplayerid\n),\nleyan_activity as (\n    select\n        vplayerid,\n        case\n            when sum(case when icnt > 0 then 1 else 0 end) between 1 and 4 then 'light'\n            when sum(case when icnt > 0 then 1 else 0 end) between 5 and 15 then 'medium'\n            when sum(case when icnt > 0 then 1 else 0 end) >= 16 then 'heavy'\n            else 'other'\n        end as leyan_activity\n    from dws_jordass_matchlog_stat_di\n    where dtstatdate between '20241001' and '20241031'\n    group by vplayerid\n)\nselect\n    u.user_type,\n    g.gender_type,\n    l.leyan_activity,\n    j.jordass_activity,\n    count(distinct u.vplayerid) as user_count\nfrom user_types u\nleft join gender_info g on u.vplayerid = g.vplayerid\nleft join leyan_activity l on u.vplayerid = l.vplayerid\nleft join jordass_activity j on u.vplayerid = j.vplayerid\ngroup by \n    u.user_type,\n    g.gender_type,\n    l.leyan_activity,\n    j.jordass_activity\norder by \n    u.user_type,\n    g.gender_type,\n    l.leyan_activity,\n    j.jordass_activity;\n", "status": "success", "result": [{"user_type": "400211", "gender_type": "female", "leyan_activity": null, "jordass_activity": null, "user_count": 5}, {"user_type": "400211", "gender_type": "female", "leyan_activity": "heavy", "jordass_activity": "heavy", "user_count": 1}, {"user_type": "400211", "gender_type": "male", "leyan_activity": "light", "jordass_activity": "heavy", "user_count": 1}, {"user_type": "400211&400212", "gender_type": "male", "leyan_activity": null, "jordass_activity": null, "user_count": 1}, {"user_type": "400212", "gender_type": "female", "leyan_activity": null, "jordass_activity": null, "user_count": 1}, {"user_type": "400212", "gender_type": "male", "leyan_activity": null, "jordass_activity": null, "user_count": 6}, {"user_type": "other", "gender_type": null, "leyan_activity": null, "jordass_activity": null, "user_count": 15}]}
{"sql_id": "sql_51", "sql": "\nselect \n    '时间段1' as time_period,\n    count(distinct case when p1.vplayerid is not null then p1.vplayerid end) as period1_users,\n    count(distinct case when p1.vplayerid is not null and p2.vplayerid is not null then p1.vplayerid end) as both_periods_users\nfrom (\n    select distinct vplayerid\n    from dws_jordass_buttonpress_pre_di\n    where dteventtime between '2024-11-08' and '2024-11-21'\n) p1\nleft join (\n    select distinct vplayerid\n    from dws_jordass_buttonpress_pre_di\n    where dteventtime between '2024-11-22' and '2024-12-04'\n) p2 on p1.vplayerid = p2.vplayerid\n\nunion all\n\nselect \n    '时间段2' as time_period,\n    count(distinct case when p1.vplayerid is not null then p1.vplayerid end) as period1_users,\n    count(distinct case when p1.vplayerid is not null and p2.vplayerid is not null then p1.vplayerid end) as both_periods_users\nfrom (\n    select distinct vplayerid\n    from dws_jordass_buttonpress_pre_di\n    where dteventtime between '2024-11-10' and '2024-11-23'\n) p1\nleft join (\n    select distinct vplayerid\n    from dws_jordass_buttonpress_pre_di\n    where dteventtime between '2024-11-24' and '2024-12-04'\n) p2 on p1.vplayerid = p2.vplayerid\n\nunion all\n\nselect \n    '时间段3' as time_period,\n    count(distinct case when p1.vplayerid is not null then p1.vplayerid end) as period1_users,\n    count(distinct case when p1.vplayerid is not null and p2.vplayerid is not null then p1.vplayerid end) as both_periods_users\nfrom (\n    select distinct vplayerid\n    from dws_jordass_buttonpress_pre_di\n    where dteventtime between '2024-11-15' and '2024-11-28'\n) p1\nleft join (\n    select distinct vplayerid\n    from dws_jordass_buttonpress_pre_di\n    where dteventtime between '2024-11-29' and '2024-12-04'\n) p2 on p1.vplayerid = p2.vplayerid\n\nunion all\n\nselect \n    '时间段4' as time_period,\n    count(distinct case when p1.vplayerid is not null then p1.vplayerid end) as period1_users,\n    count(distinct case when p1.vplayerid is not null and p2.vplayerid is not null then p1.vplayerid end) as both_periods_users\nfrom (\n    select distinct vplayerid\n    from dws_jordass_buttonpress_pre_di\n    where dteventtime between '2024-11-17' and '2024-11-30'\n) p1\nleft join (\n    select distinct vplayerid\n    from dws_jordass_buttonpress_pre_di\n    where dteventtime between '2024-12-01' and '2024-12-04'\n) p2 on p1.vplayerid = p2.vplayerid;\n", "status": "success", "result": [{"time_period": "时间段1", "period1_users": 63, "both_periods_users": 43}, {"time_period": "时间段4", "period1_users": 77, "both_periods_users": 15}, {"time_period": "时间段2", "period1_users": 69, "both_periods_users": 39}, {"time_period": "时间段3", "period1_users": 75, "both_periods_users": 23}]}
{"sql_id": "sql_52", "sql": "\nWITH subgame_participation AS (\n    SELECT \n        imode,\n        SUM(icnt) AS total_matches\n    FROM \n        dws_jordass_matchlog_stat_di\n    WHERE \n        dtstatdate BETWEEN '20241001' AND '20241008'\n    GROUP BY \n        imode\n    ORDER BY \n        total_matches ASC\n    LIMIT (SELECT COUNT(DISTINCT imode) * 0.2 FROM dws_jordass_matchlog_stat_di WHERE dtstatdate BETWEEN '20241001' AND '20241008')\n),\ntarget_users AS (\n    SELECT DISTINCT \n        vplayerid\n    FROM \n        dws_jordass_matchlog_stat_di\n    WHERE \n        dtstatdate BETWEEN '20241001' AND '20241008'\n        AND imode IN (SELECT imode FROM subgame_participation)\n),\ndaily_participation AS (\n    SELECT \n        dtstatdate,\n        vplayerid,\n        COUNT(DISTINCT imode) AS participation_count\n    FROM \n        dws_jordass_matchlog_stat_di\n    WHERE \n        dtstatdate BETWEEN '20241001' AND '20241008'\n        AND vplayerid IN (SELECT vplayerid FROM target_users)\n    GROUP BY \n        dtstatdate, vplayerid\n)\n\nSELECT \n    dtstatdate AS stat_date,\n    CASE \n        WHEN participation_count = 1 THEN '1'\n        WHEN participation_count = 2 THEN '2'\n        WHEN participation_count = 3 THEN '3'\n        WHEN participation_count = 4 THEN '4'\n        WHEN participation_count = 5 THEN '5'\n        WHEN participation_count BETWEEN 6 AND 10 THEN '6-10'\n        WHEN participation_count BETWEEN 11 AND 20 THEN '11-20'\n        ELSE '21以上'\n    END AS participation_distribution,\n    COUNT(DISTINCT vplayerid) AS user_count\nFROM \n    daily_participation\nGROUP BY \n    dtstatdate,\n    CASE \n        WHEN participation_count = 1 THEN '1'\n        WHEN participation_count = 2 THEN '2'\n        WHEN participation_count = 3 THEN '3'\n        WHEN participation_count = 4 THEN '4'\n        WHEN participation_count = 5 THEN '5'\n        WHEN participation_count BETWEEN 6 AND 10 THEN '6-10'\n        WHEN participation_count BETWEEN 11 AND 20 THEN '11-20'\n        ELSE '21以上'\n    END\nORDER BY \n    dtstatdate,\n    participation_distribution;\n", "status": "success", "result": null}
{"sql_id": "sql_53", "sql": "\nwith backflow_users as (\n    select distinct a.vplayerid\n    from dws_jordass_login_di a\n    join dws_jordass_login_df b on a.vplayerid = b.vplayerid\n    where a.dtstatdate between '20241021' and '20241121'\n      and b.dregdate < '20241021'\n      and not exists (\n          select 1 \n          from dws_jordass_login_di c \n          where c.vplayerid = a.vplayerid \n            and c.dtstatdate between '20241014' and '20241020'\n      )\n),\nactivity_segments as (\n    select \n        count(distinct bu.vplayerid) as backflow_count,\n        count(distinct case when exists (\n            select 1 \n            from dws_jordass_login_di d \n            where d.vplayerid = bu.vplayerid \n              and d.dtstatdate between '20241007' and '20241013'\n        ) then bu.vplayerid end) as active_8_14,\n        count(distinct case when exists (\n            select 1 \n            from dws_jordass_login_di d \n            where d.vplayerid = bu.vplayerid \n              and d.dtstatdate between '20240921' and '20241006'\n        ) then bu.vplayerid end) as active_15_29,\n        count(distinct case when exists (\n            select 1 \n            from dws_jordass_login_di d \n            where d.vplayerid = bu.vplayerid \n              and d.dtstatdate between '20240822' and '20240920'\n        ) then bu.vplayerid end) as active_30_59,\n        count(distinct case when exists (\n            select 1 \n            from dws_jordass_login_di d \n            where d.vplayerid = bu.vplayerid \n              and d.dtstatdate between '20240424' and '20240821'\n        ) then bu.vplayerid end) as active_60_179,\n        count(distinct case when exists (\n            select 1 \n            from dws_jordass_login_di d \n            where d.vplayerid = bu.vplayerid \n              and d.dtstatdate between '20231022' and '20240423'\n        ) then bu.vplayerid end) as active_180_364\n    from backflow_users bu\n)\nselect \n    backflow_count as 回流用户量级,\n    active_8_14 as 前8_14天有活跃的用户量级,\n    active_15_29 as 前15_29天有活跃的用户量级,\n    active_30_59 as 前30_59天有活跃的用户量级,\n    active_60_179 as 前60_179天有活跃的用户量级,\n    active_180_364 as 前180_364天有活跃的用户量级\nfrom activity_segments;\n", "status": "success", "result": [{"回流用户量级": 0, "前8_14天有活跃的用户量级": 0, "前15_29天有活跃的用户量级": 0, "前30_59天有活跃的用户量级": 0, "前60_179天有活跃的用户量级": 0, "前180_364天有活跃的用户量级": 0}]}
{"sql_id": "sql_54", "sql": "\nwith play_daily as (\n    select \n        d.modename as play_name,\n        d.startdate as online_date,\n        d.enddate as offline_date,\n        date_format(p.dteventtime, '%Y%m%d') as stat_date,\n        p.vplayerid\n    from \n        dwd_jordass_player_matchrecord_hi p\n    join \n        dim_jordass_imode_leyuan_nf d\n    on \n        p.matchmode = d.imode\n    where \n        p.matchmode = 1003\n        and p.dteventtime between '2024-09-20' and '2024-10-20'\n        and p.matchresult = 'success'\n    group by \n        d.modename, d.startdate, d.enddate, date_format(p.dteventtime, '%Y%m%d'), p.vplayerid\n),\nretention_daily as (\n    select \n        a.play_name,\n        a.online_date,\n        a.offline_date,\n        a.stat_date,\n        count(distinct a.vplayerid) as daily_players,\n        count(distinct b.vplayerid) as retained_players\n    from \n        play_daily a\n    left join \n        play_daily b\n    on \n        a.play_name = b.play_name\n        and a.vplayerid = b.vplayerid\n        and b.stat_date = date_add(a.stat_date, 1)\n    group by \n        a.play_name, a.online_date, a.offline_date, a.stat_date\n)\nselect \n    play_name as '玩法',\n    online_date as '上线日期',\n    offline_date as '下线日期',\n    avg(daily_players) as '日均参与人数',\n    avg(case when retained_players > 0 then retained_players*1.0/daily_players else 0 end) as '日均玩法次留'\nfrom \n    retention_daily\ngroup by \n    play_name, online_date, offline_date;\n", "status": "success", "result": []}
{"sql_id": "sql_55", "sql": "\nWITH date_range AS (\n    SELECT date_add('20241101', seq) as stat_date\n    FROM (\n        SELECT explode(sequence(0, datediff('20241130', '20241101'))) as seq\n    ) t\n),\nrecent_modes AS (\n    SELECT \n        d.stat_date,\n        m.matchsubmodegroupname,\n        m.matchsubmodegroup\n    FROM date_range d\n    JOIN dim_jordass_submodeonline_nf m\n    ON datediff(d.stat_date, m.onlinedate) <= 180\n),\nparticipation AS (\n    SELECT \n        r.stat_date,\n        r.matchsubmodegroupname,\n        AVG(m.icnt / NULLIF(l.ilogincount, 0)) AS avg_participation_rate\n    FROM recent_modes r\n    JOIN dws_jordass_matchlog_stat_di m\n    ON r.matchsubmodegroup = m.imode\n    AND m.dtstatdate BETWEEN date_sub(r.stat_date, 6) AND r.stat_date\n    JOIN dws_jordass_login_di l\n    ON m.dtstatdate = l.dtstatdate\n    AND m.vplayerid = l.vplayerid\n    GROUP BY r.stat_date, r.matchsubmodegroupname\n),\nretention AS (\n    SELECT \n        r.stat_date,\n        r.matchsubmodegroupname,\n        AVG(CASE WHEN next_day.ilogincount > 0 THEN 1 ELSE 0 END) AS next_day_retention,\n        AVG(CASE WHEN day_7.ilogincount > 0 THEN 1 ELSE 0 END) AS day_7_retention\n    FROM recent_modes r\n    JOIN dws_jordass_matchlog_stat_di m\n    ON r.matchsubmodegroup = m.imode\n    AND m.dtstatdate BETWEEN date_sub(r.stat_date, 6) AND r.stat_date\n    JOIN dws_jordass_login_di l\n    ON m.dtstatdate = l.dtstatdate\n    AND m.vplayerid = l.vplayerid\n    LEFT JOIN dws_jordass_login_di next_day\n    ON date_add(m.dtstatdate, 1) = next_day.dtstatdate\n    AND m.vplayerid = next_day.vplayerid\n    LEFT JOIN dws_jordass_login_di day_7\n    ON date_add(m.dtstatdate, 7) = day_7.dtstatdate\n    AND m.vplayerid = day_7.vplayerid\n    GROUP BY r.stat_date, r.matchsubmodegroupname\n),\nrankings AS (\n    SELECT \n        p.stat_date,\n        p.matchsubmodegroupname,\n        RANK() OVER (PARTITION BY p.stat_date ORDER BY p.avg_participation_rate DESC) AS participation_rank,\n        RANK() OVER (PARTITION BY p.stat_date ORDER BY r.next_day_retention DESC) AS next_day_rank,\n        RANK() OVER (PARTITION BY p.stat_date ORDER BY r.day_7_retention DESC) AS day_7_rank\n    FROM participation p\n    JOIN retention r\n    ON p.stat_date = r.stat_date\n    AND p.matchsubmodegroupname = r.matchsubmodegroupname\n)\nSELECT \n    stat_date,\n    matchsubmodegroupname,\n    participation_rank,\n    next_day_rank,\n    day_7_rank,\n    participation_rank + next_day_rank + day_7_rank AS total_rank\nFROM rankings\nORDER BY stat_date, total_rank;\n", "status": "success", "result": null}
{"sql_id": "sql_56", "sql": "\nselect\n    register_date,\n    count(distinct vplayerid) as new_user_cnt,\n    round(sum(case when datediff_pay < 1 then sum_pay_amount else 0 end) / count(distinct vplayerid), 2) as ltv1,\n    round(sum(case when datediff_pay < 3 then sum_pay_amount else 0 end) / count(distinct vplayerid), 2) as ltv3,\n    round(sum(case when datediff_pay < 7 then sum_pay_amount else 0 end) / count(distinct vplayerid), 2) as ltv7,\n    round(sum(case when datediff_pay < 14 then sum_pay_amount else 0 end) / count(distinct vplayerid), 2) as ltv14,\n    round(sum(case when datediff_pay < 30 then sum_pay_amount else 0 end) / count(distinct vplayerid), 2) as ltv30,\n    round(sum(case when datediff_pay < 60 then sum_pay_amount else 0 end) / count(distinct vplayerid), 2) as ltv60,\n    round(sum(case when datediff_pay < 90 then sum_pay_amount else 0 end) / count(distinct vplayerid), 2) as ltv90,\n    round(sum(case when datediff_pay < 180 then sum_pay_amount else 0 end) / count(distinct vplayerid), 2) as ltv180\nfrom (\n    select\n        s1.register_date,\n        s1.vplayerid,\n        s2.pay_date,\n        datediff(s2.pay_date, s1.register_date) as datediff_pay,\n        sum(s2.pay_amount) as sum_pay_amount\n    from (\n        select\n            distinct dregdate as register_date,\n            vplayerid\n        from dws_jordass_login_df\n        where dtstatdate = '20240131'\n          and platid = 255\n          and dregdate >= '20240101' and dregdate <= '20240131'\n    ) s1\n    left join (\n        select\n            dtstatdate as pay_date,\n            vplayerid,\n            sum(imoney/100) as pay_amount\n        from dws_jordass_water_di\n        where dtstatdate >= '20240101' and dtstatdate <= date_add('20240131', 179)\n          and platid = 255\n        group by dtstatdate, vplayerid\n    ) s2 on s1.vplayerid = s2.vplayerid\n    group by s1.register_date, s1.vplayerid, s2.pay_date\n) base\ngroup by register_date;\n", "status": "success", "result": [{"register_date": "20240111", "new_user_cnt": 31, "ltv1": 3.81, "ltv3": 3.81, "ltv7": 3.81, "ltv14": 3.84, "ltv30": 12.48, "ltv60": 27, "ltv90": 36.42, "ltv180": 110.68}, {"register_date": "20240119", "new_user_cnt": 42, "ltv1": 0, "ltv3": 7.14, "ltv7": 7.14, "ltv14": 7.14, "ltv30": 12.07, "ltv60": 27.83, "ltv90": 30.33, "ltv180": 78.4}, {"register_date": "20240121", "new_user_cnt": 22, "ltv1": 0, "ltv3": 0, "ltv7": 0, "ltv14": 0.14, "ltv30": 59.82, "ltv60": 66.82, "ltv90": 99.05, "ltv180": 299}, {"register_date": "20240109", "new_user_cnt": 20, "ltv1": 0, "ltv3": 0, "ltv7": 0, "ltv14": 13.9, "ltv30": 17.1, "ltv60": 25.2, "ltv90": 34.5, "ltv180": 43.65}, {"register_date": "20240130", "new_user_cnt": 31, "ltv1": 0, "ltv3": 0, "ltv7": 0, "ltv14": 0, "ltv30": 1.45, "ltv60": 10.42, "ltv90": 28.29, "ltv180": 71.94}, {"register_date": "20240101", "new_user_cnt": 51, "ltv1": 24.04, "ltv3": 24.04, "ltv7": 69.12, "ltv14": 69.35, "ltv30": 79.9, "ltv60": 107.98, "ltv90": 121, "ltv180": 229.24}, {"register_date": "20240112", "new_user_cnt": 30, "ltv1": 0.2, "ltv3": 1, "ltv7": 1, "ltv14": 2.2, "ltv30": 116.57, "ltv60": 133.97, "ltv90": 134.37, "ltv180": 345.43}, {"register_date": "20240115", "new_user_cnt": 33, "ltv1": 0, "ltv3": 0.18, "ltv7": 0.73, "ltv14": 6.12, "ltv30": 76, "ltv60": 85.7, "ltv90": 91.94, "ltv180": 174.55}, {"register_date": "20240129", "new_user_cnt": 29, "ltv1": 0, "ltv3": 3.1, "ltv7": 3.1, "ltv14": 4.76, "ltv30": 36.55, "ltv60": 111.17, "ltv90": 146.07, "ltv180": 307.41}, {"register_date": "20240125", "new_user_cnt": 25, "ltv1": 0, "ltv3": 0, "ltv7": 0, "ltv14": 24.64, "ltv30": 25.72, "ltv60": 156.95, "ltv90": 225.43, "ltv180": 238.35}, {"register_date": "20240114", "new_user_cnt": 39, "ltv1": 0, "ltv3": 0.15, "ltv7": 223.15, "ltv14": 223.15, "ltv30": 228.1, "ltv60": 279.95, "ltv90": 307.44, "ltv180": 374.21}, {"register_date": "20240103", "new_user_cnt": 29, "ltv1": 0.21, "ltv3": 3.31, "ltv7": 3.31, "ltv14": 3.31, "ltv30": 5.03, "ltv60": 47.66, "ltv90": 52.76, "ltv180": 121.66}, {"register_date": "20240126", "new_user_cnt": 27, "ltv1": 0, "ltv3": 0, "ltv7": 0, "ltv14": 0, "ltv30": 3.37, "ltv60": 4.07, "ltv90": 191.52, "ltv180": 327.11}, {"register_date": "20240128", "new_user_cnt": 28, "ltv1": 7.07, "ltv3": 7.07, "ltv7": 15.21, "ltv14": 15.21, "ltv30": 23.43, "ltv60": 37.71, "ltv90": 48.57, "ltv180": 76.61}, {"register_date": "20240122", "new_user_cnt": 23, "ltv1": 0, "ltv3": 0, "ltv7": 0, "ltv14": 0, "ltv30": 10.3, "ltv60": 64.39, "ltv90": 68.61, "ltv180": 132.48}, {"register_date": "20240104", "new_user_cnt": 19, "ltv1": 10.42, "ltv3": 10.42, "ltv7": 115.58, "ltv14": 117.84, "ltv30": 147.42, "ltv60": 215.95, "ltv90": 222.78, "ltv180": 272.99}, {"register_date": "20240107", "new_user_cnt": 39, "ltv1": 0, "ltv3": 0.33, "ltv7": 0.33, "ltv14": 6.51, "ltv30": 20.26, "ltv60": 59.46, "ltv90": 104.56, "ltv180": 197.54}, {"register_date": "20240110", "new_user_cnt": 32, "ltv1": 0.56, "ltv3": 7.44, "ltv7": 27.91, "ltv14": 42.34, "ltv30": 63.28, "ltv60": 98.75, "ltv90": 129.5, "ltv180": 212.47}, {"register_date": "20240113", "new_user_cnt": 45, "ltv1": 0, "ltv3": 0.67, "ltv7": 0.67, "ltv14": 3.56, "ltv30": 29.69, "ltv60": 49.6, "ltv90": 56.18, "ltv180": 79.36}, {"register_date": "20240131", "new_user_cnt": 34, "ltv1": 0, "ltv3": 0, "ltv7": 0, "ltv14": 7.53, "ltv30": 36.26, "ltv60": 63.97, "ltv90": 74.65, "ltv180": 102.15}, {"register_date": "20240124", "new_user_cnt": 32, "ltv1": 0, "ltv3": 2.44, "ltv7": 2.44, "ltv14": 3.41, "ltv30": 4.16, "ltv60": 9.97, "ltv90": 22.22, "ltv180": 58.31}, {"register_date": "20240106", "new_user_cnt": 36, "ltv1": 0.5, "ltv3": 0.5, "ltv7": 0.5, "ltv14": 0.58, "ltv30": 1.53, "ltv60": 58.92, "ltv90": 67.08, "ltv180": 139.89}, {"register_date": "20240123", "new_user_cnt": 32, "ltv1": 0, "ltv3": 0.03, "ltv7": 1.38, "ltv14": 1.38, "ltv30": 1.38, "ltv60": 165.25, "ltv90": 172.97, "ltv180": 249.63}, {"register_date": "20240105", "new_user_cnt": 40, "ltv1": 0, "ltv3": 3.65, "ltv7": 7.05, "ltv14": 7.05, "ltv30": 22.95, "ltv60": 106.95, "ltv90": 294.1, "ltv180": 403.53}, {"register_date": "20240120", "new_user_cnt": 47, "ltv1": 0, "ltv3": 0.17, "ltv7": 0.17, "ltv14": 2.89, "ltv30": 18.15, "ltv60": 98.91, "ltv90": 108.32, "ltv180": 134.02}, {"register_date": "20240127", "new_user_cnt": 36, "ltv1": 0, "ltv3": 0, "ltv7": 0, "ltv14": 0, "ltv30": 107.25, "ltv60": 195.78, "ltv90": 263.36, "ltv180": 474.78}, {"register_date": "20240102", "new_user_cnt": 32, "ltv1": 7.56, "ltv3": 7.59, "ltv7": 7.59, "ltv14": 7.59, "ltv30": 8.72, "ltv60": 23.94, "ltv90": 62.28, "ltv180": 149.53}, {"register_date": "20240117", "new_user_cnt": 27, "ltv1": 0, "ltv3": 0, "ltv7": 0.96, "ltv14": 2.3, "ltv30": 48.33, "ltv60": 91, "ltv90": 163.81, "ltv180": 233.59}, {"register_date": "20240108", "new_user_cnt": 28, "ltv1": 0, "ltv3": 0, "ltv7": 0, "ltv14": 6.29, "ltv30": 9.39, "ltv60": 55.11, "ltv90": 60.93, "ltv180": 85.82}, {"register_date": "20240118", "new_user_cnt": 29, "ltv1": 0, "ltv3": 11.66, "ltv7": 14.69, "ltv14": 19.38, "ltv30": 41.86, "ltv60": 60.69, "ltv90": 67.07, "ltv180": 143.52}, {"register_date": "20240116", "new_user_cnt": 32, "ltv1": 4.59, "ltv3": 4.78, "ltv7": 4.78, "ltv14": 5.22, "ltv30": 6.53, "ltv60": 40.5, "ltv90": 77.22, "ltv180": 215.13}]}
{"sql_id": "sql_57", "sql": "\n-- 查询限定抽取阶梯活动相关数据\nselect\n    dtstatdate,\n    pv,\n    uv\nfrom (\n    -- 按天统计\n    select\n        substr(dteventtime, 1, 8) as dtstatdate,\n        count(*) as pv,\n        count(distinct vplayerid) as uv\n    from dwd_jordass_activitypress_hi\n    where substr(dteventtime, 1, 8) between '20241129' and '20241219'\n      and ireason = 2411291018\n    group by substr(dteventtime, 1, 8)\n\n    union all\n\n    -- 汇总\n    select\n        '汇总' as dtstatdate,\n        count(*) as pv,\n        count(distinct vplayerid) as uv\n    from dwd_jordass_activitypress_hi\n    where substr(dteventtime, 1, 8) between '20241129' and '20241219'\n      and ireason = 2411291018\n) f\norder by case when dtstatdate = '汇总' then 1 else 0 end, dtstatdate;\n", "status": "success", "result": [{"dtstatdate": "汇总", "pv": 0, "uv": 0}]}
{"sql_id": "sql_58", "sql": "\nselect \n    imode,\n    case \n        when itemp1 < 600 then '[0-10min)'\n        when itemp1 < 1800 then '[10-30min)'\n        when itemp1 < 3600 then '[30min-1h)'\n        when itemp1 < 7200 then '[1h,2h)'\n        when itemp1 < 10800 then '[2h,3h)'\n        when itemp1 < 14400 then '[3h,4h)'\n        when itemp1 < 18000 then '[4h,5h)'\n        when itemp1 < 21600 then '[5h,6h)'\n        when itemp1 < 25200 then '[6h,7h)'\n        when itemp1 < 28800 then '[7h,8h)'\n        when itemp1 < 32400 then '[8h,9h)'\n        when itemp1 < 36000 then '[9h,10h)'\n        else '[10h,∞)'\n    end as duration_range,\n    count(distinct vplayerid) as user_count\nfrom dws_jordass_matchlog_stat_di\nwhere \n    ((dtstatdate between '20230717' and '20230723') and imode = 1310822585431254784) or\n    ((dtstatdate between '20221116' and '20221122') and imode = 1282371711108385024) or\n    ((dtstatdate between '20221123' and '20221129') and imode = 1287652322611036928) or\n    ((dtstatdate between '20230301' and '20230307') and imode = 1294211358396518400) or\n    ((dtstatdate between '20230607' and '20230613') and imode = 1297394991875754752)\ngroup by \n    imode,\n    case \n        when itemp1 < 600 then '[0-10min)'\n        when itemp1 < 1800 then '[10-30min)'\n        when itemp1 < 3600 then '[30min-1h)'\n        when itemp1 < 7200 then '[1h,2h)'\n        when itemp1 < 10800 then '[2h,3h)'\n        when itemp1 < 14400 then '[3h,4h)'\n        when itemp1 < 18000 then '[4h,5h)'\n        when itemp1 < 21600 then '[5h,6h)'\n        when itemp1 < 25200 then '[6h,7h)'\n        when itemp1 < 28800 then '[7h,8h)'\n        when itemp1 < 32400 then '[8h,9h)'\n        when itemp1 < 36000 then '[9h,10h)'\n        else '[10h,∞)'\n    end\norder by \n    imode,\n    duration_range;\n", "status": "success", "result": [{"imode": 1310822585431254784, "duration_range": "[0-10min)", "user_count": 6}]}
{"sql_id": "sql_59", "sql": "\nselect \n    s1.trigger_count as `trigger_count`,\n    count(distinct s1.vplayerid) as `trigger_user_cnt`,\n    sum(s2.draw_count) as `total_draw_count`\nfrom (\n    select\n        vplayerid,\n        dteventtime,\n        coalesce(lead(dteventtime) over (partition by vplayerid order by dteventtime), '9999-12-31 23:59:59') as next_dteventtime,\n        row_number() over (partition by vplayerid order by dteventtime) as trigger_count\n    from (\n        select distinct\n            vplayerid,\n            dteventtime\n        from dwd_jordass_activityrecord_hi\n        where tdbank_imp_date >= '2025011100'\n        and tdbank_imp_date <= '2025012423'\n        and actid = 2411070621\n        and recodtype in ('1', '2')\n        and strarg1 <> '0'\n    ) ff1\n) s1 \njoin (\n    select\n        vplayerid,\n        dteventtime,\n        sum(arg1) as draw_count\n    from dwd_jordass_activityrecord_hi\n    where tdbank_imp_date >= '2025011100' \n    and tdbank_imp_date <= '2025012423'\n    and actid = 2411070621\n    and recodtype in ('1', '2')\n    group by vplayerid, dteventtime\n) s2 \non s1.vplayerid = s2.vplayerid and s2.dteventtime >= s1.dteventtime and s2.dteventtime < s1.next_dteventtime\ngroup by s1.trigger_count\n", "status": "success", "result": [{"trigger_count": 1, "trigger_user_cnt": 29, "total_draw_count": 32}, {"trigger_count": 15, "trigger_user_cnt": 1, "total_draw_count": 2}, {"trigger_count": 2, "trigger_user_cnt": 27, "total_draw_count": 120}, {"trigger_count": 3, "trigger_user_cnt": 4, "total_draw_count": 7}, {"trigger_count": 5, "trigger_user_cnt": 3, "total_draw_count": 5}, {"trigger_count": 13, "trigger_user_cnt": 1, "total_draw_count": 2}, {"trigger_count": 14, "trigger_user_cnt": 1, "total_draw_count": 11}, {"trigger_count": 7, "trigger_user_cnt": 2, "total_draw_count": 3}, {"trigger_count": 6, "trigger_user_cnt": 2, "total_draw_count": 13}, {"trigger_count": 11, "trigger_user_cnt": 1, "total_draw_count": 2}, {"trigger_count": 20, "trigger_user_cnt": 1, "total_draw_count": 14}, {"trigger_count": 4, "trigger_user_cnt": 4, "total_draw_count": 16}, {"trigger_count": 9, "trigger_user_cnt": 2, "total_draw_count": 3}, {"trigger_count": 16, "trigger_user_cnt": 1, "total_draw_count": 12}, {"trigger_count": 19, "trigger_user_cnt": 1, "total_draw_count": 2}, {"trigger_count": 10, "trigger_user_cnt": 1, "total_draw_count": 9}, {"trigger_count": 8, "trigger_user_cnt": 2, "total_draw_count": 15}, {"trigger_count": 12, "trigger_user_cnt": 1, "total_draw_count": 10}, {"trigger_count": 18, "trigger_user_cnt": 1, "total_draw_count": 13}, {"trigger_count": 17, "trigger_user_cnt": 1, "total_draw_count": 2}]}
{"sql_id": "sql_60", "sql": "\nselect \n    a.dteventtime as stat_date,\n    count(distinct a.uid) as alliance_paying_users\nfrom \n    dwd_jordass_player_allianceactive_hi a\njoin \n    dws_jordass_water_di b on a.uid = b.vplayerid\nwhere \n    a.tdbank_imp_date >= date_sub('20250226', 180) \n    and a.tdbank_imp_date < '20250226'\n    and b.dtstatdate >= date_sub('20250226', 210) \n    and b.dtstatdate < '20250226' \n    and b.platid = 255\n    and datediff(b.dtstatdate, a.dteventtime) between 0 and 29\ngroup by \n    a.dteventtime\norder by \n    a.dteventtime;\n", "status": "success", "result": []}
{"sql_id": "sql_61", "sql": "\nWITH \n-- 获取2024.2.9当天的付费玩家和付费金额\nfirst_day_payers AS (\n    SELECT \n        vplayerid,\n        SUM(imoney/100) AS first_day_pay_amount\n    FROM dws_jordass_water_di\n    WHERE dtstatdate = '20240209'\n    GROUP BY vplayerid\n),\n\n-- 获取前一个月的点券消耗情况\nprevious_month_currency AS (\n    SELECT \n        vplayerid,\n        SUM(CASE WHEN imoneytype = 1 AND addorreduce = 1 THEN imoney ELSE 0 END) AS point_consumption\n    FROM dwd_jordass_currencylog_hi\n    WHERE dtstatdate >= '20240109' AND dtstatdate < '20240209'\n    GROUP BY vplayerid\n),\n\n-- 判断用户是否为历史付费用户\nhistorical_payers AS (\n    SELECT DISTINCT vplayerid\n    FROM dws_jordass_water_di\n    WHERE dtstatdate < '20240209'\n),\n\n-- 合并所有信息并分类\nuser_classification AS (\n    SELECT \n        COALESCE(fd.vplayerid, pm.vplayerid) AS vplayerid,\n        CASE \n            WHEN fd.vplayerid IS NULL AND pm.vplayerid IS NULL THEN '历史非付费'\n            WHEN fd.vplayerid IS NOT NULL AND pm.vplayerid IS NULL AND h.vplayerid IS NOT NULL THEN '沉默付费'\n            WHEN pm.point_consumption < 100 THEN '小R'\n            WHEN pm.point_consumption >= 100 AND pm.point_consumption < 500 THEN '中R'\n            WHEN pm.point_consumption >= 500 AND pm.point_consumption < 1500 THEN '大R'\n            WHEN pm.point_consumption >= 1500 THEN '超R'\n            ELSE '其他'\n        END AS user_type,\n        CASE WHEN fd.vplayerid IS NOT NULL THEN 1 ELSE 0 END AS is_first_day_payer,\n        fd.first_day_pay_amount,\n        CASE WHEN pm.vplayerid IS NOT NULL THEN 1 ELSE 0 END AS has_point_consumption\n    FROM first_day_payers fd\n    FULL OUTER JOIN previous_month_currency pm ON fd.vplayerid = pm.vplayerid\n    LEFT JOIN historical_payers h ON COALESCE(fd.vplayerid, pm.vplayerid) = h.vplayerid\n)\n\n-- 最终统计输出\nSELECT \n    user_type,\n    COUNT(DISTINCT vplayerid) AS active_users,\n    SUM(is_first_day_payer) AS first_day_payers,\n    ROUND(SUM(CASE WHEN is_first_day_payer = 1 THEN first_day_pay_amount ELSE 0 END) / NULLIF(SUM(is_first_day_payer), 0), 2) AS first_day_arpu,\n    SUM(has_point_consumption) AS point_consumption_users\nFROM user_classification\nGROUP BY user_type\nORDER BY \n    CASE user_type\n        WHEN '沉默付费' THEN 1\n        WHEN '历史非付费' THEN 2\n        WHEN '小R' THEN 3\n        WHEN '中R' THEN 4\n        WHEN '大R' THEN 5\n        WHEN '超R' THEN 6\n        ELSE 7\n    END;\n", "status": "success", "result": null}
{"sql_id": "sql_62", "sql": "\nselect \n    '20250226' as stat_date,\n    count(distinct login.uid) as role_dau,\n    count(distinct active.uid) as alliance_participants,\n    count(distinct bootcamp.memberuid) as bootcamp_completers,\n    count(distinct shop.uid) as shop_exchange_count\nfrom \n    (select uid from dwd_jordass_playerlogin_hi \n     where tdbank_imp_date >= date_sub('20250226', 179) and tdbank_imp_date <= '20250226') login\nleft join \n    (select uid from dwd_jordass_player_allianceactive_hi \n     where tdbank_imp_date >= date_sub('20250226', 179) and tdbank_imp_date <= '20250226') active\n    on login.uid = active.uid\nleft join \n    (select memberuid from dwd_jordass_alliancebootcamprecord_hi \n     where tdbank_imp_date >= date_sub('20250226', 179) and tdbank_imp_date <= '20250226') bootcamp\n    on login.uid = bootcamp.memberuid\nleft join \n    (select uid from dwd_jordass_allianceshopbuy_hi \n     where tdbank_imp_date >= date_sub('20250226', 179) and tdbank_imp_date <= '20250226') shop\n    on login.uid = shop.uid;\n", "status": "success", "result": [{"stat_date": "20250226", "role_dau": 0, "alliance_participants": 0, "bootcamp_completers": 0, "shop_exchange_count": 0}]}
{"sql_id": "sql_64", "sql": "\nselect\n    dtstatdate,\n    count(distinct vplayerid) as uv,\n    count(*) as pv\nfrom dws_jordass_buttonpress_pre_di\nwhere buttontype = '410012'\nand (\n    (dtstatdate between '20241022' and '20241119') or\n    (dtstatdate between '20241122' and '20241219') or\n    (dtstatdate between '20241022' and '20241027') or\n    (dtstatdate between '20241028' and '20241103') or\n    (dtstatdate between '20241104' and '20241110') or\n    (dtstatdate between '20241111' and '20241117') or\n    (dtstatdate between '20241118' and '20241119') or\n    (dtstatdate between '20241122' and '20241124') or\n    (dtstatdate between '20241125' and '20241201') or\n    (dtstatdate between '20241202' and '20241208') or\n    (dtstatdate between '20241209' and '20241215') or\n    (dtstatdate between '20241216' and '20241219')\n)\ngroup by dtstatdate\norder by dtstatdate;\n", "status": "success", "result": [{"dtstatdate": "20241023", "uv": 1, "pv": 2}, {"dtstatdate": "20241025", "uv": 1, "pv": 1}, {"dtstatdate": "20241112", "uv": 2, "pv": 2}, {"dtstatdate": "20241119", "uv": 1, "pv": 1}, {"dtstatdate": "20241123", "uv": 1, "pv": 1}, {"dtstatdate": "20241210", "uv": 1, "pv": 1}]}
{"sql_id": "sql_65", "sql": "\nselect\n    dtstatdate,\n    acttype,\n    user_cnt,\n    times_cnt\nfrom (\n    -- 按天统计\n    select\n        substr(tdbank_imp_date, 1, 8) as dtstatdate,\n        acttype,\n        count(distinct vplayerid) as user_cnt,\n        sum(awardcnt) as times_cnt\n    from dwd_jordass_activity_rewardrecord_hi\n    where tdbank_imp_date between '2024112900' and '2024121923'\n      and actid = 2411291018\n      and acttype = 10045\n      and awardidx in (1, 2, 3)\n    group by substr(tdbank_imp_date, 1, 8), acttype\n\n    union all\n\n    -- 汇总统计\n    select\n        '汇总' as dtstatdate,\n        acttype,\n        count(distinct vplayerid) as user_cnt,\n        sum(awardcnt) as times_cnt\n    from dwd_jordass_activity_rewardrecord_hi\n    where tdbank_imp_date between '2024112900' and '2024121923'\n      and actid = 2411291018\n      and acttype = 10045\n      and awardidx in (1, 2, 3)\n    group by acttype\n) f\norder by dtstatdate, acttype;\n", "status": "success", "result": [{"dtstatdate": "20241129", "acttype": 10045, "user_cnt": 1, "times_cnt": 2}, {"dtstatdate": "20241130", "acttype": 10045, "user_cnt": 1, "times_cnt": 1}, {"dtstatdate": "20241201", "acttype": 10045, "user_cnt": 1, "times_cnt": 1}, {"dtstatdate": "20241205", "acttype": 10045, "user_cnt": 1, "times_cnt": 1}, {"dtstatdate": "20241210", "acttype": 10045, "user_cnt": 1, "times_cnt": 1}, {"dtstatdate": "20241215", "acttype": 10045, "user_cnt": 1, "times_cnt": 1}, {"dtstatdate": "20241219", "acttype": 10045, "user_cnt": 1, "times_cnt": 1}, {"dtstatdate": "汇总", "acttype": 10045, "user_cnt": 7, "times_cnt": 8}]}
{"sql_id": "sql_67", "sql": "\nselect\n    igoodsid as `道具id`,\n    sum(count) as `产出次数`\nfrom dwd_jordass_gearlog_hi\nwhere dteventtime between '2025-01-24 00:00:00' and '2025-02-06 23:59:59'\n  and igoodsid in (430487, 430485, 602004025, 602002011)\n  and addorreduce = 0\ngroup by igoodsid\n", "status": "success", "result": [{"道具id": 602004025, "产出次数": 2}, {"道具id": 430485, "产出次数": 2}, {"道具id": 602002011, "产出次数": 1}, {"道具id": 430487, "产出次数": 1}]}
{"sql_id": "sql_68", "sql": "\nselect\n    date_format(dteventtime, '%y%d%m') as date,\n    count(distinct vplayerid) as player_count\nfrom dwd_jordass_lotteryrecord_hi\nwhere dteventtime between '2025-01-28 00:00:00' and '2025-02-10 23:59:59'\nand activitytype in (848, 841)\ngroup by date_format(dteventtime, '%y%d%m')\norder by date;\n", "status": "success", "result": [{"date": "251002", "player_count": 4}, {"date": "252801", "player_count": 2}, {"date": "252901", "player_count": 2}]}
{"sql_id": "sql_69", "sql": "\nselect\n    substr(dteventtime, 1, 10) as date,\n    chattype,\n    count(distinct playerid) as user_count,\n    count(*) as message_count\nfrom dwd_jordass_msgchatrecord_hi\nwhere dteventtime between '2024-12-25' and '2025-01-05'\n  and chattype in (20, 25, 26, 16, 27, 8)\ngroup by substr(dteventtime, 1, 10), chattype\norder by date, chattype;\n", "status": "success", "result": [{"date": "2024-12-25", "chattype": 20, "user_count": 1, "message_count": 1}, {"date": "2024-12-25", "chattype": 25, "user_count": 1, "message_count": 1}, {"date": "2024-12-26", "chattype": 16, "user_count": 1, "message_count": 1}, {"date": "2024-12-26", "chattype": 26, "user_count": 1, "message_count": 1}, {"date": "2025-01-01", "chattype": 8, "user_count": 1, "message_count": 1}, {"date": "2025-01-01", "chattype": 16, "user_count": 1, "message_count": 1}, {"date": "2025-01-01", "chattype": 27, "user_count": 1, "message_count": 1}]}
{"sql_id": "sql_70", "sql": "\nselect\n    awardidx as `抽奖档位`,\n    count(distinct vplayerid) as `人数`\nfrom dwd_jordass_activity_rewardrecord_hi\nwhere substr(dteventtime, 1, 10) between '2024-11-29' and '2024-12-19'\n  and actid = 2411291018\ngroup by awardidx\n\nunion all\n\nselect\n    '汇总' as `抽奖档位`,\n    count(distinct vplayerid) as `人数`\nfrom dwd_jordass_activity_rewardrecord_hi\nwhere substr(dteventtime, 1, 10) between '2024-11-29' and '2024-12-19'\n  and actid = 2411291018\n", "status": "success", "result": [{"抽奖档位": "1", "人数": 5}, {"抽奖档位": "4", "人数": 1}, {"抽奖档位": "汇总", "人数": 14}, {"抽奖档位": "5", "人数": 1}, {"抽奖档位": "3", "人数": 4}, {"抽奖档位": "2", "人数": 4}]}
{"sql_id": "sql_71", "sql": "\nselect\n    case \n        when dteventtime between '2024-11-29' and '2024-12-05' then '20241129-20241205'\n        when dteventtime between '2024-12-06' and '2024-12-12' then '20241206-20241212'\n        when dteventtime between '2024-12-13' and '2024-12-19' then '20241213-20241219'\n    end as date_range,\n    extarg1,\n    count(distinct vplayerid) as user_count,\n    count(*) as event_count\nfrom dwd_jordass_activitypress_hi\nwhere dteventtime between '2024-11-29' and '2024-12-19'\n  and ireason = 2411291018\n  and buttontype = 10045\n  and extarg1 in (101, 109, 110)\ngroup by \n    case \n        when dteventtime between '2024-11-29' and '2024-12-05' then '20241129-20241205'\n        when dteventtime between '2024-12-06' and '2024-12-12' then '20241206-20241212'\n        when dteventtime between '2024-12-13' and '2024-12-19' then '20241213-20241219'\n    end,\n    extarg1\norder by date_range, extarg1;\n", "status": "success", "result": [{"date_range": null, "extarg1": 109, "user_count": 1, "event_count": 1}, {"date_range": null, "extarg1": 110, "user_count": 1, "event_count": 1}, {"date_range": "20241129-20241205", "extarg1": 101, "user_count": 1, "event_count": 2}, {"date_range": "20241206-20241212", "extarg1": 109, "user_count": 1, "event_count": 1}, {"date_range": "20241206-20241212", "extarg1": 110, "user_count": 1, "event_count": 1}, {"date_range": "20241213-20241219", "extarg1": 101, "user_count": 1, "event_count": 1}, {"date_range": "20241213-20241219", "extarg1": 110, "user_count": 1, "event_count": 1}]}
{"sql_id": "sql_73", "sql": "\nWITH match_data AS (\n    SELECT \n        vplayerid,\n        gameid,\n        teammembers,\n        CASE \n            WHEN matchmode = 1003 AND matchsubmodegroup = 1345785623905087744 THEN '对决冠军'\n            WHEN matchmode = 1003 AND matchsubmodegroup <> 1345785623905087744 THEN '乐园其他'\n            WHEN matchmode = 1003 THEN '乐园汇总'\n        END AS match_type\n    FROM dwd_jordass_player_matchrecord_hi\n    WHERE dteventtime BETWEEN '20241123' AND '20241222'\n    AND matchresult = 'ok'\n),\n\ntotal_stats AS (\n    SELECT \n        match_type,\n        COUNT(DISTINCT vplayerid) AS total_players,\n        COUNT(DISTINCT gameid) AS total_matches,\n        COUNT(DISTINCT CASE WHEN teammembers IS NOT NULL AND teammembers <> '' THEN vplayerid END) AS team_players,\n        COUNT(DISTINCT CASE WHEN teammembers IS NOT NULL AND teammembers <> '' THEN gameid END) AS team_matches\n    FROM match_data\n    GROUP BY match_type\n)\n\nSELECT \n    MAX(CASE WHEN match_type = '乐园汇总' THEN total_players ELSE 0 END) AS 乐园总参与人数,\n    MAX(CASE WHEN match_type = '乐园汇总' THEN total_matches ELSE 0 END) AS 乐园总参与局数,\n    MAX(CASE WHEN match_type = '乐园汇总' THEN team_players ELSE 0 END) AS 乐园组队人数,\n    MAX(CASE WHEN match_type = '乐园汇总' THEN team_matches ELSE 0 END) AS 乐园组队局数,\n    MAX(CASE WHEN match_type = '对决冠军' THEN total_players ELSE 0 END) AS 对决冠军总参与人数,\n    MAX(CASE WHEN match_type = '对决冠军' THEN total_matches ELSE 0 END) AS 对决冠军总参与局数,\n    MAX(CASE WHEN match_type = '对决冠军' THEN team_players ELSE 0 END) AS 对决冠军组队人数,\n    MAX(CASE WHEN match_type = '对决冠军' THEN team_matches ELSE 0 END) AS 对决冠军组队局数,\n    MAX(CASE WHEN match_type = '乐园其他' THEN total_players ELSE 0 END) AS 乐园其他总参与人数,\n    MAX(CASE WHEN match_type = '乐园其他' THEN total_matches ELSE 0 END) AS 乐园其他总参与局数,\n    MAX(CASE WHEN match_type = '乐园其他' THEN team_players ELSE 0 END) AS 乐园其他组队人数,\n    MAX(CASE WHEN match_type = '乐园其他' THEN team_matches ELSE 0 END) AS 乐园其他组队局数\nFROM total_stats;\n", "status": "success", "result": [{"乐园总参与人数": null, "乐园总参与局数": null, "乐园组队人数": null, "乐园组队局数": null, "对决冠军总参与人数": null, "对决冠军总参与局数": null, "对决冠军组队人数": null, "对决冠军组队局数": null, "乐园其他总参与人数": null, "乐园其他总参与局数": null, "乐园其他组队人数": null, "乐园其他组队局数": null}]}
{"sql_id": "sql_74", "sql": "\nselect \n    buttontypes as button_type,\n    count(distinct case when tdbank_imp_date between '2024112305' and '2024112616' then vplayerid end) as ss30_user_count,\n    count(distinct case when tdbank_imp_date between '2024092405' and '2024092716' then vplayerid end) as ss29_user_count\nfrom dwd_jordass_pressbutton_hi\nwhere (tdbank_imp_date between '2024112305' and '2024112616' or tdbank_imp_date between '2024092405' and '2024092716')\n  and buttontypes in ('411130', '411200')\ngroup by buttontypes;\n", "status": "success", "result": [{"button_type": "411130", "ss30_user_count": 1, "ss29_user_count": 1}]}
{"sql_id": "sql_75", "sql": "\nselect \n    baseid,\n    count(distinct effectid) as unlock_count\nfrom dwd_jordass_voicethemelog_hi\nwhere dteventtime between '2022080400' and '2024112400'\n  and baseid in (3336008, 3304024, 3336012, 3306028, 3304030, 3336016, 3336018, 3304038, 3336023, 3306033, 3349004, 3308014, 3336032, 3304043, 3306039, 3336041, 3301024, 3336045, 3306042)\ngroup by baseid\norder by baseid;\n", "status": "success", "result": [{"baseid": 3304024, "unlock_count": 5}, {"baseid": 3304030, "unlock_count": 1}, {"baseid": 3306028, "unlock_count": 1}, {"baseid": 3336008, "unlock_count": 4}, {"baseid": 3336012, "unlock_count": 1}]}
{"sql_id": "sql_77", "sql": "\nselect\n    substr(dteventtime, 1, 8) as date,\n    count(distinct vplayerid) as user_count,\n    sum(imoney) as total_payment\nfrom dwd_jordass_currencylog_hi\nwhere substr(dteventtime, 1, 8) between '20230123' and '20230129'\n  and reason in (189, 190)\n  and imoneytype = 1027\ngroup by substr(dteventtime, 1, 8)\norder by date;\n", "status": "success", "result": []}
{"sql_id": "sql_78", "sql": "\nWITH \n-- 初日华服回归抽奖用户\nfirst_day_users AS (\n    SELECT DISTINCT vplayerid\n    FROM dwd_jordass_lotteryrecord_hi\n    WHERE tdbank_imp_date = '2025011900'\n    AND activitytype = 815\n),\n\n-- 沙漠统治者抽奖用户\ndesert_users AS (\n    SELECT DISTINCT vplayerid\n    FROM dwd_jordass_lotteryrecord_hi\n    WHERE tdbank_imp_date = '2025011900'\n    AND activitytype = 690\n),\n\n-- 境界双花抽奖用户\nmirror_users AS (\n    SELECT DISTINCT vplayerid\n    FROM dwd_jordass_lotteryrecord_hi\n    WHERE tdbank_imp_date = '2025011900'\n    AND activitytype = 748\n),\n\n-- 玄龙凌霄抽奖用户\ndragon_users AS (\n    SELECT DISTINCT vplayerid\n    FROM dwd_jordass_lotteryrecord_hi\n    WHERE tdbank_imp_date = '2025011900'\n    AND activitytype = 750\n),\n\n-- 沙漠统治者主套用户\ndesert_main_set_users AS (\n    SELECT DISTINCT vplayerid\n    FROM dwd_jordass_gearlog_hi\n    WHERE igoodsid = 430179 AND addorreduce = 0\n),\n\n-- 境界双花主套用户\nmirror_main_set_users AS (\n    SELECT DISTINCT vplayerid\n    FROM dwd_jordass_gearlog_hi\n    WHERE igoodsid = 430265 AND addorreduce = 0\n),\n\n-- 玄龙凌霄主套用户\ndragon_main_set_users AS (\n    SELECT DISTINCT vplayerid\n    FROM dwd_jordass_gearlog_hi\n    WHERE igoodsid = 430225 AND addorreduce = 0\n)\n\nSELECT\n    -- 初日华服回归抽奖&沙漠统治者有抽奖人数\n    COUNT(DISTINCT CASE WHEN f.vplayerid IS NOT NULL AND d.vplayerid IS NOT NULL THEN f.vplayerid END) AS first_day_and_desert,\n    \n    -- 初日华服回归抽奖&境界双花有抽奖人数\n    COUNT(DISTINCT CASE WHEN f.vplayerid IS NOT NULL AND m.vplayerid IS NOT NULL THEN f.vplayerid END) AS first_day_and_mirror,\n    \n    -- 初日华服回归抽奖&玄龙凌霄有抽奖人数\n    COUNT(DISTINCT CASE WHEN f.vplayerid IS NOT NULL AND dr.vplayerid IS NOT NULL THEN f.vplayerid END) AS first_day_and_dragon,\n    \n    -- 初日华服回归抽奖&沙漠统治者有抽奖&但没有其主套人数\n    COUNT(DISTINCT CASE WHEN f.vplayerid IS NOT NULL AND d.vplayerid IS NOT NULL AND dm.vplayerid IS NULL THEN f.vplayerid END) AS first_day_desert_no_main_set,\n    \n    -- 初日华服回归抽奖&境界双花有抽奖&但没有其主套人数\n    COUNT(DISTINCT CASE WHEN f.vplayerid IS NOT NULL AND m.vplayerid IS NOT NULL AND mm.vplayerid IS NULL THEN f.vplayerid END) AS first_day_mirror_no_main_set,\n    \n    -- 初日华服回归抽奖&玄龙凌霄有抽奖&但没有其主套人数\n    COUNT(DISTINCT CASE WHEN f.vplayerid IS NOT NULL AND dr.vplayerid IS NOT NULL AND drm.vplayerid IS NULL THEN f.vplayerid END) AS first_day_dragon_no_main_set,\n    \n    -- 初日华服回归抽奖&【沙漠统治者和境界双花有主套】人数\n    COUNT(DISTINCT CASE WHEN f.vplayerid IS NOT NULL AND dm.vplayerid IS NOT NULL AND mm.vplayerid IS NOT NULL THEN f.vplayerid END) AS first_day_desert_mirror_main_set,\n    \n    -- 初日华服回归抽奖&【沙漠统治者和玄龙凌霄有主套】人数\n    COUNT(DISTINCT CASE WHEN f.vplayerid IS NOT NULL AND dm.vplayerid IS NOT NULL AND drm.vplayerid IS NOT NULL THEN f.vplayerid END) AS first_day_desert_dragon_main_set,\n    \n    -- 初日华服回归抽奖&【境界双花和玄龙凌霄有主套】人数\n    COUNT(DISTINCT CASE WHEN f.vplayerid IS NOT NULL AND mm.vplayerid IS NOT NULL AND drm.vplayerid IS NOT NULL THEN f.vplayerid END) AS first_day_mirror_dragon_main_set,\n    \n    -- 初日华服回归抽奖但【沙漠统治者&境界双花&玄龙凌霄】没有抽奖人数\n    COUNT(DISTINCT CASE WHEN f.vplayerid IS NOT NULL AND d.vplayerid IS NULL AND m.vplayerid IS NULL AND dr.vplayerid IS NULL THEN f.vplayerid END) AS first_day_only\n    \nFROM first_day_users f\nLEFT JOIN desert_users d ON f.vplayerid = d.vplayerid\nLEFT JOIN mirror_users m ON f.vplayerid = m.vplayerid\nLEFT JOIN dragon_users dr ON f.vplayerid = dr.vplayerid\nLEFT JOIN desert_main_set_users dm ON f.vplayerid = dm.vplayerid\nLEFT JOIN mirror_main_set_users mm ON f.vplayerid = mm.vplayerid\nLEFT JOIN dragon_main_set_users drm ON f.vplayerid = drm.vplayerid;\n", "status": "success", "result": [{"first_day_and_desert": 0, "first_day_and_mirror": 0, "first_day_and_dragon": 0, "first_day_desert_no_main_set": 0, "first_day_mirror_no_main_set": 0, "first_day_dragon_no_main_set": 0, "first_day_desert_mirror_main_set": 1, "first_day_desert_dragon_main_set": 1, "first_day_mirror_dragon_main_set": 1, "first_day_only": 1}]}
{"sql_id": "sql_80", "sql": "\nWITH date_ranges AS (\n    SELECT \n        date_add('2024-10-02', (n-1)*7) AS start_date,\n        date_add('2024-10-02', n*7-1) AS end_date\n    FROM (\n        SELECT row_number() OVER () AS n \n        FROM dws_jordass_mode_roundrecord_di \n        WHERE dtstatdate BETWEEN '2024-10-02' AND '2025-01-08'\n        LIMIT 15\n    ) t\n    WHERE date_add('2024-10-02', n*7-1) <= '2025-01-08'\n),\n\nplayer_activity AS (\n    SELECT \n        r.start_date,\n        r.end_date,\n        d.vplayerid,\n        d.dtstatdate,\n        d.modename,\n        d.submodename,\n        d.roundtime,\n        CASE \n            WHEN d.modename=\"传统模式\" AND d.submodename LIKE \"CG%\" AND d.mapname=\"群屿\" THEN \"主题群屿\"\n            WHEN d.modename=\"传统模式\" AND d.mapname=\"群屿\" THEN \"传统群屿\"\n            WHEN d.modename=\"传统模式\" AND d.mapname=\"假日群岛\" THEN \"假日群岛\"\n            WHEN d.submodename = \"广域战场模式\" THEN \"广域战场\"\n            WHEN d.submodename=\"极能形态模式\" THEN \"极能形态\"\n            WHEN d.modename=\"组队竞技\" THEN \"组竞\"\n            WHEN d.modename=\"休闲模式\" THEN \"休闲\"\n            WHEN d.modename=\"乐园\" THEN \"乐园\"\n            WHEN d.modename=\"领地\" THEN \"领地\"\n            WHEN d.modename=\"广阔天地\" THEN \"广阔天地\"\n            WHEN d.modename=\"生存模式\" THEN \"隧道\"\n            ELSE \"其他模式\"\n        END AS play_type\n    FROM dws_jordass_mode_roundrecord_di d\n    JOIN date_ranges r ON d.dtstatdate BETWEEN r.start_date AND r.end_date\n),\n\nlast_week_players AS (\n    SELECT DISTINCT vplayerid, start_date\n    FROM player_activity\n    WHERE dtstatdate BETWEEN date_sub(start_date, 7) AND date_sub(start_date, 1)\n    AND modename = \"乐园\" AND submodename = \"对决冠军\"\n),\n\ncurrent_week_players AS (\n    SELECT DISTINCT vplayerid, start_date\n    FROM player_activity\n    WHERE dtstatdate BETWEEN start_date AND end_date\n    AND modename = \"乐园\" AND submodename = \"对决冠军\"\n),\n\ntarget_players AS (\n    SELECT \n        c.start_date,\n        c.end_date,\n        c.vplayerid\n    FROM current_week_players c\n    LEFT JOIN last_week_players l ON c.vplayerid = l.vplayerid AND c.start_date = l.start_date\n    WHERE l.vplayerid IS NULL\n),\n\nlast_week_playtime AS (\n    SELECT \n        t.start_date,\n        t.vplayerid,\n        p.play_type,\n        SUM(p.roundtime) AS play_time\n    FROM target_players t\n    JOIN player_activity p ON t.vplayerid = p.vplayerid \n    AND p.dtstatdate BETWEEN date_sub(t.start_date, 7) AND date_sub(t.start_date, 1)\n    GROUP BY t.start_date, t.vplayerid, p.play_type\n),\n\ncurrent_week_playtime AS (\n    SELECT \n        t.start_date,\n        t.vplayerid,\n        p.play_type,\n        SUM(p.roundtime) AS play_time\n    FROM target_players t\n    JOIN player_activity p ON t.vplayerid = p.vplayerid \n    AND p.dtstatdate BETWEEN t.start_date AND t.end_date\n    GROUP BY t.start_date, t.vplayerid, p.play_type\n),\n\nlast_week_main_play AS (\n    SELECT \n        start_date,\n        vplayerid,\n        play_type,\n        play_time AS last_week_main_play_time\n    FROM (\n        SELECT \n            start_date,\n            vplayerid,\n            play_type,\n            play_time,\n            ROW_NUMBER() OVER (PARTITION BY start_date, vplayerid ORDER BY play_time DESC) AS rn\n        FROM last_week_playtime\n    ) t\n    WHERE rn = 1\n),\n\nlast_week_all_play AS (\n    SELECT \n        start_date,\n        vplayerid,\n        SUM(play_time) AS last_week_all_play_time\n    FROM last_week_playtime\n    GROUP BY start_date, vplayerid\n),\n\ncurrent_week_main_play AS (\n    SELECT \n        start_date,\n        vplayerid,\n        play_type,\n        play_time AS current_week_main_play_time\n    FROM (\n        SELECT \n            start_date,\n            vplayerid,\n            play_type,\n            play_time,\n            ROW_NUMBER() OVER (PARTITION BY start_date, vplayerid ORDER BY play_time DESC) AS rn\n        FROM current_week_playtime\n    ) t\n    WHERE rn = 1\n),\n\ncurrent_week_all_play AS (\n    SELECT \n        start_date,\n        vplayerid,\n        SUM(play_time) AS current_week_all_play_time\n    FROM current_week_playtime\n    GROUP BY start_date, vplayerid\n),\n\nchampion_playtime AS (\n    SELECT \n        t.start_date,\n        t.vplayerid,\n        SUM(p.roundtime) AS champion_play_time\n    FROM target_players t\n    JOIN player_activity p ON t.vplayerid = p.vplayerid \n    AND p.dtstatdate BETWEEN t.start_date AND t.end_date\n    AND p.modename = \"乐园\" AND p.submodename = \"对决冠军\"\n    GROUP BY t.start_date, t.vplayerid\n)\n\nSELECT \n    CONCAT(r.start_date, '-', r.end_date) AS time_range,\n    ROUND(COALESCE(lm.last_week_main_play_time, 0)/60, 2) AS last_week_main_play_time,\n    ROUND(COALESCE(la.last_week_all_play_time, 0)/60, 2) AS last_week_all_play_time,\n    ROUND(COALESCE(cm.current_week_main_play_time, 0)/60, 2) AS current_week_main_play_time,\n    ROUND(COALESCE(ca.current_week_all_play_time, 0)/60, 2) AS current_week_all_play_time,\n    ROUND(COALESCE(cp.champion_play_time, 0)/60, 2) AS champion_play_time\nFROM date_ranges r\nLEFT JOIN target_players t ON r.start_date = t.start_date\nLEFT JOIN last_week_main_play lm ON t.vplayerid = lm.vplayerid AND t.start_date = lm.start_date\nLEFT JOIN last_week_all_play la ON t.vplayerid = la.vplayerid AND t.start_date = la.start_date\nLEFT JOIN current_week_main_play cm ON t.vplayerid = cm.vplayerid AND t.start_date = cm.start_date\nLEFT JOIN current_week_all_play ca ON t.vplayerid = ca.vplayerid AND t.start_date = ca.start_date\nLEFT JOIN champion_playtime cp ON t.vplayerid = cp.vplayerid AND t.start_date = cp.start_date\nWHERE r.start_date >= '2024-10-09'\nORDER BY r.start_date;\n", "status": "success", "result": null}
{"sql_id": "sql_82", "sql": "\nselect \n    case \n        when submode in (1001, 1002, 1003, 1064, 1065, 1066, 1076, 1077, 1078, 1091, 1092, 1093, 1137, 1138, 1139, 1143, 1144, 1145, 1152, 1153, 1154, 1158, 1159, 1160, 2029, 2030, 2031, 2044, 2045, 2046, 2122, 2123, 2124, 2129, 2130, 2131, 2166, 2167, 2168, 2169, 2170, 2171, 2172, 2173, 2174, 2203, 2216, 2217, 2218, 2219, 2220, 2221, 2297, 2298, 2299, 2300, 2301, 2302, 2304, 2305, 2306, 2322, 2323, 2324, 2325, 2326, 2327, 2359, 2360, 2361, 2368, 2367, 2366, 2419, 2420, 2421, 2422, 2423, 2424, 2425, 2426, 2427, 2453, 2454, 2455, 2460, 2461, 2462, 2472, 2473, 2474, 2463, 2464, 2465, 2466, 2467, 2468) then '群屿'\n        when submode in (2160, 2161, 2162, 2163, 2164, 2165, 2334, 2335, 2336, 2337, 2338, 2339) then '山峦'\n        when submode in (2396, 2397, 2398, 2399, 2400, 2401) then '假日群岛'\n    end as play_type,\n    allianceforceterlevel as season_level,\n    case \n        when totalpoint >= 1 and totalpoint < 2 then '[1,2)'\n        when totalpoint >= 2 and totalpoint < 3 then '[2,3)'\n        when totalpoint >= 3 and totalpoint < 4 then '[3,4)'\n        when totalpoint >= 4 and totalpoint < 5 then '[4,5)'\n        when totalpoint >= 5 and totalpoint < 6 then '[5,6)'\n        when totalpoint >= 6 and totalpoint < 7 then '[6,7)'\n        when totalpoint >= 7 and totalpoint < 8 then '[7,8)'\n        when totalpoint >= 8 and totalpoint < 9 then '[8,9)'\n        when totalpoint >= 9 and totalpoint < 10 then '[9,10)'\n        when totalpoint >= 10 then '[10,∞)'\n    end as score_range,\n    count(distinct vplayerid) as player_count\nfrom dwd_jordass_roundflow_hi\nwhere dteventtime between '20220408' and '20220410'\n  and mode = 103\n  and submode in (\n      1001, 1002, 1003, 1064, 1065, 1066, 1076, 1077, 1078, 1091, 1092, 1093, 1137, 1138, 1139, 1143, 1144, 1145, 1152, 1153, 1154, 1158, 1159, 1160, 2029, 2030, 2031, 2044, 2045, 2046, 2122, 2123, 2124, 2129, 2130, 2131, 2166, 2167, 2168, 2169, 2170, 2171, 2172, 2173, 2174, 2203, 2216, 2217, 2218, 2219, 2220, 2221, 2297, 2298, 2299, 2300, 2301, 2302, 2304, 2305, 2306, 2322, 2323, 2324, 2325, 2326, 2327, 2359, 2360, 2361, 2368, 2367, 2366, 2419, 2420, 2421, 2422, 2423, 2424, 2425, 2426, 2427, 2453, 2454, 2455, 2460, 2461, 2462, 2472, 2473, 2474, 2463, 2464, 2465, 2466, 2467, 2468,\n      2160, 2161, 2162, 2163, 2164, 2165, 2334, 2335, 2336, 2337, 2338, 2339,\n      2396, 2397, 2398, 2399, 2400, 2401\n  )\ngroup by \n    case \n        when submode in (1001, 1002, 1003, 1064, 1065, 1066, 1076, 1077, 1078, 1091, 1092, 1093, 1137, 1138, 1139, 1143, 1144, 1145, 1152, 1153, 1154, 1158, 1159, 1160, 2029, 2030, 2031, 2044, 2045, 2046, 2122, 2123, 2124, 2129, 2130, 2131, 2166, 2167, 2168, 2169, 2170, 2171, 2172, 2173, 2174, 2203, 2216, 2217, 2218, 2219, 2220, 2221, 2297, 2298, 2299, 2300, 2301, 2302, 2304, 2305, 2306, 2322, 2323, 2324, 2325, 2326, 2327, 2359, 2360, 2361, 2368, 2367, 2366, 2419, 2420, 2421, 2422, 2423, 2424, 2425, 2426, 2427, 2453, 2454, 2455, 2460, 2461, 2462, 2472, 2473, 2474, 2463, 2464, 2465, 2466, 2467, 2468) then '群屿'\n        when submode in (2160, 2161, 2162, 2163, 2164, 2165, 2334, 2335, 2336, 2337, 2338, 2339) then '山峦'\n        when submode in (2396, 2397, 2398, 2399, 2400, 2401) then '假日群岛'\n    end,\n    allianceforceterlevel,\n    case \n        when totalpoint >= 1 and totalpoint < 2 then '[1,2)'\n        when totalpoint >= 2 and totalpoint < 3 then '[2,3)'\n        when totalpoint >= 3 and totalpoint < 4 then '[3,4)'\n        when totalpoint >= 4 and totalpoint < 5 then '[4,5)'\n        when totalpoint >= 5 and totalpoint < 6 then '[5,6)'\n        when totalpoint >= 6 and totalpoint < 7 then '[6,7)'\n        when totalpoint >= 7 and totalpoint < 8 then '[7,8)'\n        when totalpoint >= 8 and totalpoint < 9 then '[8,9)'\n        when totalpoint >= 9 and totalpoint < 10 then '[9,10)'\n        when totalpoint >= 10 then '[10,∞)'\n    end\norder by play_type, season_level, score_range;\n", "status": "success", "result": []}
{"sql_id": "sql_83", "sql": "\nselect\n    stat_date,\n    '流失14天以上的回流用户' as user_type,\n    count(distinct backflow_users.vplayerid) as backflow_user_count,\n    count(distinct case when gift.vplayerid is not null then backflow_users.vplayerid end) as gift_click_user_count,\n    count(distinct case when lobby.vplayerid is not null then backflow_users.vplayerid end) as lobby_click_user_count,\n    count(distinct case when match.vplayerid is not null then backflow_users.vplayerid end) as match_user_count\nfrom (\n    select \n        dtstatdate as stat_date,\n        vplayerid\n    from dws_jordass_login_df\n    where dtstatdate in ('20240102', '20231219', '20231212', '20231205', '20231010', '20230919', '20230103', '20221220')\n    and platid = 255\n    and (dregdate <> dtstatdate)\n    and (instr(substr(cbitmap, 1, 1), '1') > 0)\n    and (instr(substr(cbitmap, 2, 14), '1') = 0)\n) backflow_users\nleft join (\n    select \n        dtstatdate,\n        vplayerid\n    from dws_jordass_buttonpress_pre_di\n    where buttontype = '10370'  -- 量子鸟赠礼\n    and dtstatdate in ('20240102', '20231219', '20231212', '20231205', '20231010', '20230919', '20230103', '20221220')\n) gift on backflow_users.stat_date = gift.dtstatdate and backflow_users.vplayerid = gift.vplayerid\nleft join (\n    select \n        dtstatdate,\n        vplayerid\n    from dws_jordass_buttonpress_pre_di\n    where buttontype in ('10373', '10374')  -- 回到大厅\n    and dtstatdate in ('20240102', '20231219', '20231212', '20231205', '20231010', '20230919', '20230103', '20221220')\n) lobby on backflow_users.stat_date = lobby.dtstatdate and backflow_users.vplayerid = lobby.vplayerid\nleft join (\n    select \n        dtstatdate,\n        vplayerid\n    from dws_jordass_matchlog_stat_di\n    where dtstatdate in ('20240102', '20231219', '20231212', '20231205', '20231010', '20230919', '20230103', '20221220')\n    and platid = 255\n    and imode = 255  -- 乐园所有玩法\n) match on backflow_users.stat_date = match.dtstatdate and backflow_users.vplayerid = match.vplayerid\ngroup by stat_date, user_type;\n", "status": "success", "result": [{"stat_date": "20221220", "user_type": "流失14天以上的回流用户", "backflow_user_count": 1, "gift_click_user_count": 1, "lobby_click_user_count": 0, "match_user_count": 1}, {"stat_date": "20230103", "user_type": "流失14天以上的回流用户", "backflow_user_count": 1, "gift_click_user_count": 0, "lobby_click_user_count": 1, "match_user_count": 1}, {"stat_date": "20231219", "user_type": "流失14天以上的回流用户", "backflow_user_count": 1, "gift_click_user_count": 1, "lobby_click_user_count": 0, "match_user_count": 1}, {"stat_date": "20240102", "user_type": "流失14天以上的回流用户", "backflow_user_count": 3, "gift_click_user_count": 1, "lobby_click_user_count": 2, "match_user_count": 2}, {"stat_date": "20231212", "user_type": "流失14天以上的回流用户", "backflow_user_count": 1, "gift_click_user_count": 0, "lobby_click_user_count": 1, "match_user_count": 1}, {"stat_date": "20230919", "user_type": "流失14天以上的回流用户", "backflow_user_count": 1, "gift_click_user_count": 0, "lobby_click_user_count": 1, "match_user_count": 1}, {"stat_date": "20231205", "user_type": "流失14天以上的回流用户", "backflow_user_count": 1, "gift_click_user_count": 0, "lobby_click_user_count": 1, "match_user_count": 1}, {"stat_date": "20231010", "user_type": "流失14天以上的回流用户", "backflow_user_count": 1, "gift_click_user_count": 1, "lobby_click_user_count": 0, "match_user_count": 1}]}
{"sql_id": "sql_84", "sql": "\nwith target_users as (\n    select distinct l.vplayerid\n    from dws_jordass_login_df l\n    join dwd_jordass_playerlogin_hi p on l.vplayerid = p.vplayerid\n    where l.dregdate between '20180101' and '20181231'\n      and p.dteventtime >= date_sub(current_date(), 30)\n),\n\nfriend_added_users as (\n    select distinct f.vplayerid\n    from dwd_jordass_friendlist_hi f\n    where f.dteventtime between '20200901' and '20220430'\n      and f.type = 2\n),\n\nmonthly_active_friends as (\n    select \n        substr(p.dteventtime, 1, 6) as month,\n        f.vplayerid,\n        avg(f.num) as avg_friends\n    from dwd_jordass_friendlist_hi f\n    join dwd_jordass_playerlogin_hi p on f.vplayerid = p.vplayerid\n    where f.dteventtime between '20200901' and '20220430'\n      and p.dteventtime between '20200901' and '20220430'\n      and f.vplayerid in (select vplayerid from target_users)\n      and f.vplayerid in (select vplayerid from friend_added_users)\n    group by substr(p.dteventtime, 1, 6), f.vplayerid\n)\n\nselect \n    month,\n    avg(avg_friends) as avg_online_friends_per_user\nfrom monthly_active_friends\ngroup by month\norder by month;\n", "status": "success", "result": []}
{"sql_id": "sql_85", "sql": "\nselect\n    a.dtstatdate as stat_date,\n    count(distinct a.vplayerid) as active_users,\n    count(distinct b.vplayerid) as match_users,\n    count(distinct case when b.tournamentid > 0 then b.vplayerid end) as tournament_users,\n    count(distinct case when b.tournamentid = 0 or b.tournamentid is null then a.vplayerid end) as non_tournament_users\nfrom\n    dws_jordass_login_di a\nleft join\n    dwd_jordass_player_matchrecord_hi b\non\n    a.vplayerid = b.vplayerid\n    and a.dtstatdate = substr(b.dteventtime, 1, 8)\nwhere\n    ((a.dtstatdate between '20220506' and '20220508') or (a.dtstatdate between '20220513' and '20220515'))\ngroup by\n    a.dtstatdate\norder by\n    a.dtstatdate;\n", "status": "success", "result": [{"stat_date": "20220506", "active_users": 5, "match_users": 0, "tournament_users": 0, "non_tournament_users": 5}, {"stat_date": "20220513", "active_users": 5, "match_users": 0, "tournament_users": 0, "non_tournament_users": 5}]}
{"sql_id": "sql_87", "sql": "\nwith \n-- 获取2023.07.02和2023.07.09参与乐园子玩法的玩家\nparticipants as (\n    select \n        dtstatdate,\n        matchsubmodegroup as submode,\n        vplayerid\n    from dim_jordass_leyuan_participate_cdf_nf\n    where dtstatdate in ('20230702', '20230709')\n      and instr(substr(cbitmap,1,7),'1')>0\n),\n\n-- 关联登录信息用于判断用户类型\nuser_types as (\n    select \n        p.dtstatdate,\n        p.submode,\n        p.vplayerid,\n        case \n            when datediff(p.dtstatdate, l.dregdate) <= 6 then '新进'\n            when instr(substr(l.cbitmap,8,7),'1')>0 then '留存'\n            when instr(substr(l.cbitmap,8,7),'1')=0 then '回流'\n        end as user_type\n    from participants p\n    join dws_jordass_login_df l\n      on p.vplayerid = l.vplayerid\n     and l.dtstatdate = p.dtstatdate\n     and l.platid = 255\n)\n\n-- 按日期、玩法、用户类型分组统计人数\nselect \n    dtstatdate as 统计日期,\n    submode as 玩法,\n    user_type as 类型,\n    count(distinct vplayerid) as 人数\nfrom user_types\nwhere user_type is not null\ngroup by dtstatdate, submode, user_type\norder by dtstatdate, submode, user_type;\n", "status": "success", "result": [{"统计日期": "20230702", "玩法": 1001, "类型": "新进", "人数": 1}, {"统计日期": "20230702", "玩法": 1001, "类型": "留存", "人数": 2}, {"统计日期": "20230702", "玩法": 1002, "类型": "回流", "人数": 2}, {"统计日期": "20230709", "玩法": 1001, "类型": "新进", "人数": 1}, {"统计日期": "20230709", "玩法": 1001, "类型": "留存", "人数": 1}, {"统计日期": "20230709", "玩法": 1002, "类型": "回流", "人数": 1}]}
{"sql_id": "sql_88", "sql": "\nwith \n-- 垂类玩法用户筛选\nplay_user as (\n    select distinct vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate between '20230529' and '20230627'\n      and modename = '乐园' \n      and submode IN (1265972235155284992,1278160113246405632)\n),\n\n-- 独占用户筛选\nexclusive_user as (\n    select vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate between '20230529' and '20230627'\n    group by vplayerid\n    having sum(case when modename = '乐园' and submode IN (1265972235155284992,1278160113246405632) then 1 else 0 end) > 0\n       and sum(case when modename != '乐园' or submode NOT IN (1265972235155284992,1278160113246405632) then 1 else 0 end) = 0\n),\n\n-- 用户活跃度分类\nuser_activity as (\n    select \n        vplayerid,\n        floor(datediff(dtstatdate, '20230322')/7) as week_num,\n        case \n            when count(distinct dtstatdate) between 1 and 4 then '轻度'\n            when count(distinct dtstatdate) between 5 and 15 then '中度'\n            when count(distinct dtstatdate) >= 16 then '重度'\n        end as activity_level\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate between '20230322' and '20230627'\n      and vplayerid in (select vplayerid from play_user)\n    group by vplayerid, floor(datediff(dtstatdate, '20230322')/7)\n),\n\n-- 用户玩法分布\nuser_mode as (\n    select \n        vplayerid,\n        floor(datediff(dtstatdate, '20230322')/7) as week_num,\n        case \n            when modename='传统模式' and mapname='群屿' and submode in (2557,2558,2559) then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '群屿'\n            when modename='传统模式' then '传统其他'\n            else modename \n        end as mode_type\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate between '20230322' and '20230627'\n      and vplayerid in (select vplayerid from play_user)\n    group by vplayerid, floor(datediff(dtstatdate, '20230322')/7), \n        case \n            when modename='传统模式' and mapname='群屿' and submode in (2557,2558,2559) then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '群屿'\n            when modename='传统模式' then '传统其他'\n            else modename \n        end\n),\n\n-- 用户段位信息\nuser_segment as (\n    select \n        vplayerid,\n        floor(datediff(dtstatdate, '20230322')/7) as week_num,\n        case substring(cast(seasonmaxsegment as varchar), 1, 1)\n            when '1' then '青铜'\n            when '2' then '白银'\n            when '3' then '黄金'\n            when '4' then '铂金'\n            when '5' then '星钻'\n            when '6' then '王冠'\n            when '7' then '王牌'\n            else '未知'\n        end as segment\n    from dwd_jordass_playerlogin_hi\n    where dtstatdate between '20230322' and '20230627'\n      and vplayerid in (select vplayerid from play_user)\n    group by vplayerid, floor(datediff(dtstatdate, '20230322')/7), \n        case substring(cast(seasonmaxsegment as varchar), 1, 1)\n            when '1' then '青铜'\n            when '2' then '白银'\n            when '3' then '黄金'\n            when '4' then '铂金'\n            when '5' then '星钻'\n            when '6' then '王冠'\n            when '7' then '王牌'\n            else '未知'\n        end\n)\n\n-- 最终结果\nselect \n    concat('第', a.week_num+1, '周') as period,\n    case \n        when b.vplayerid in (select vplayerid from exclusive_user) then '独占'\n        else a.activity_level \n    end as activity_level,\n    c.mode_type as mode,\n    d.segment,\n    count(distinct a.vplayerid) as user_count\nfrom user_activity a\nleft join exclusive_user b on a.vplayerid = b.vplayerid\njoin user_mode c on a.vplayerid = c.vplayerid and a.week_num = c.week_num\njoin user_segment d on a.vplayerid = d.vplayerid and a.week_num = d.week_num\ngroup by \n    concat('第', a.week_num+1, '周'),\n    case \n        when b.vplayerid in (select vplayerid from exclusive_user) then '独占'\n        else a.activity_level \n    end,\n    c.mode_type,\n    d.segment\norder by period, activity_level, mode, segment;\n", "status": "success", "result": null}
{"sql_id": "sql_89", "sql": "\nwith \n-- 1. 抽取垂类玩法用户\nplay_user as (\n    select distinct vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate between '20230529' and '20230627'\n    and modename = '乐园' \n    and (submode IN (1265972235155284992,1278160113246405632) or submode is null)\n),\n-- 2. 排除玩过其他模式的用户\nexclude_user as (\n    select distinct vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate between '20230529' and '20230627'\n    and (modename != '乐园' or (modename = '乐园' and submode not in (1265972235155284992,1278160113246405632) and submode is not null))\n),\n-- 3. 垂类独占用户\nexclusive_user as (\n    select vplayerid from play_user\n    except\n    select vplayerid from exclude_user\n),\n-- 4. 用户活跃天数统计\nuser_active_days as (\n    select \n        vplayerid,\n        count(distinct dtstatdate) as active_days\n    from dws_jordass_login_di\n    where dtstatdate between '20230322' and '20230627'\n    and platid = 255\n    group by vplayerid\n),\n-- 5. 用户分类\nuser_classification as (\n    select \n        u.vplayerid,\n        case \n            when u.active_days between 1 and 4 then '轻度'\n            when u.active_days between 5 and 15 then '中度'\n            when u.active_days between 16 and 30 then '重度'\n        end as activity_level,\n        case when e.vplayerid is not null then '垂类独占' else '非独占' end as user_type\n    from user_active_days u\n    left join exclusive_user e on u.vplayerid = e.vplayerid\n),\n-- 6. 每周登录天数统计\nweekly_login as (\n    select \n        vplayerid,\n        floor(datediff(dtstatdate, '20230322')/7) + 1 as week_num,\n        count(distinct dtstatdate) as login_days\n    from dws_jordass_login_di\n    where dtstatdate between '20230322' and '20230627'\n    and platid = 255\n    group by vplayerid, floor(datediff(dtstatdate, '20230322')/7) + 1\n),\n-- 7. 每周垂类玩法参与统计\nweekly_play as (\n    select \n        vplayerid,\n        floor(datediff(dtstatdate, '20230322')/7) + 1 as week_num,\n        count(distinct dtstatdate) as play_days,\n        sum(roundcnt) as play_rounds\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate between '20230322' and '20230627'\n    and modename = '乐园' \n    and (submode IN (1265972235155284992,1278160113246405632) or submode is null)\n    group by vplayerid, floor(datediff(dtstatdate, '20230322')/7) + 1\n)\n\n-- 最终结果\nselect \n    w.week_num as '周期',\n    c.activity_level as '活跃度',\n    w.login_days as '活跃天数',\n    count(distinct w.vplayerid) as '人数'\nfrom weekly_login w\njoin user_classification c on w.vplayerid = c.vplayerid\nwhere c.user_type = '垂类独占'\ngroup by w.week_num, c.activity_level, w.login_days\norder by w.week_num, c.activity_level, w.login_days;\n", "status": "success", "result": [{"周期": 1, "活跃度": "轻度", "活跃天数": 1, "人数": 1}, {"周期": 1, "活跃度": "轻度", "活跃天数": 2, "人数": 2}, {"周期": 2, "活跃度": "轻度", "活跃天数": 1, "人数": 1}]}
{"sql_id": "sql_90", "sql": "\nselect\n    case\n        when datediff('20230630', max(dtstatdate)) > 360 then '360天内未活跃'\n        when datediff('20230630', max(dtstatdate)) > 180 then '180天内未活跃'\n        when datediff('20230630', max(dtstatdate)) > 90 then '90天内未活跃'\n        when datediff('20230630', max(dtstatdate)) > 60 then '60天内未活跃'\n        when datediff('20230630', max(dtstatdate)) > 30 then '30天内未活跃'\n        when datediff('20230630', max(dtstatdate)) > 14 then '14天内未活跃'\n        when datediff('20230630', max(dtstatdate)) > 7 then '7天内未活跃'\n        else '7天内活跃'\n    end as activity_level,\n    count(distinct a.vplayerid) as player_count\nfrom (\n    select vplayerid\n    from dwd_jordass_player_matchrecord_hi\n    where dteventtime between '2023-07-17' and '2023-07-23'\n    and matchmode = 1310822585431254784\n    group by vplayerid\n) a\njoin (\n    select vplayerid, max(dtstatdate) as dtstatdate\n    from dws_jordass_login_df\n    where dtstatdate <= '20230630'\n    group by vplayerid\n) b on a.vplayerid = b.vplayerid\nwhere not exists (\n    select 1\n    from dws_jordass_login_df\n    where vplayerid = a.vplayerid\n    and dtstatdate between '20230701' and '20230716'\n)\ngroup by\n    case\n        when datediff('20230630', max(dtstatdate)) > 360 then '360天内未活跃'\n        when datediff('20230630', max(dtstatdate)) > 180 then '180天内未活跃'\n        when datediff('20230630', max(dtstatdate)) > 90 then '90天内未活跃'\n        when datediff('20230630', max(dtstatdate)) > 60 then '60天内未活跃'\n        when datediff('20230630', max(dtstatdate)) > 30 then '30天内未活跃'\n        when datediff('20230630', max(dtstatdate)) > 14 then '14天内未活跃'\n        when datediff('20230630', max(dtstatdate)) > 7 then '7天内未活跃'\n        else '7天内活跃'\n    end;\n", "status": "success", "result": null}
{"sql_id": "sql_91", "sql": "\nselect\n    dtstatdate as `统计日期`,\n    case\n        when dregdate = dtstatdate then '新进'\n        when datediff(dtstatdate, dregdate) = 7 then '7'\n        when datediff(dtstatdate, dregdate) = 14 then '14'\n        when datediff(dtstatdate, dregdate) = 30 then '30'\n        when datediff(dtstatdate, dregdate) = 60 then '60'\n        when datediff(dtstatdate, dregdate) = 90 then '90'\n        when datediff(dtstatdate, dregdate) = 180 then '180'\n    end as `类型`,\n    count(distinct vplayerid) as `人数`\nfrom\n    dws_jordass_login_df\nwhere\n    dtstatdate between '20230712' and '20230725'\n    and platid = 255\n    and (\n        dregdate = dtstatdate\n        or datediff(dtstatdate, dregdate) = 7\n        or datediff(dtstatdate, dregdate) = 14\n        or datediff(dtstatdate, dregdate) = 30\n        or datediff(dtstatdate, dregdate) = 60\n        or datediff(dtstatdate, dregdate) = 90\n        or datediff(dtstatdate, dregdate) = 180\n    )\ngroup by\n    dtstatdate,\n    case\n        when dregdate = dtstatdate then '新进'\n        when datediff(dtstatdate, dregdate) = 7 then '7'\n        when datediff(dtstatdate, dregdate) = 14 then '14'\n        when datediff(dtstatdate, dregdate) = 30 then '30'\n        when datediff(dtstatdate, dregdate) = 60 then '60'\n        when datediff(dtstatdate, dregdate) = 90 then '90'\n        when datediff(dtstatdate, dregdate) = 180 then '180'\n    end\norder by\n    dtstatdate,\n    `类型`;\n", "status": "success", "result": [{"统计日期": "20230712", "类型": "新进", "人数": 1}]}
{"sql_id": "sql_92", "sql": "\nWITH backflow_users AS (\n    SELECT \n        vplayerid,\n        CASE WHEN (dregdate <> dtstatdate) AND (instr(substr(cbitmap, 1, 1), '1') > 0) AND (instr(substr(cbitmap, 2, 7), '1') = 0) THEN '7天回流'\n             WHEN (dregdate <> dtstatdate) AND (instr(substr(cbitmap, 1, 1), '1') > 0) AND (instr(substr(cbitmap, 2, 30), '1') = 0) THEN '30天回流'\n        END AS backflow_type\n    FROM dws_jordass_login_df\n    WHERE dtstatdate BETWEEN '20230705' AND '20230711'\n    AND platid = 255\n    AND ((dregdate <> dtstatdate) AND (instr(substr(cbitmap, 1, 1), '1') > 0) AND (instr(substr(cbitmap, 2, 7), '1') = 0) OR \n         (dregdate <> dtstatdate) AND (instr(substr(cbitmap, 1, 1), '1') > 0) AND (instr(substr(cbitmap, 2, 30), '1') = 0))\n),\n\ncurrent_week_activity AS (\n    SELECT \n        vplayerid,\n        COUNT(DISTINCT dtstatdate) AS active_days\n    FROM dws_jordass_login_di\n    WHERE dtstatdate BETWEEN '20230712' AND '20230718'\n    AND platid = 255\n    GROUP BY vplayerid\n)\n\nSELECT \n    b.backflow_type,\n    CASE \n        WHEN a.active_days BETWEEN 1 AND 2 THEN '轻度活跃'\n        WHEN a.active_days BETWEEN 3 AND 5 THEN '中度活跃'\n        WHEN a.active_days BETWEEN 6 AND 7 THEN '重度活跃'\n        ELSE '流失'\n    END AS activity_status,\n    COUNT(DISTINCT b.vplayerid) AS user_count\nFROM backflow_users b\nLEFT JOIN current_week_activity a ON b.vplayerid = a.vplayerid\nWHERE b.backflow_type IS NOT NULL\nGROUP BY \n    b.backflow_type,\n    CASE \n        WHEN a.active_days BETWEEN 1 AND 2 THEN '轻度活跃'\n        WHEN a.active_days BETWEEN 3 AND 5 THEN '中度活跃'\n        WHEN a.active_days BETWEEN 6 AND 7 THEN '重度活跃'\n        ELSE '流失'\n    END;\n", "status": "success", "result": [{"backflow_type": "7天回流", "activity_status": "中度活跃", "user_count": 1}, {"backflow_type": "7天回流", "activity_status": "轻度活跃", "user_count": 2}, {"backflow_type": "7天回流", "activity_status": "流失", "user_count": 2}]}
{"sql_id": "sql_93", "sql": "\nselect\n    date_format(dtstatdate, '%Y%m') as month,\n    case \n        when min_pay_date = dtstatdate then 1  -- 新增付费用户\n        when datediff(dtstatdate, prev_pay_date) <= 30 then 2  -- 持续付费用户\n        else 3  -- 回流付费用户\n    end as user_type,\n    count(distinct vplayerid) as user_count,\n    round(sum(imoney)/100, 2) as total_amount\nfrom (\n    select\n        vplayerid,\n        dtstatdate,\n        imoney,\n        min(dtstatdate) over (partition by vplayerid) as min_pay_date,\n        lag(dtstatdate) over (partition by vplayerid order by dtstatdate) as prev_pay_date\n    from dws_jordass_water_df\n    where dtstatdate >= '20240101' and dtstatdate <= '20240531'\n      and platid = 255\n) t\nwhere dtstatdate = date_format(dtstatdate, '%Y%m01')  -- 每月第一天作为统计点\ngroup by \n    date_format(dtstatdate, '%Y%m'),\n    case \n        when min_pay_date = dtstatdate then 1\n        when datediff(dtstatdate, prev_pay_date) <= 30 then 2\n        else 3\n    end\norder by month, user_type;\n", "status": "success", "result": [{"month": "202401", "user_type": 1, "user_count": 1, "total_amount": 1}, {"month": "202402", "user_type": 1, "user_count": 2, "total_amount": 12}]}
{"sql_id": "sql_94", "sql": "\nselect \n    a.dtstatdate as `统计日期`,\n    case \n        when a.device_type = 0 then '手机'\n        when a.device_type in (1,5) then '模拟器'\n    end as `设备类型`,\n    substr(b.dregdate, 1, 4) as `注册年份`,\n    count(distinct a.vplayerid) as `使用设备的人数`,\n    count(distinct c.vplayerid) as `使用设备玩生存模式人数`,\n    round(count(distinct c.vplayerid) * 100.0 / count(distinct a.vplayerid), 2) as `使用设备玩生存模式占总设备人数的比例`,\n    round(count(distinct case when d.vplayerid is not null then c.vplayerid end) * 100.0 / count(distinct c.vplayerid), 2) as `使用设备玩生存模式的次留率`\nfrom \n    dws_jordass_device_login_di a\njoin \n    dws_jordass_login_df b on a.vplayerid = b.vplayerid\nleft join \n    (select distinct dtstatdate, vplayerid from dws_jordass_mode_roundrecord_di where modename = '生存模式' and dtstatdate between '20241123' and '20241128') c \n    on a.vplayerid = c.vplayerid and a.dtstatdate = c.dtstatdate\nleft join \n    (select distinct vplayerid from dws_jordass_device_login_di where dtstatdate = date_add(a.dtstatdate, 1)) d \n    on c.vplayerid = d.vplayerid\nwhere \n    a.dtstatdate between '20241123' and '20241128'\n    and a.device_type in (0,1,5)\ngroup by \n    a.dtstatdate, \n    case when a.device_type = 0 then '手机' when a.device_type in (1,5) then '模拟器' end,\n    substr(b.dregdate, 1, 4)\norder by \n    a.dtstatdate, `设备类型`, `注册年份`;\n", "status": "success", "result": null}
{"sql_id": "sql_97", "sql": "\nselect\n    count(distinct a.vplayerid) as hide_players,\n    count(distinct case when b.vplayerid is not null then a.vplayerid end) as hide_and_bridge_players,\n    count(distinct case when c.vplayerid is not null then a.vplayerid end) as hide_and_hide_mode_players\nfrom (\n    select distinct vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate between '20230719' and '20230725'\n    and submodename = '隐匿'\n) a\nleft join (\n    select distinct vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate between '20230719' and '20230725'\n    and submodename = '桥梁争夺'\n) b on a.vplayerid = b.vplayerid\nleft join (\n    select distinct vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate between '20230719' and '20230725'\n    and submodename = '隐匿模式'\n) c on a.vplayerid = c.vplayerid;\n", "status": "success", "result": [{"hide_players": 0, "hide_and_bridge_players": 0, "hide_and_hide_mode_players": 0}]}
{"sql_id": "sql_98", "sql": "\nselect\n    dtstatdate,\n    user_type,\n    count(distinct vplayerid) as user_count,\n    count(distinct case when login_flag = 1 then vplayerid end) as login_count\nfrom (\n    select\n        a.dtstatdate,\n        a.vplayerid,\n        '乐园高活' as user_type,\n        1 as login_flag\n    from dws_jordass_login_di a\n    join (\n        select distinct dtstatdate, vplayerid\n        from dws_jordass_buttonpress_pre_di\n        where dtstatdate between '20240527' and '20240616'\n          and buttontype in (411111, 411120, 411123) -- 假设这些按钮类型代表乐园高活跃\n    ) b on a.dtstatdate = b.dtstatdate and a.vplayerid = b.vplayerid\n    \n    union all\n    \n    select\n        a.dtstatdate,\n        a.vplayerid,\n        '砺刃高活' as user_type,\n        1 as login_flag\n    from dws_jordass_login_di a\n    join (\n        select distinct dtstatdate, vplayerid\n        from dws_jordass_buttonpress_pre_di\n        where dtstatdate between '20240527' and '20240616'\n          and buttontype in (511111, 511120, 511123) -- 假设这些按钮类型代表砺刃高活跃\n    ) b on a.dtstatdate = b.dtstatdate and a.vplayerid = b.vplayerid\n    \n    union all\n    \n    select\n        dtstatdate,\n        vplayerid,\n        '乐园高活' as user_type,\n        0 as login_flag\n    from dws_jordass_buttonpress_pre_di\n    where dtstatdate between '20240527' and '20240616'\n      and buttontype in (411111, 411120, 411123)\n    \n    union all\n    \n    select\n        dtstatdate,\n        vplayerid,\n        '砺刃高活' as user_type,\n        0 as login_flag\n    from dws_jordass_buttonpress_pre_di\n    where dtstatdate between '20240527' and '20240616'\n      and buttontype in (511111, 511120, 511123)\n) t\ngroup by dtstatdate, user_type\norder by dtstatdate, user_type;\n", "status": "success", "result": []}
{"sql_id": "sql_99", "sql": "\nwith pay_data as (\n    select \n        vplayerid,\n        submode,\n        case \n            when submode is null or submode = '' then '砺刃'\n            else '乐园'\n        end as pay_type,\n        sum(case \n            when submode is null or submode = '' then amount/10 \n            else 0 \n        end) as jordass_amount,\n        sum(case \n            when submode is not null and submode != '' then amount/10 \n            else 0 \n        end) as park_amount\n    from dwd_jordass_payrespond_hi\n    where dteventtime >= '2024-06-01' and dteventtime <= '2024-06-30'\n    group by vplayerid, submode\n),\n\npay_tier as (\n    select \n        vplayerid,\n        submode,\n        pay_type,\n        case \n            when park_amount > 0 then \n                case \n                    when park_amount >= 1 and park_amount < 30 then '小R 1-30'\n                    when park_amount >= 30 and park_amount < 100 then '中小R 30-100'\n                    when park_amount >= 100 and park_amount < 500 then '中R 100-500'\n                    when park_amount >= 500 and park_amount < 1500 then '大R 500-1500'\n                    when park_amount >= 1500 then '超R 1500+'\n                    else '未付费'\n                end\n            else \n                case \n                    when jordass_amount >= 1 and jordass_amount < 30 then '小R 1-30'\n                    when jordass_amount >= 30 and jordass_amount < 100 then '中小R 30-100'\n                    when jordass_amount >= 100 and jordass_amount < 500 then '中R 100-500'\n                    when jordass_amount >= 500 and jordass_amount < 1500 then '大R 500-1500'\n                    when jordass_amount >= 1500 then '超R 1500+'\n                    else '未付费'\n                end\n        end as pay_tier\n    from pay_data\n)\n\nselect \n    coalesce(submode, '砺刃') as submode,\n    pay_type,\n    pay_tier,\n    count(distinct vplayerid) as user_count\nfrom pay_tier\ngroup by submode, pay_type, pay_tier\norder by submode, pay_type, \n    case pay_tier\n        when '小R 1-30' then 1\n        when '中小R 30-100' then 2\n        when '中R 100-500' then 3\n        when '大R 500-1500' then 4\n        when '超R 1500+' then 5\n        else 6\n    end;\n", "status": "success", "result": [{"submode": "submode1", "pay_type": "乐园", "pay_tier": "小R 1-30", "user_count": 2}, {"submode": "submode1", "pay_type": "乐园", "pay_tier": "中小R 30-100", "user_count": 1}, {"submode": "submode1", "pay_type": "乐园", "pay_tier": "中R 100-500", "user_count": 2}, {"submode": "submode1", "pay_type": "乐园", "pay_tier": "大R 500-1500", "user_count": 1}, {"submode": "submode2", "pay_type": "乐园", "pay_tier": "小R 1-30", "user_count": 1}, {"submode": "submode2", "pay_type": "乐园", "pay_tier": "中R 100-500", "user_count": 1}, {"submode": "submode2", "pay_type": "乐园", "pay_tier": "超R 1500+", "user_count": 1}]}
{"sql_id": "sql_100", "sql": "\nwith \n-- 玩家类型判断\nplayer_type as (\n    select \n        dtstatdate,\n        vplayerid,\n        case \n            when datediff(dtstatdate, dregdate) <= 7 then '新进玩家'\n            when datediff(dtstatdate, dregdate) <= 30 then '30日回流'\n            else '7日回流'\n        end as player_type\n    from dws_jordass_login_df\n    where dtstatdate between '20240326' and '20240527'\n),\n\n-- 付费统计\npayment_stats as (\n    select \n        substr(tdbank_imp_date,1,8) as dt,\n        vplayerid,\n        sum(imoney) as total_payment,\n        count(distinct case when imoney > 0 then vplayerid end) as paying_users\n    from dwd_jordass_currencylog_hi\n    where tdbank_imp_date between '2024032600' and '2024052723'\n    group by substr(tdbank_imp_date,1,8), vplayerid\n),\n\n-- 商业化类型统计\ncommercial_type as (\n    -- 战备\n    select '战备' as commercial_type, substr(tdbank_imp_date,1,8) as dt, vplayerid, count(*) as action_count, sum(shopprice_1) as payment\n    from dwd_jordass_marketpurchase_hi\n    where tdbank_imp_date between '2024032600' and '2024052723'\n    and shopid_1 in (1515013,1515020,1515023,1515060,1515277,1515279)\n    group by substr(tdbank_imp_date,1,8), vplayerid\n    \n    union all\n    \n    -- 直购\n    select '直购' as commercial_type, substr(tdbank_imp_date,1,8) as dt, vplayerid, count(*) as action_count, sum(shopprice_1) as payment\n    from dwd_jordass_marketpurchase_hi\n    where tdbank_imp_date between '2024032600' and '2024052723'\n    and shopid_1 not in (1515013,1515020,1515023,1515060,1515277,1515279,1515029,1515120,1515123,1515122,1515121)\n    group by substr(tdbank_imp_date,1,8), vplayerid\n    \n    union all\n    \n    -- 元素\n    select '元素' as commercial_type, substr(tdbank_imp_date,1,8) as dt, vplayerid, count(*) as action_count, sum(imoney) as payment\n    from dwd_jordass_currencylog_hi\n    where tdbank_imp_date between '2024032600' and '2024052723'\n    and reason in (189,190) and addorreduce=1 and imoneytype=1027\n    group by substr(tdbank_imp_date,1,8), vplayerid\n    \n    union all\n    \n    -- 手册\n    select '手册' as commercial_type, substr(tdbank_imp_date,1,8) as dt, vplayerid, count(*) as action_count, sum(imoney) as payment\n    from dwd_jordass_currencylog_hi\n    where tdbank_imp_date between '2024032600' and '2024052723'\n    and reason in (143,144,156,158,246,269,273) and addorreduce=1 and imoneytype=1\n    group by substr(tdbank_imp_date,1,8), vplayerid\n    \n    union all\n    \n    -- 专属卡\n    select '专属卡' as commercial_type, substr(tdbank_imp_date,1,8) as dt, vplayerid, sum(moneycnt)*10 as action_count, sum(moneycnt)*10 as payment\n    from dwd_jordass_privpackagelog_hi\n    where tdbank_imp_date between '2024032600' and '2024052723'\n    group by substr(tdbank_imp_date,1,8), vplayerid\n    \n    union all\n    \n    -- 轮盘\n    select '轮盘' as commercial_type, substr(tdbank_imp_date,1,8) as dt, vplayerid, sum(lotteryround) as action_count, sum(costnum)*10 as payment\n    from dwd_jordass_lotteryrecord_hi\n    where tdbank_imp_date between '2024032600' and '2024052723'\n    group by substr(tdbank_imp_date,1,8), vplayerid\n    \n    union all\n    \n    -- 限定抽取\n    select '限定抽取' as commercial_type, substr(tdbank_imp_date,1,8) as dt, vplayerid, count(*) as action_count, sum(costnum)*10 as payment\n    from dwd_jordass_lotterylog_twostage_hi\n    where tdbank_imp_date between '2024032600' and '2024052723'\n    group by substr(tdbank_imp_date,1,8), vplayerid\n)\n\n-- 最终结果\nselect \n    pt.dtstatdate as date,\n    pt.player_type,\n    count(distinct pt.vplayerid) as total_users,\n    sum(ps.total_payment) as total_payment,\n    count(distinct case when ps.total_payment > 0 then pt.vplayerid end) as paying_users,\n    ct.commercial_type,\n    count(distinct ct.vplayerid) as active_users,\n    sum(ct.action_count) as action_count,\n    sum(ct.payment) as payment_amount\nfrom player_type pt\nleft join payment_stats ps on pt.dtstatdate = ps.dt and pt.vplayerid = ps.vplayerid\nleft join commercial_type ct on pt.dtstatdate = ct.dt and pt.vplayerid = ct.vplayerid\ngroup by pt.dtstatdate, pt.player_type, ct.commercial_type\norder by pt.dtstatdate, pt.player_type, ct.commercial_type;\n", "status": "success", "result": [{"date": "20240331", "player_type": "30日回流", "total_users": 1, "total_payment": null, "paying_users": 0, "commercial_type": null, "active_users": 0, "action_count": null, "payment_amount": null}, {"date": "20240331", "player_type": "7日回流", "total_users": 497, "total_payment": null, "paying_users": 0, "commercial_type": null, "active_users": 0, "action_count": null, "payment_amount": null}, {"date": "20240401", "player_type": "新进玩家", "total_users": 1, "total_payment": 50, "paying_users": 1, "commercial_type": "专属卡", "active_users": 1, "action_count": 180, "payment_amount": 180}, {"date": "20240401", "player_type": "新进玩家", "total_users": 1, "total_payment": 50, "paying_users": 1, "commercial_type": "元素", "active_users": 1, "action_count": 1, "payment_amount": 50}, {"date": "20240401", "player_type": "新进玩家", "total_users": 1, "total_payment": 50, "paying_users": 1, "commercial_type": "轮盘", "active_users": 1, "action_count": 3, "payment_amount": 50}, {"date": "20240401", "player_type": "新进玩家", "total_users": 1, "total_payment": 50, "paying_users": 1, "commercial_type": "限定抽取", "active_users": 1, "action_count": 1, "payment_amount": 20}, {"date": "20240402", "player_type": "30日回流", "total_users": 1, "total_payment": 60, "paying_users": 1, "commercial_type": "专属卡", "active_users": 1, "action_count": 200, "payment_amount": 200}, {"date": "20240402", "player_type": "30日回流", "total_users": 1, "total_payment": 60, "paying_users": 1, "commercial_type": "元素", "active_users": 1, "action_count": 1, "payment_amount": 60}, {"date": "20240402", "player_type": "30日回流", "total_users": 1, "total_payment": 60, "paying_users": 1, "commercial_type": "轮盘", "active_users": 1, "action_count": 2, "payment_amount": 30}, {"date": "20240402", "player_type": "30日回流", "total_users": 1, "total_payment": 60, "paying_users": 1, "commercial_type": "限定抽取", "active_users": 1, "action_count": 1, "payment_amount": 10}, {"date": "20240403", "player_type": "30日回流", "total_users": 1, "total_payment": 70, "paying_users": 1, "commercial_type": "专属卡", "active_users": 1, "action_count": 150, "payment_amount": 150}, {"date": "20240403", "player_type": "30日回流", "total_users": 1, "total_payment": 70, "paying_users": 1, "commercial_type": "手册", "active_users": 1, "action_count": 1, "payment_amount": 70}, {"date": "20240403", "player_type": "30日回流", "total_users": 1, "total_payment": 70, "paying_users": 1, "commercial_type": "轮盘", "active_users": 1, "action_count": 1, "payment_amount": 40}, {"date": "20240403", "player_type": "30日回流", "total_users": 1, "total_payment": 70, "paying_users": 1, "commercial_type": "限定抽取", "active_users": 1, "action_count": 1, "payment_amount": 30}, {"date": "20240404", "player_type": "30日回流", "total_users": 1, "total_payment": 80, "paying_users": 1, "commercial_type": "专属卡", "active_users": 1, "action_count": 250, "payment_amount": 250}, {"date": "20240404", "player_type": "30日回流", "total_users": 1, "total_payment": 80, "paying_users": 1, "commercial_type": "手册", "active_users": 1, "action_count": 1, "payment_amount": 80}, {"date": "20240404", "player_type": "30日回流", "total_users": 1, "total_payment": 80, "paying_users": 1, "commercial_type": "轮盘", "active_users": 1, "action_count": 4, "payment_amount": 60}, {"date": "20240404", "player_type": "30日回流", "total_users": 1, "total_payment": 80, "paying_users": 1, "commercial_type": "限定抽取", "active_users": 1, "action_count": 1, "payment_amount": 40}, {"date": "20240405", "player_type": "7日回流", "total_users": 1, "total_payment": 90, "paying_users": 1, "commercial_type": "专属卡", "active_users": 1, "action_count": 300, "payment_amount": 300}, {"date": "20240405", "player_type": "7日回流", "total_users": 1, "total_payment": 90, "paying_users": 1, "commercial_type": "手册", "active_users": 1, "action_count": 1, "payment_amount": 90}, {"date": "20240405", "player_type": "7日回流", "total_users": 1, "total_payment": 90, "paying_users": 1, "commercial_type": "轮盘", "active_users": 1, "action_count": 2, "payment_amount": 20}, {"date": "20240405", "player_type": "7日回流", "total_users": 1, "total_payment": 90, "paying_users": 1, "commercial_type": "限定抽取", "active_users": 1, "action_count": 1, "payment_amount": 10}, {"date": "20240406", "player_type": "7日回流", "total_users": 1, "total_payment": 100, "paying_users": 1, "commercial_type": "专属卡", "active_users": 1, "action_count": 100, "payment_amount": 100}, {"date": "20240406", "player_type": "7日回流", "total_users": 1, "total_payment": 100, "paying_users": 1, "commercial_type": "手册", "active_users": 1, "action_count": 1, "payment_amount": 100}, {"date": "20240406", "player_type": "7日回流", "total_users": 1, "total_payment": 100, "paying_users": 1, "commercial_type": "轮盘", "active_users": 1, "action_count": 5, "payment_amount": 70}, {"date": "20240406", "player_type": "7日回流", "total_users": 1, "total_payment": 100, "paying_users": 1, "commercial_type": "限定抽取", "active_users": 1, "action_count": 1, "payment_amount": 50}, {"date": "20240407", "player_type": "新进玩家", "total_users": 1, "total_payment": 110, "paying_users": 1, "commercial_type": "专属卡", "active_users": 1, "action_count": 220, "payment_amount": 220}, {"date": "20240407", "player_type": "新进玩家", "total_users": 1, "total_payment": 110, "paying_users": 1, "commercial_type": "手册", "active_users": 1, "action_count": 1, "payment_amount": 110}, {"date": "20240407", "player_type": "新进玩家", "total_users": 1, "total_payment": 110, "paying_users": 1, "commercial_type": "轮盘", "active_users": 1, "action_count": 1, "payment_amount": 10}, {"date": "20240407", "player_type": "新进玩家", "total_users": 1, "total_payment": 110, "paying_users": 1, "commercial_type": "限定抽取", "active_users": 1, "action_count": 1, "payment_amount": 20}, {"date": "20240408", "player_type": "新进玩家", "total_users": 1, "total_payment": 120, "paying_users": 1, "commercial_type": "专属卡", "active_users": 1, "action_count": 170, "payment_amount": 170}, {"date": "20240408", "player_type": "新进玩家", "total_users": 1, "total_payment": 120, "paying_users": 1, "commercial_type": "手册", "active_users": 1, "action_count": 1, "payment_amount": 120}, {"date": "20240408", "player_type": "新进玩家", "total_users": 1, "total_payment": 120, "paying_users": 1, "commercial_type": "轮盘", "active_users": 1, "action_count": 3, "payment_amount": 30}, {"date": "20240408", "player_type": "新进玩家", "total_users": 1, "total_payment": 120, "paying_users": 1, "commercial_type": "限定抽取", "active_users": 1, "action_count": 1, "payment_amount": 30}, {"date": "20240414", "player_type": "7日回流", "total_users": 250, "total_payment": null, "paying_users": 0, "commercial_type": null, "active_users": 0, "action_count": null, "payment_amount": null}, {"date": "20240430", "player_type": "30日回流", "total_users": 2, "total_payment": null, "paying_users": 0, "commercial_type": null, "active_users": 0, "action_count": null, "payment_amount": null}, {"date": "20240430", "player_type": "7日回流", "total_users": 498, "total_payment": null, "paying_users": 0, "commercial_type": null, "active_users": 0, "action_count": null, "payment_amount": null}, {"date": "20240505", "player_type": "30日回流", "total_users": 6, "total_payment": null, "paying_users": 0, "commercial_type": null, "active_users": 0, "action_count": null, "payment_amount": null}, {"date": "20240505", "player_type": "7日回流", "total_users": 883, "total_payment": null, "paying_users": 0, "commercial_type": null, "active_users": 0, "action_count": null, "payment_amount": null}, {"date": "20240505", "player_type": "新进玩家", "total_users": 7, "total_payment": null, "paying_users": 0, "commercial_type": null, "active_users": 0, "action_count": null, "payment_amount": null}, {"date": "20240519", "player_type": "7日回流", "total_users": 250, "total_payment": null, "paying_users": 0, "commercial_type": null, "active_users": 0, "action_count": null, "payment_amount": null}]}
{"sql_id": "sql_101", "sql": "\nselect \n    a.dtstatdate,\n    case \n        when substr(b.seasonmaxsegment, 1, 1) = '1' then '青铜'\n        when substr(b.seasonmaxsegment, 1, 1) = '2' then '白银'\n        when substr(b.seasonmaxsegment, 1, 1) = '3' then '黄金'\n        when substr(b.seasonmaxsegment, 1, 1) = '4' then '铂金'\n        when substr(b.seasonmaxsegment, 1, 1) = '5' then '星钻'\n        when substr(b.seasonmaxsegment, 1, 1) = '6' then '王冠'\n        when substr(b.seasonmaxsegment, 1, 1) >= '7' then '王牌'\n        else '无段位'\n    end as season_max_segment,\n    count(distinct a.vplayerid) as active_users,\n    count(distinct c.vplayerid) as theme_participants,\n    count(distinct c.vplayerid) / count(distinct a.vplayerid) as participation_rate\nfrom \n    dws_jordass_login_di a\nleft join \n    dwd_jordass_playerlogin_hi b on a.vplayerid = b.vplayerid\nleft join (\n    select distinct dtstatdate, vplayerid \n    from dws_jordass_mode_roundrecord_di \n    where modename='传统模式' and submodename like 'CG%'\n) c on a.dtstatdate = c.dtstatdate and a.vplayerid = c.vplayerid\nwhere \n    a.dtstatdate in ('20240902', '20240903', '20250908', '20250909')\n    and a.platid = 255\ngroup by \n    a.dtstatdate,\n    case \n        when substr(b.seasonmaxsegment, 1, 1) = '1' then '青铜'\n        when substr(b.seasonmaxsegment, 1, 1) = '2' then '白银'\n        when substr(b.seasonmaxsegment, 1, 1) = '3' then '黄金'\n        when substr(b.seasonmaxsegment, 1, 1) = '4' then '铂金'\n        when substr(b.seasonmaxsegment, 1, 1) = '5' then '星钻'\n        when substr(b.seasonmaxsegment, 1, 1) = '6' then '王冠'\n        when substr(b.seasonmaxsegment, 1, 1) >= '7' then '王牌'\n        else '无段位'\n    end\norder by \n    a.dtstatdate, \n    case \n        when substr(b.seasonmaxsegment, 1, 1) = '1' then 1\n        when substr(b.seasonmaxsegment, 1, 1) = '2' then 2\n        when substr(b.seasonmaxsegment, 1, 1) = '3' then 3\n        when substr(b.seasonmaxsegment, 1, 1) = '4' then 4\n        when substr(b.seasonmaxsegment, 1, 1) = '5' then 5\n        when substr(b.seasonmaxsegment, 1, 1) = '6' then 6\n        when substr(b.seasonmaxsegment, 1, 1) >= '7' then 7\n        else 8\n    end;\n", "status": "success", "result": null}
{"sql_id": "sql_103", "sql": "\nselect\n    substr(d.dteventtime, 1, 8) as stat_date,\n    d.productid,\n    count(distinct d.vplayerid) as buyer_count,\n    sum(d.money) as total_amount,\n    sum(d.goodsnum) as total_quantity,\n    count(distinct case when l.dregdate = substr(d.dteventtime, 1, 8) then d.vplayerid end) as same_day_reg_count\nfrom dwd_jordass_directpaycommflow_hi d\nleft join dws_jordass_login_df l on d.vplayerid = l.vplayerid\nwhere substr(d.dteventtime, 1, 8) between '20250901' and '20250910'\n  and d.op = 'take' \n  and d.opres = 'ok'\n  and d.productid in ('package_6','package_18','outfit_pack','weapon_pack')\ngroup by substr(d.dteventtime, 1, 8), d.productid\norder by stat_date, d.productid;\n", "status": "success", "result": []}
{"sql_id": "sql_105", "sql": "\nselect\n    a.dtstatdate,\n    a.recharge_amount,\n    b.gold_consumed\nfrom (\n    -- 每天充值金额\n    select\n        dtstatdate,\n        sum(imoney/100) as recharge_amount\n    from dws_jordass_water_di\n    where dtstatdate between '20240101' and '20250601'\n      and platid = 255\n    group by dtstatdate\n) a\nleft join (\n    -- 每天金币消耗\n    select\n        substr(dteventtime, 1, 8) as dtstatdate,\n        sum(imoney) as gold_consumed\n    from dwd_jordass_currencylog_hi\n    where substr(dteventtime, 1, 8) between '20240101' and '20250601'\n      and platid = 255\n      and imoneytype = 0  -- 金币\n      and addorreduce = 1 -- 消耗\n    group by substr(dteventtime, 1, 8)\n) b on a.dtstatdate = b.dtstatdate\norder by a.dtstatdate;\n", "status": "success", "result": [{"dtstatdate": "20240101", "recharge_amount": 1229.3, "gold_consumed": null}, {"dtstatdate": "20240102", "recharge_amount": 247.3, "gold_consumed": null}, {"dtstatdate": "20240103", "recharge_amount": 14.3, "gold_consumed": null}, {"dtstatdate": "20240104", "recharge_amount": 297.3, "gold_consumed": null}, {"dtstatdate": "20240105", "recharge_amount": 283.3, "gold_consumed": null}, {"dtstatdate": "20240106", "recharge_amount": 1352.8, "gold_consumed": null}, {"dtstatdate": "20240107", "recharge_amount": 852.8, "gold_consumed": null}, {"dtstatdate": "20240108", "recharge_amount": 157.8, "gold_consumed": null}, {"dtstatdate": "20240109", "recharge_amount": 1885.8, "gold_consumed": null}, {"dtstatdate": "20240110", "recharge_amount": 184.3, "gold_consumed": null}, {"dtstatdate": "20240111", "recharge_amount": 176.3, "gold_consumed": null}, {"dtstatdate": "20240112", "recharge_amount": 281.8, "gold_consumed": null}, {"dtstatdate": "20240113", "recharge_amount": 722.8, "gold_consumed": null}, {"dtstatdate": "20240114", "recharge_amount": 45.8, "gold_consumed": null}, {"dtstatdate": "20240115", "recharge_amount": 65.8, "gold_consumed": null}, {"dtstatdate": "20240116", "recharge_amount": 194.8, "gold_consumed": null}, {"dtstatdate": "20240117", "recharge_amount": 1119.8, "gold_consumed": null}, {"dtstatdate": "20240118", "recharge_amount": 5118.8, "gold_consumed": null}, {"dtstatdate": "20240119", "recharge_amount": 4172.8, "gold_consumed": null}, {"dtstatdate": "20240120", "recharge_amount": 686.8, "gold_consumed": null}, {"dtstatdate": "20240121", "recharge_amount": 480, "gold_consumed": null}, {"dtstatdate": "20240122", "recharge_amount": 342, "gold_consumed": null}, {"dtstatdate": "20240123", "recharge_amount": 295, "gold_consumed": null}, {"dtstatdate": "20240124", "recharge_amount": 444, "gold_consumed": null}, {"dtstatdate": "20240125", "recharge_amount": 316, "gold_consumed": null}, {"dtstatdate": "20240126", "recharge_amount": 382, "gold_consumed": null}, {"dtstatdate": "20240127", "recharge_amount": 277, "gold_consumed": null}, {"dtstatdate": "20240128", "recharge_amount": 231, "gold_consumed": null}, {"dtstatdate": "20240129", "recharge_amount": 93, "gold_consumed": null}, {"dtstatdate": "20240130", "recharge_amount": 223, "gold_consumed": null}, {"dtstatdate": "20240131", "recharge_amount": 284, "gold_consumed": null}, {"dtstatdate": "20240201", "recharge_amount": 129, "gold_consumed": null}, {"dtstatdate": "20240202", "recharge_amount": 1518, "gold_consumed": null}, {"dtstatdate": "20240203", "recharge_amount": 161, "gold_consumed": null}, {"dtstatdate": "20240204", "recharge_amount": 145, "gold_consumed": null}, {"dtstatdate": "20240205", "recharge_amount": 128, "gold_consumed": null}, {"dtstatdate": "20240206", "recharge_amount": 237, "gold_consumed": null}, {"dtstatdate": "20240207", "recharge_amount": 637, "gold_consumed": null}, {"dtstatdate": "20240208", "recharge_amount": 452, "gold_consumed": null}, {"dtstatdate": "20240209", "recharge_amount": 5086, "gold_consumed": null}, {"dtstatdate": "20240210", "recharge_amount": 2156, "gold_consumed": null}, {"dtstatdate": "20240211", "recharge_amount": 6692, "gold_consumed": null}, {"dtstatdate": "20240212", "recharge_amount": 1137, "gold_consumed": null}, {"dtstatdate": "20240213", "recharge_amount": 1861, "gold_consumed": null}, {"dtstatdate": "20240214", "recharge_amount": 630, "gold_consumed": null}, {"dtstatdate": "20240215", "recharge_amount": 1828, "gold_consumed": null}, {"dtstatdate": "20240216", "recharge_amount": 2351, "gold_consumed": null}, {"dtstatdate": "20240217", "recharge_amount": 895, "gold_consumed": null}, {"dtstatdate": "20240218", "recharge_amount": 400, "gold_consumed": null}, {"dtstatdate": "20240219", "recharge_amount": 1494, "gold_consumed": null}, {"dtstatdate": "20240220", "recharge_amount": 296, "gold_consumed": null}, {"dtstatdate": "20240221", "recharge_amount": 1544, "gold_consumed": null}, {"dtstatdate": "20240222", "recharge_amount": 3283, "gold_consumed": null}, {"dtstatdate": "20240223", "recharge_amount": 2171, "gold_consumed": null}, {"dtstatdate": "20240224", "recharge_amount": 660, "gold_consumed": null}, {"dtstatdate": "20240225", "recharge_amount": 534, "gold_consumed": null}, {"dtstatdate": "20240226", "recharge_amount": 963, "gold_consumed": null}, {"dtstatdate": "20240227", "recharge_amount": 674, "gold_consumed": null}, {"dtstatdate": "20240228", "recharge_amount": 767, "gold_consumed": null}, {"dtstatdate": "20240229", "recharge_amount": 366, "gold_consumed": null}, {"dtstatdate": "20240301", "recharge_amount": 2257.5, "gold_consumed": null}, {"dtstatdate": "20240302", "recharge_amount": 2243, "gold_consumed": null}, {"dtstatdate": "20240303", "recharge_amount": 1392, "gold_consumed": null}, {"dtstatdate": "20240304", "recharge_amount": 513, "gold_consumed": null}, {"dtstatdate": "20240305", "recharge_amount": 2165, "gold_consumed": null}, {"dtstatdate": "20240306", "recharge_amount": 619, "gold_consumed": null}, {"dtstatdate": "20240307", "recharge_amount": 1516, "gold_consumed": null}, {"dtstatdate": "20240308", "recharge_amount": 1546, "gold_consumed": null}, {"dtstatdate": "20240309", "recharge_amount": 767.8, "gold_consumed": null}, {"dtstatdate": "20240310", "recharge_amount": 2507, "gold_consumed": null}, {"dtstatdate": "20240311", "recharge_amount": 643.8, "gold_consumed": null}, {"dtstatdate": "20240312", "recharge_amount": 541, "gold_consumed": null}, {"dtstatdate": "20240313", "recharge_amount": 796, "gold_consumed": null}, {"dtstatdate": "20240314", "recharge_amount": 432, "gold_consumed": null}, {"dtstatdate": "20240315", "recharge_amount": 446, "gold_consumed": null}, {"dtstatdate": "20240316", "recharge_amount": 4486, "gold_consumed": null}, {"dtstatdate": "20240317", "recharge_amount": 1055, "gold_consumed": null}, {"dtstatdate": "20240318", "recharge_amount": 1469, "gold_consumed": null}, {"dtstatdate": "20240319", "recharge_amount": 202, "gold_consumed": null}, {"dtstatdate": "20240320", "recharge_amount": 310, "gold_consumed": null}, {"dtstatdate": "20240321", "recharge_amount": 811, "gold_consumed": null}, {"dtstatdate": "20240322", "recharge_amount": 1790, "gold_consumed": null}, {"dtstatdate": "20240323", "recharge_amount": 2097, "gold_consumed": null}, {"dtstatdate": "20240324", "recharge_amount": 915, "gold_consumed": null}, {"dtstatdate": "20240325", "recharge_amount": 510, "gold_consumed": null}, {"dtstatdate": "20240326", "recharge_amount": 3072, "gold_consumed": null}, {"dtstatdate": "20240327", "recharge_amount": 1741, "gold_consumed": null}, {"dtstatdate": "20240328", "recharge_amount": 135, "gold_consumed": null}, {"dtstatdate": "20240329", "recharge_amount": 4976, "gold_consumed": null}, {"dtstatdate": "20240330", "recharge_amount": 2265, "gold_consumed": null}, {"dtstatdate": "20240331", "recharge_amount": 1716, "gold_consumed": null}, {"dtstatdate": "20240401", "recharge_amount": 283.5, "gold_consumed": null}, {"dtstatdate": "20240402", "recharge_amount": 569, "gold_consumed": null}, {"dtstatdate": "20240403", "recharge_amount": 2894, "gold_consumed": null}, {"dtstatdate": "20240404", "recharge_amount": 536, "gold_consumed": null}, {"dtstatdate": "20240405", "recharge_amount": 1003, "gold_consumed": null}, {"dtstatdate": "20240406", "recharge_amount": 612, "gold_consumed": null}, {"dtstatdate": "20240407", "recharge_amount": 282, "gold_consumed": null}, {"dtstatdate": "20240408", "recharge_amount": 279, "gold_consumed": null}, {"dtstatdate": "20240409", "recharge_amount": 296, "gold_consumed": null}, {"dtstatdate": "20240410", "recharge_amount": 1010, "gold_consumed": null}, {"dtstatdate": "20240411", "recharge_amount": 640, "gold_consumed": null}, {"dtstatdate": "20240412", "recharge_amount": 353, "gold_consumed": null}, {"dtstatdate": "20240413", "recharge_amount": 119, "gold_consumed": null}, {"dtstatdate": "20240414", "recharge_amount": 376, "gold_consumed": null}, {"dtstatdate": "20240415", "recharge_amount": 2675.5, "gold_consumed": null}, {"dtstatdate": "20240416", "recharge_amount": 2147, "gold_consumed": null}, {"dtstatdate": "20240417", "recharge_amount": 473, "gold_consumed": null}, {"dtstatdate": "20240418", "recharge_amount": 612, "gold_consumed": null}, {"dtstatdate": "20240419", "recharge_amount": 409, "gold_consumed": null}, {"dtstatdate": "20240420", "recharge_amount": 618, "gold_consumed": null}, {"dtstatdate": "20240422", "recharge_amount": 373, "gold_consumed": null}, {"dtstatdate": "20240424", "recharge_amount": 247, "gold_consumed": null}, {"dtstatdate": "20240425", "recharge_amount": 393, "gold_consumed": null}, {"dtstatdate": "20240426", "recharge_amount": 3190, "gold_consumed": null}, {"dtstatdate": "20240427", "recharge_amount": 949, "gold_consumed": null}, {"dtstatdate": "20240428", "recharge_amount": 424, "gold_consumed": null}, {"dtstatdate": "20240429", "recharge_amount": 374, "gold_consumed": null}, {"dtstatdate": "20240430", "recharge_amount": 2816, "gold_consumed": null}, {"dtstatdate": "20240501", "recharge_amount": 1700, "gold_consumed": null}, {"dtstatdate": "20240502", "recharge_amount": 1299, "gold_consumed": null}, {"dtstatdate": "20240503", "recharge_amount": 2323, "gold_consumed": null}, {"dtstatdate": "20240504", "recharge_amount": 429, "gold_consumed": null}, {"dtstatdate": "20240505", "recharge_amount": 361, "gold_consumed": null}, {"dtstatdate": "20240506", "recharge_amount": 1467, "gold_consumed": null}, {"dtstatdate": "20240507", "recharge_amount": 290, "gold_consumed": null}, {"dtstatdate": "20240508", "recharge_amount": 871, "gold_consumed": null}, {"dtstatdate": "20240509", "recharge_amount": 1490, "gold_consumed": null}, {"dtstatdate": "20240510", "recharge_amount": 488, "gold_consumed": null}, {"dtstatdate": "20240511", "recharge_amount": 715, "gold_consumed": null}, {"dtstatdate": "20240512", "recharge_amount": 421, "gold_consumed": null}, {"dtstatdate": "20240513", "recharge_amount": 586, "gold_consumed": null}, {"dtstatdate": "20240514", "recharge_amount": 960, "gold_consumed": null}, {"dtstatdate": "20240515", "recharge_amount": 50, "gold_consumed": null}, {"dtstatdate": "20240516", "recharge_amount": 3168, "gold_consumed": null}, {"dtstatdate": "20240517", "recharge_amount": 1578, "gold_consumed": null}, {"dtstatdate": "20240518", "recharge_amount": 1289, "gold_consumed": null}, {"dtstatdate": "20240519", "recharge_amount": 888, "gold_consumed": null}, {"dtstatdate": "20240520", "recharge_amount": 658, "gold_consumed": null}, {"dtstatdate": "20240521", "recharge_amount": 730, "gold_consumed": null}, {"dtstatdate": "20240522", "recharge_amount": 1313, "gold_consumed": null}, {"dtstatdate": "20240523", "recharge_amount": 314, "gold_consumed": null}, {"dtstatdate": "20240524", "recharge_amount": 677, "gold_consumed": null}, {"dtstatdate": "20240525", "recharge_amount": 375, "gold_consumed": null}, {"dtstatdate": "20240526", "recharge_amount": 278, "gold_consumed": null}, {"dtstatdate": "20240527", "recharge_amount": 148, "gold_consumed": null}, {"dtstatdate": "20240528", "recharge_amount": 830, "gold_consumed": null}, {"dtstatdate": "20240529", "recharge_amount": 1164, "gold_consumed": null}, {"dtstatdate": "20240530", "recharge_amount": 208.5, "gold_consumed": null}, {"dtstatdate": "20240531", "recharge_amount": 312.5, "gold_consumed": null}, {"dtstatdate": "20240601", "recharge_amount": 1092.5, "gold_consumed": null}, {"dtstatdate": "20240602", "recharge_amount": 225, "gold_consumed": null}, {"dtstatdate": "20240603", "recharge_amount": 1247, "gold_consumed": null}, {"dtstatdate": "20240604", "recharge_amount": 880, "gold_consumed": null}, {"dtstatdate": "20240605", "recharge_amount": 386, "gold_consumed": null}, {"dtstatdate": "20240606", "recharge_amount": 1276, "gold_consumed": null}, {"dtstatdate": "20240607", "recharge_amount": 3737, "gold_consumed": null}, {"dtstatdate": "20240608", "recharge_amount": 868, "gold_consumed": null}, {"dtstatdate": "20240609", "recharge_amount": 498, "gold_consumed": null}, {"dtstatdate": "20240611", "recharge_amount": 531, "gold_consumed": null}, {"dtstatdate": "20240612", "recharge_amount": 138, "gold_consumed": null}, {"dtstatdate": "20240613", "recharge_amount": 2238, "gold_consumed": null}, {"dtstatdate": "20240614", "recharge_amount": 499, "gold_consumed": null}, {"dtstatdate": "20240615", "recharge_amount": 2490, "gold_consumed": null}, {"dtstatdate": "20240616", "recharge_amount": 1143, "gold_consumed": null}, {"dtstatdate": "20240617", "recharge_amount": 620, "gold_consumed": null}, {"dtstatdate": "20240618", "recharge_amount": 479, "gold_consumed": null}, {"dtstatdate": "20240619", "recharge_amount": 672, "gold_consumed": null}, {"dtstatdate": "20240620", "recharge_amount": 1185, "gold_consumed": null}, {"dtstatdate": "20240621", "recharge_amount": 2621, "gold_consumed": null}, {"dtstatdate": "20240622", "recharge_amount": 782, "gold_consumed": null}, {"dtstatdate": "20240623", "recharge_amount": 2060, "gold_consumed": null}, {"dtstatdate": "20240626", "recharge_amount": 1907, "gold_consumed": null}, {"dtstatdate": "20240627", "recharge_amount": 493, "gold_consumed": null}, {"dtstatdate": "20240628", "recharge_amount": 486, "gold_consumed": null}, {"dtstatdate": "20240629", "recharge_amount": 1350, "gold_consumed": null}, {"dtstatdate": "20240630", "recharge_amount": 1173, "gold_consumed": null}, {"dtstatdate": "20240701", "recharge_amount": 4574, "gold_consumed": null}, {"dtstatdate": "20240702", "recharge_amount": 524, "gold_consumed": null}, {"dtstatdate": "20240703", "recharge_amount": 124, "gold_consumed": null}, {"dtstatdate": "20240704", "recharge_amount": 232, "gold_consumed": null}, {"dtstatdate": "20240705", "recharge_amount": 628, "gold_consumed": null}, {"dtstatdate": "20240708", "recharge_amount": 462, "gold_consumed": null}, {"dtstatdate": "20240709", "recharge_amount": 316, "gold_consumed": null}, {"dtstatdate": "20240710", "recharge_amount": 123, "gold_consumed": null}, {"dtstatdate": "20240711", "recharge_amount": 2281, "gold_consumed": null}, {"dtstatdate": "20240712", "recharge_amount": 2236, "gold_consumed": null}, {"dtstatdate": "20240713", "recharge_amount": 789, "gold_consumed": null}, {"dtstatdate": "20240714", "recharge_amount": 132, "gold_consumed": null}, {"dtstatdate": "20240715", "recharge_amount": 12376, "gold_consumed": null}, {"dtstatdate": "20240716", "recharge_amount": 499, "gold_consumed": null}, {"dtstatdate": "20240717", "recharge_amount": 79, "gold_consumed": null}, {"dtstatdate": "20240718", "recharge_amount": 53, "gold_consumed": null}, {"dtstatdate": "20240719", "recharge_amount": 3623.7, "gold_consumed": null}, {"dtstatdate": "20240720", "recharge_amount": 2288, "gold_consumed": null}, {"dtstatdate": "20240721", "recharge_amount": 480, "gold_consumed": null}, {"dtstatdate": "20240722", "recharge_amount": 12517, "gold_consumed": null}, {"dtstatdate": "20240723", "recharge_amount": 1433, "gold_consumed": null}, {"dtstatdate": "20240725", "recharge_amount": 841, "gold_consumed": null}, {"dtstatdate": "20240726", "recharge_amount": 1788, "gold_consumed": null}, {"dtstatdate": "20240728", "recharge_amount": 1002, "gold_consumed": null}, {"dtstatdate": "20240731", "recharge_amount": 1, "gold_consumed": null}, {"dtstatdate": "20240801", "recharge_amount": 50000, "gold_consumed": null}, {"dtstatdate": "20240815", "recharge_amount": 200000, "gold_consumed": null}, {"dtstatdate": "20240901", "recharge_amount": 800000, "gold_consumed": null}, {"dtstatdate": "20240915", "recharge_amount": 3500000, "gold_consumed": null}, {"dtstatdate": "20241001", "recharge_amount": 12000000, "gold_consumed": null}, {"dtstatdate": "20241015", "recharge_amount": 50000000, "gold_consumed": null}, {"dtstatdate": "20241101", "recharge_amount": 200000000, "gold_consumed": null}, {"dtstatdate": "20241115", "recharge_amount": 800000000, "gold_consumed": null}, {"dtstatdate": "20241201", "recharge_amount": 3500001200, "gold_consumed": null}, {"dtstatdate": "20241205", "recharge_amount": 0.6, "gold_consumed": null}, {"dtstatdate": "20241210", "recharge_amount": 0.8, "gold_consumed": null}, {"dtstatdate": "20241215", "recharge_amount": 12000000001, "gold_consumed": null}, {"dtstatdate": "20241220", "recharge_amount": 0.3, "gold_consumed": null}, {"dtstatdate": "20241225", "recharge_amount": 0.4, "gold_consumed": null}, {"dtstatdate": "20241230", "recharge_amount": 0.5, "gold_consumed": null}, {"dtstatdate": "20241231", "recharge_amount": 50000000000, "gold_consumed": null}, {"dtstatdate": "20250115", "recharge_amount": 6000, "gold_consumed": null}, {"dtstatdate": "20250220", "recharge_amount": 10000, "gold_consumed": null}, {"dtstatdate": "20250225", "recharge_amount": 20000, "gold_consumed": null}]}
{"sql_id": "sql_107", "sql": "\nselect\n    count(distinct case when a.dteventtime between '2022-01-18' and '2022-01-24' then a.vplayerid end) as period1_count,\n    count(distinct case when a.dteventtime between '2021-10-19' and '2021-12-20' then a.vplayerid end) as period2_count,\n    count(distinct case when b.vplayerid is not null and c.vplayerid is not null then b.vplayerid end) as overlap_count\nfrom dwd_jordass_activitypress_hi a\nleft join (\n    select distinct vplayerid\n    from dwd_jordass_activitypress_hi\n    where dteventtime between '2022-01-18' and '2022-01-24'\n    and buttontype = 99123\n    and ireason = 3\n) b on a.vplayerid = b.vplayerid\nleft join (\n    select distinct vplayerid\n    from dwd_jordass_activitypress_hi\n    where dteventtime between '2021-10-19' and '2021-12-20'\n    and buttontype = 99123\n    and ireason = 3\n) c on a.vplayerid = c.vplayerid\nwhere a.buttontype = 99123\nand a.ireason = 3;\n", "status": "success", "result": [{"period1_count": 8, "period2_count": 7, "overlap_count": 3}]}
{"sql_id": "sql_108", "sql": "\nselect \n    'iweek' as type,\n    qq.iqq as qq_number\nfrom dws_jordass_login_di login\njoin dim_mgamejp_tbplayerid2qq_nf qq on login.vplayerid = qq.splayerid\nwhere login.dtstatdate = '20250424'\n  and login.platid = 255\n  and login.ilogincount = 0\n  and datediff('20250424', login.dtstatdate) <= 7\n\nunion all\n\nselect \n    'doubleiweek' as type,\n    qq.iqq as qq_number\nfrom dws_jordass_login_di login\njoin dim_mgamejp_tbplayerid2qq_nf qq on login.vplayerid = qq.splayerid\nwhere login.dtstatdate = '20250424'\n  and login.platid = 255\n  and login.ilogincount = 0\n  and datediff('20250424', login.dtstatdate) <= 14\n\nunion all\n\nselect \n    'imonth' as type,\n    qq.iqq as qq_number\nfrom dws_jordass_login_di login\njoin dim_mgamejp_tbplayerid2qq_nf qq on login.vplayerid = qq.splayerid\nwhere login.dtstatdate = '20250424'\n  and login.platid = 255\n  and login.ilogincount = 0\n  and datediff('20250424', login.dtstatdate) <= 30\n\nunion all\n\nselect \n    '30dayxioayu3day' as type,\n    qq.iqq as qq_number\nfrom dws_jordass_login_di login\njoin dim_mgamejp_tbplayerid2qq_nf qq on login.vplayerid = qq.splayerid\nwhere login.dtstatdate = '20250424'\n  and login.platid = 255\n  and (\n      select count(distinct dtstatdate) \n      from dws_jordass_login_di \n      where vplayerid = login.vplayerid \n        and dtstatdate between date_sub('20250424', 29) and '20250424'\n  ) < 3;\n", "status": "success", "result": []}
{"sql_id": "sql_109", "sql": "\nwith victory_counts as (\n    select \n        vplayerid,\n        sum(case when result = 1 then 1 else 0 end) as total_wins\n    from dwd_jordass_roundflow_hi\n    where dteventtime between '20250424' and '20250508'\n      and mode in (101,102,103,401,402,403,201,202,203,601,602,603)\n    group by vplayerid\n)\n\nselect \n    case \n        when total_wins = 1 then '1'\n        when total_wins between 2 and 10 then '2-10'\n        when total_wins between 11 and 20 then '11-20'\n        when total_wins between 21 and 50 then '21-50'\n        when total_wins between 51 and 80 then '51-80'\n        when total_wins between 81 and 100 then '81-100'\n        when total_wins between 101 and 200 then '101-200'\n        when total_wins between 201 and 500 then '201-500'\n        when total_wins > 500 then '501以上'\n    end as victory_range,\n    count(distinct vplayerid) as player_count\nfrom victory_counts\ngroup by \n    case \n        when total_wins = 1 then '1'\n        when total_wins between 2 and 10 then '2-10'\n        when total_wins between 11 and 20 then '11-20'\n        when total_wins between 21 and 50 then '21-50'\n        when total_wins between 51 and 80 then '51-80'\n        when total_wins between 81 and 100 then '81-100'\n        when total_wins between 101 and 200 then '101-200'\n        when total_wins between 201 and 500 then '201-500'\n        when total_wins > 500 then '501以上'\n    end\norder by victory_range;\n", "status": "success", "result": []}
{"sql_id": "sql_110", "sql": "\nwith login_cohort as (\n    select \n        dtstatdate as ds,\n        vplayerid\n    from dws_jordass_login_di\n    where dtstatdate between '20220413' and '20220421'\n    and platid = 255\n    group by dtstatdate, vplayerid\n),\n\nlogin_behavior as (\n    select \n        dtstatdate as ds,\n        vplayerid\n    from dws_jordass_login_di\n    where dtstatdate between '20220413' and '20220428'\n    and platid = 255\n    group by dtstatdate, vplayerid\n),\n\nactivity_behavior as (\n    select \n        substr(dteventtime, 1, 8) as ds,\n        vplayerid\n    from dwd_jordass_activity_rewardrecord_hi\n    where substr(dteventtime, 1, 8) between '20220413' and '20220428'\n    and actid = 2201123904\n    group by substr(dteventtime, 1, 8), vplayerid\n)\n\nselect \n    lc.ds as stat_date,\n    count(distinct ac.vplayerid) as activity_user_count,\n    count(distinct case when lb1.ds = date_add(lc.ds, 1) then lc.vplayerid end) as login_next_day_retention,\n    count(distinct case when lb1.ds = date_add(lc.ds, 2) then lc.vplayerid end) as login_three_day_retention,\n    count(distinct case when lb1.ds = date_add(lc.ds, 6) then lc.vplayerid end) as login_seven_day_retention,\n    count(distinct case when ab1.ds = date_add(lc.ds, 1) then lc.vplayerid end) as activity_next_day_retention,\n    count(distinct case when ab1.ds = date_add(lc.ds, 2) then lc.vplayerid end) as activity_three_day_retention,\n    count(distinct case when ab1.ds = date_add(lc.ds, 6) then lc.vplayerid end) as activity_seven_day_retention\nfrom login_cohort lc\nleft join login_behavior lb1 on lc.vplayerid = lb1.vplayerid\nleft join activity_behavior ab1 on lc.vplayerid = ab1.vplayerid\ngroup by lc.ds\norder by lc.ds;\n", "status": "success", "result": null}
{"sql_id": "sql_111", "sql": "\nSELECT \n    tdbank_imp_date AS stat_date,\n    '变身速行战士' AS type,\n    ROUND(CAST(SPLIT_PART(swiftmorphinfo, '+', 4) AS DECIMAL(10,1)), 1) AS x,\n    ROUND(CAST(SPLIT_PART(swiftmorphinfo, '+', 5) AS DECIMAL(10,1)), 1) AS y,\n    ROUND(CAST(SPLIT_PART(swiftmorphinfo, '+', 6) AS DECIMAL(10,1)), 1) AS z,\n    COUNT(*) AS count\nFROM dwd_jordass_vsteaminfectlog_hi\nWHERE tdbank_imp_date = '20220425' AND swiftmorphinfo IS NOT NULL\nGROUP BY tdbank_imp_date, x, y, z\n\nUNION ALL\n\nSELECT \n    tdbank_imp_date AS stat_date,\n    '变身隐形战士' AS type,\n    ROUND(CAST(SPLIT_PART(stealthmorphinfo, '+', 4) AS DECIMAL(10,1)), 1) AS x,\n    ROUND(CAST(SPLIT_PART(stealthmorphinfo, '+', 5) AS DECIMAL(10,1)), 1) AS y,\n    ROUND(CAST(SPLIT_PART(stealthmorphinfo, '+', 6) AS DECIMAL(10,1)), 1) AS z,\n    COUNT(*) AS count\nFROM dwd_jordass_vsteaminfectlog_hi\nWHERE tdbank_imp_date = '20220425' AND stealthmorphinfo IS NOT NULL\nGROUP BY tdbank_imp_date, x, y, z\n\nUNION ALL\n\nSELECT \n    tdbank_imp_date AS stat_date,\n    '变身钩链战士' AS type,\n    ROUND(CAST(SPLIT_PART(grapplemorphinfo, '+', 4) AS DECIMAL(10,1)), 1) AS x,\n    ROUND(CAST(SPLIT_PART(grapplemorphinfo, '+', 5) AS DECIMAL(10,1)), 1) AS y,\n    ROUND(CAST(SPLIT_PART(grapplemorphinfo, '+', 6) AS DECIMAL(10,1)), 1) AS z,\n    COUNT(*) AS count\nFROM dwd_jordass_vsteaminfectlog_hi\nWHERE tdbank_imp_date = '20220425' AND grapplemorphinfo IS NOT NULL\nGROUP BY tdbank_imp_date, x, y, z\n\nUNION ALL\n\nSELECT \n    tdbank_imp_date AS stat_date,\n    '变身强能猎手' AS type,\n    ROUND(CAST(changeposxhero AS DECIMAL(10,1)), 1) AS x,\n    ROUND(CAST(changeposyhero AS DECIMAL(10,1)), 1) AS y,\n    ROUND(CAST(changeposzhero AS DECIMAL(10,1)), 1) AS z,\n    COUNT(*) AS count\nFROM dwd_jordass_vsteaminfectlog_hi\nWHERE tdbank_imp_date = '20220425' AND heromorphinfo IS NOT NULL\nGROUP BY tdbank_imp_date, x, y, z\n\nUNION ALL\n\nSELECT \n    tdbank_imp_date AS stat_date,\n    '变身冰霜领主' AS type,\n    ROUND(CAST(SPLIT_PART(iceadvmorphinfo, '+', 4) AS DECIMAL(10,1)), 1) AS x,\n    ROUND(CAST(SPLIT_PART(iceadvmorphinfo, '+', 5) AS DECIMAL(10,1)), 1) AS y,\n    ROUND(CAST(SPLIT_PART(iceadvmorphinfo, '+', 6) AS DECIMAL(10,1)), 1) AS z,\n    COUNT(*) AS count\nFROM dwd_jordass_vsteaminfectlog_hi\nWHERE tdbank_imp_date = '20220425' AND iceadvmorphinfo IS NOT NULL\nGROUP BY tdbank_imp_date, x, y, z\n\nUNION ALL\n\nSELECT \n    tdbank_imp_date AS stat_date,\n    '变身强化战士' AS type,\n    ROUND(CAST(SPLIT_PART(poweradvmorphinfo, '+', 4) AS DECIMAL(10,1)), 1) AS x,\n    ROUND(CAST(SPLIT_PART(poweradvmorphinfo, '+', 5) AS DECIMAL(10,1)), 1) AS y,\n    ROUND(CAST(SPLIT_PART(poweradvmorphinfo, '+', 6) AS DECIMAL(10,1)), 1) AS z,\n    COUNT(*) AS count\nFROM dwd_jordass_vsteaminfectlog_hi\nWHERE tdbank_imp_date = '20220425' AND poweradvmorphinfo IS NOT NULL\nGROUP BY tdbank_imp_date, x, y, z\n\nUNION ALL\n\nSELECT \n    tdbank_imp_date AS stat_date,\n    '变身龙焰猎手' AS type,\n    ROUND(CAST(SPLIT_PART(dragonheromorphinfo, '+', 4) AS DECIMAL(10,1)), 1) AS x,\n    ROUND(CAST(SPLIT_PART(dragonheromorphinfo, '+', 5) AS DECIMAL(10,1)), 1) AS y,\n    ROUND(CAST(SPLIT_PART(dragonheromorphinfo, '+', 6) AS DECIMAL(10,1)), 1) AS z,\n    COUNT(*) AS count\nFROM dwd_jordass_vsteaminfectlog_hi\nWHERE tdbank_imp_date = '20220425' AND dragonheromorphinfo IS NOT NULL\nGROUP BY tdbank_imp_date, x, y, z;\n", "status": "success", "result": []}
{"sql_id": "sql_112", "sql": "\nselect \n    substr(dteventtime, 1, 10) as stat_date,\n    count(distinct vplayerid) as player_count\nfrom dwd_jordass_roundflow_hi\nwhere (\n    (dteventtime between '2022-04-23' and '2022-04-30 23:59:59') \n    or \n    (dteventtime between '2022-05-01' and '2022-05-08 23:59:59')\n)\nand mode in (101, 102, 103, 401, 402, 403)\nand survivaltime >= 5400  -- 90分钟=5400秒\ngroup by substr(dteventtime, 1, 10)\norder by stat_date;\n", "status": "success", "result": []}
{"sql_id": "sql_113", "sql": "\nselect\n    substr(dteventtime, 1, 10) as dtstatdate,\n    shopid,\n    count(distinct vplayerid) as user_cnt,\n    sum(count) as purchase_cnt\nfrom dwd_jordass_vsteamshoplog_hi\nwhere substr(dteventtime, 1, 10) between '2022-04-25' and '2022-05-08'\ngroup by substr(dteventtime, 1, 10), shopid\norder by dtstatdate, shopid;\n", "status": "success", "result": [{"dtstatdate": "2022-04-25", "shopid": 37, "user_cnt": 2, "purchase_cnt": 4}, {"dtstatdate": "2022-04-26", "shopid": 38, "user_cnt": 2, "purchase_cnt": 4}, {"dtstatdate": "2022-04-27", "shopid": 39, "user_cnt": 1, "purchase_cnt": 3}, {"dtstatdate": "2022-05-01", "shopid": 40, "user_cnt": 1, "purchase_cnt": 4}, {"dtstatdate": "2022-05-02", "shopid": 41, "user_cnt": 1, "purchase_cnt": 1}, {"dtstatdate": "2022-05-08", "shopid": 42, "user_cnt": 1, "purchase_cnt": 2}]}
{"sql_id": "sql_115", "sql": "\nselect \n    vplayerid,\n    count(distinct case \n        when dteventtime between '20240202' and '20240204' then '新年竞赛杯1'\n        when dteventtime between '20240209' and '20240211' then '新年竞赛杯2'\n        when dteventtime between '20231208' and '20231210' then '明星竞赛杯1'\n        when dteventtime between '20231215' and '20231217' then '明星竞赛杯2'\n        when dteventtime between '20231006' and '20231008' then '众竞赛道1'\n        when dteventtime between '20230929' and '20231001' then '众竞赛道2'\n        when dteventtime between '20230922' and '20230924' then '众竞赛道3'\n        when dteventtime between '20230721' and '20230723' then '珍禽竞赛杯1'\n        when dteventtime between '20230728' and '20230730' then '珍禽竞赛杯2'\n        when dteventtime between '20230519' and '20230611' then '都会竞速1'\n        when dteventtime between '20230616' and '20230625' then '都会竞速2'\n        when dteventtime between '20230505' and '20230507' then '寒域竞赛杯1'\n        when dteventtime between '20230512' and '20230514' then '寒域竞赛杯2'\n        when dteventtime between '20230121' and '20230127' then '飞跃竞赛杯'\n        when dteventtime between '20221125' and '20221127' then '联队竞赛杯1'\n        when dteventtime between '20221202' and '20221204' then '联队竞赛杯2'\n        when dteventtime between '20220819' and '20220821' then '职赛杯1'\n        when dteventtime between '20220826' and '20220828' then '职赛杯2'\n        when dteventtime between '20220722' and '20220724' then '夏日假期竞赛杯1'\n        when dteventtime between '20220729' and '20220731' then '夏日假期竞赛杯2'\n        when dteventtime between '20220506' and '20220508' then '众投竞赛1'\n        when dteventtime between '20220513' and '20220515' then '众投竞赛2'\n        when dteventtime between '20220520' and '20220522' then '众投竞赛3'\n    end) as competition_count\nfrom dwd_jordass_player_matchrecord_hi\nwhere matchmode in (1503, 1603)\nand (\n    (dteventtime between '20240202' and '20240204') or\n    (dteventtime between '20240209' and '20240211') or\n    (dteventtime between '20231208' and '20231210') or\n    (dteventtime between '20231215' and '20231217') or\n    (dteventtime between '20231006' and '20231008') or\n    (dteventtime between '20230929' and '20231001') or\n    (dteventtime between '20230922' and '20230924') or\n    (dteventtime between '20230721' and '20230723') or\n    (dteventtime between '20230728' and '20230730') or\n    (dteventtime between '20230519' and '20230611') or\n    (dteventtime between '20230616' and '20230625') or\n    (dteventtime between '20230505' and '20230507') or\n    (dteventtime between '20230512' and '20230514') or\n    (dteventtime between '20230121' and '20230127') or\n    (dteventtime between '20221125' and '20221127') or\n    (dteventtime between '20221202' and '20221204') or\n    (dteventtime between '20220819' and '20220821') or\n    (dteventtime between '20220826' and '20220828') or\n    (dteventtime between '20220722' and '20220724') or\n    (dteventtime between '20220729' and '20220731') or\n    (dteventtime between '20220506' and '20220508') or\n    (dteventtime between '20220513' and '20220515') or\n    (dteventtime between '20220520' and '20220522')\n)\ngroup by vplayerid\n", "status": "success", "result": []}
{"sql_id": "sql_116", "sql": "\nselect\n    case \n        when instr(substr(cbitmap, 1, 90), '1') = 0 then '近三个月流失'\n        when w.vplayerid is null then '近三个月活跃但无付费'\n        else '近三个月活跃且有付费'\n    end as user_type,\n    historymaxsegment as history_segment,\n    case \n        when imoney is null or imoney = 0 then '0'\n        when imoney > 0 and imoney <= 1200 then '(0-1200]'\n        when imoney > 1200 and imoney <= 6000 then '(1200-6000]'\n        when imoney > 6000 and imoney <= 18000 then '(6000-18000]'\n        when imoney > 18000 then '(18000+]'\n    end as payment_tier,\n    count(distinct l.vplayerid) as user_count\nfrom \n    dws_jordass_uid_login_df l\nleft join \n    dws_jordass_water_df w on l.vplayerid = w.vplayerid and w.dtstatdate = '20250225'\nwhere \n    l.dtstatdate = '20250225'\n    and l.platid = 255\ngroup by \n    case \n        when instr(substr(cbitmap, 1, 90), '1') = 0 then '近三个月流失'\n        when w.vplayerid is null then '近三个月活跃但无付费'\n        else '近三个月活跃且有付费'\n    end,\n    historymaxsegment,\n    case \n        when imoney is null or imoney = 0 then '0'\n        when imoney > 0 and imoney <= 1200 then '(0-1200]'\n        when imoney > 1200 and imoney <= 6000 then '(1200-6000]'\n        when imoney > 6000 and imoney <= 18000 then '(6000-18000]'\n        when imoney > 18000 then '(18000+]'\n    end;\n", "status": "success", "result": null}
{"sql_id": "sql_117", "sql": "\nselect\n    user_type,\n    count(distinct vplayerid) as user_count\nfrom (\n    select\n        vplayerid,\n        case\n            when (instr(substr(cbitmap, 1, 1), '1') > 0) then '活跃'\n            when (instr(substr(cbitmap, 1, 1), '1') > 0) and (instr(substr(cbitmap, 2, 7), '1') = 0) then '7日回流'\n            when (instr(substr(cbitmap, 1, 1), '1') > 0) and (instr(substr(cbitmap, 2, 14), '1') = 0) then '14日回流'\n            when (instr(substr(cbitmap, 1, 1), '1') > 0) and (instr(substr(cbitmap, 2, 30), '1') = 0) then '30日回流'\n        end as user_type\n    from\n        dws_jordass_login_df\n    where\n        dtstatdate between '20250331' and '20250510'\n        and platid = 255\n) as user_types\nwhere user_type is not null\ngroup by user_type;\n", "status": "success", "result": [{"user_type": "活跃", "user_count": 14}]}
{"sql_id": "sql_118", "sql": "\nwith exposure as (\n    select distinct suser as vplayerid\n    from dwd_jordass_mysteryplaylog_hi\n    where iactid = '1193536'\n    and itype = '1'\n    and dteventtime between '20240426' and '20240505'\n),\nparticipation as (\n    select distinct suser as vplayerid\n    from dwd_jordass_mysteryplaylog_hi\n    where iactid = '1193536'\n    and itype in ('10','200','201','202','203','204','31','32','33','34','35','702','703')\n    and dteventtime between '20240426' and '20240505'\n),\ntraditional_mode as (\n    select \n        vplayerid,\n        sum(roundcnt) as roundcnt,\n        sum(roundtime) as roundtime\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate between '20240426' and '20240505'\n    and mode in (101,102,103) -- 假设这些是传统模式ID\n    group by vplayerid\n),\nactive_users as (\n    select \n        vplayerid,\n        sum(ionlinetime) as onlinetime\n    from dws_jordass_login_di\n    where dtstatdate between '20240426' and '20240505'\n    group by vplayerid\n),\nprofessional_match as (\n    select \n        vplayerid,\n        count(*) as battlecount\n    from dwd_jordass_playerprofstagechange_hi\n    where tournamentid = 30002\n    and dteventtime between '20240426' and '20240505'\n    group by vplayerid\n)\n\nselect \n    case \n        when p.vplayerid is not null then '曝光且参与'\n        else '曝光未参与'\n    end as exposure_status,\n    count(distinct e.vplayerid) as user_count,\n    count(distinct tm.vplayerid) as traditional_user_count,\n    coalesce(sum(tm.roundcnt), 0) as traditional_round_count,\n    coalesce(sum(tm.roundtime), 0) as traditional_round_time,\n    count(distinct au.vplayerid) as active_user_count,\n    coalesce(sum(au.onlinetime), 0) as active_time,\n    count(distinct pm.vplayerid) as professional_user_count,\n    coalesce(sum(pm.battlecount), 0) as professional_battle_count\nfrom exposure e\nleft join participation p on e.vplayerid = p.vplayerid\nleft join traditional_mode tm on e.vplayerid = tm.vplayerid\nleft join active_users au on e.vplayerid = au.vplayerid\nleft join professional_match pm on e.vplayerid = pm.vplayerid\ngroup by exposure_status;\n", "status": "success", "result": []}
{"sql_id": "sql_119", "sql": "\nselect\n    dtstatdate as `统计日期`,\n    case \n        when dregdate = dtstatdate then '新增'\n        when instr(substr(cbitmap, 2, 7), '1') > 0 then '7日以内留存'\n        when instr(substr(cbitmap, 8, 7), '1') > 0 then '7~14日回流'\n        when instr(substr(cbitmap, 15, 16), '1') > 0 then '14~30日回流'\n        when instr(substr(cbitmap, 31, 60), '1') > 0 then '30~90日回流'\n        when instr(substr(cbitmap, 91), '1') > 0 then '90日以上回流'\n        when instr(substr(cbitmap, 2, 15), '1') = 0 then '后续半个月未登录'\n        else '后续半个月有登录'\n    end as `用户类型`,\n    count(distinct vplayerid) as `人数`\nfrom dws_jordass_login_df\nwhere dtstatdate in ('20250429', '20250601')\n  and platid = 255\n  and instr(substr(cbitmap, 1, 1), '1') > 0\ngroup by dtstatdate, \n    case \n        when dregdate = dtstatdate then '新增'\n        when instr(substr(cbitmap, 2, 7), '1') > 0 then '7日以内留存'\n        when instr(substr(cbitmap, 8, 7), '1') > 0 then '7~14日回流'\n        when instr(substr(cbitmap, 15, 16), '1') > 0 then '14~30日回流'\n        when instr(substr(cbitmap, 31, 60), '1') > 0 then '30~90日回流'\n        when instr(substr(cbitmap, 91), '1') > 0 then '90日以上回流'\n        when instr(substr(cbitmap, 2, 15), '1') = 0 then '后续半个月未登录'\n        else '后续半个月有登录'\n    end;\n", "status": "success", "result": [{"统计日期": "20250601", "用户类型": "新增", "人数": 1}, {"统计日期": "20250429", "用户类型": "新增", "人数": 1}]}
{"sql_id": "sql_120", "sql": "\nwith \nactive_users as (\n    select vplayerid, gender\n    from dws_jordass_uid_login_df\n    where dtstatdate = '20250724' \n    and vgameappid = 'qq'\n    and substr(cbitmap,1,2) = '11'\n),\nlost_users as (\n    select vplayerid, gender\n    from dws_jordass_uid_login_df\n    where dtstatdate = '20250724' \n    and vgameappid = 'qq'\n    and substr(cbitmap,1,1) = '1'\n    and substr(cbitmap,2,1) = '0'\n)\n\nselect \n    '7月24~7月25日持续活跃' as user_type,\n    gender,\n    count(distinct vplayerid) as user_count\nfrom active_users\ngroup by gender\n\nunion all\n\nselect \n    '7.24活跃7.25流失到盘外' as user_type,\n    gender,\n    count(distinct vplayerid) as user_count\nfrom lost_users\ngroup by gender;\n", "status": "success", "result": []}
